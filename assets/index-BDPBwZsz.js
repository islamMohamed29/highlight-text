var Tv=u=>{throw TypeError(u)};var Hf=(u,t,e)=>t.has(u)||Tv("Cannot "+e);var de=(u,t,e)=>(Hf(u,t,"read from private field"),e?e.call(u):t.get(u)),bs=(u,t,e)=>t.has(u)?Tv("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(u):t.set(u,e),gi=(u,t,e,i)=>(Hf(u,t,"write to private field"),i?i.call(u,e):t.set(u,e),e),_s=(u,t,e)=>(Hf(u,t,"access private method"),e);var Ev=(u,t,e,i)=>({set _(s){gi(u,t,s,e)},get _(){return de(u,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();function R1(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Uf={exports:{}},Yo={};var Dv;function L1(){if(Dv)return Yo;Dv=1;var u=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:u,type:i,key:o,ref:s!==void 0?s:null,props:r}}return Yo.Fragment=t,Yo.jsx=e,Yo.jsxs=e,Yo}var Mv;function P1(){return Mv||(Mv=1,Uf.exports=L1()),Uf.exports}var tt=P1(),Gf={exports:{}},Ot={};var Ov;function B1(){if(Ov)return Ot;Ov=1;var u=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),v=Symbol.iterator;function b(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,C={};function w(P,Y,et){this.props=P,this.context=Y,this.refs=C,this.updater=et||S}w.prototype.isReactComponent={},w.prototype.setState=function(P,Y){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,Y,"setState")},w.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function T(){}T.prototype=w.prototype;function E(P,Y,et){this.props=P,this.context=Y,this.refs=C,this.updater=et||S}var D=E.prototype=new T;D.constructor=E,_(D,w.prototype),D.isPureReactComponent=!0;var M=Array.isArray;function O(){}var R={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function G(P,Y,et){var nt=et.ref;return{$$typeof:u,type:P,key:Y,ref:nt!==void 0?nt:null,props:et}}function Q(P,Y){return G(P.type,Y,P.props)}function J(P){return typeof P=="object"&&P!==null&&P.$$typeof===u}function st(P){var Y={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(et){return Y[et]})}var rt=/\/+/g;function it(P,Y){return typeof P=="object"&&P!==null&&P.key!=null?st(""+P.key):Y.toString(36)}function lt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(O,O):(P.status="pending",P.then(function(Y){P.status==="pending"&&(P.status="fulfilled",P.value=Y)},function(Y){P.status==="pending"&&(P.status="rejected",P.reason=Y)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function L(P,Y,et,nt,ft){var gt=typeof P;(gt==="undefined"||gt==="boolean")&&(P=null);var pt=!1;if(P===null)pt=!0;else switch(gt){case"bigint":case"string":case"number":pt=!0;break;case"object":switch(P.$$typeof){case u:case t:pt=!0;break;case g:return pt=P._init,L(pt(P._payload),Y,et,nt,ft)}}if(pt)return ft=ft(P),pt=nt===""?"."+it(P,0):nt,M(ft)?(et="",pt!=null&&(et=pt.replace(rt,"$&/")+"/"),L(ft,Y,et,"",function(Pt){return Pt})):ft!=null&&(J(ft)&&(ft=Q(ft,et+(ft.key==null||P&&P.key===ft.key?"":(""+ft.key).replace(rt,"$&/")+"/")+pt)),Y.push(ft)),1;pt=0;var Wt=nt===""?".":nt+":";if(M(P))for(var Mt=0;Mt<P.length;Mt++)nt=P[Mt],gt=Wt+it(nt,Mt),pt+=L(nt,Y,et,gt,ft);else if(Mt=b(P),typeof Mt=="function")for(P=Mt.call(P),Mt=0;!(nt=P.next()).done;)nt=nt.value,gt=Wt+it(nt,Mt++),pt+=L(nt,Y,et,gt,ft);else if(gt==="object"){if(typeof P.then=="function")return L(lt(P),Y,et,nt,ft);throw Y=String(P),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return pt}function I(P,Y,et){if(P==null)return P;var nt=[],ft=0;return L(P,nt,"","",function(gt){return Y.call(et,gt,ft++)}),nt}function K(P){if(P._status===-1){var Y=P._result;Y=Y(),Y.then(function(et){(P._status===0||P._status===-1)&&(P._status=1,P._result=et)},function(et){(P._status===0||P._status===-1)&&(P._status=2,P._result=et)}),P._status===-1&&(P._status=0,P._result=Y)}if(P._status===1)return P._result.default;throw P._result}var dt=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},_t={map:I,forEach:function(P,Y,et){I(P,function(){Y.apply(this,arguments)},et)},count:function(P){var Y=0;return I(P,function(){Y++}),Y},toArray:function(P){return I(P,function(Y){return Y})||[]},only:function(P){if(!J(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Ot.Activity=p,Ot.Children=_t,Ot.Component=w,Ot.Fragment=e,Ot.Profiler=s,Ot.PureComponent=E,Ot.StrictMode=i,Ot.Suspense=h,Ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ot.__COMPILER_RUNTIME={__proto__:null,c:function(P){return R.H.useMemoCache(P)}},Ot.cache=function(P){return function(){return P.apply(null,arguments)}},Ot.cacheSignal=function(){return null},Ot.cloneElement=function(P,Y,et){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var nt=_({},P.props),ft=P.key;if(Y!=null)for(gt in Y.key!==void 0&&(ft=""+Y.key),Y)!j.call(Y,gt)||gt==="key"||gt==="__self"||gt==="__source"||gt==="ref"&&Y.ref===void 0||(nt[gt]=Y[gt]);var gt=arguments.length-2;if(gt===1)nt.children=et;else if(1<gt){for(var pt=Array(gt),Wt=0;Wt<gt;Wt++)pt[Wt]=arguments[Wt+2];nt.children=pt}return G(P.type,ft,nt)},Ot.createContext=function(P){return P={$$typeof:o,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:r,_context:P},P},Ot.createElement=function(P,Y,et){var nt,ft={},gt=null;if(Y!=null)for(nt in Y.key!==void 0&&(gt=""+Y.key),Y)j.call(Y,nt)&&nt!=="key"&&nt!=="__self"&&nt!=="__source"&&(ft[nt]=Y[nt]);var pt=arguments.length-2;if(pt===1)ft.children=et;else if(1<pt){for(var Wt=Array(pt),Mt=0;Mt<pt;Mt++)Wt[Mt]=arguments[Mt+2];ft.children=Wt}if(P&&P.defaultProps)for(nt in pt=P.defaultProps,pt)ft[nt]===void 0&&(ft[nt]=pt[nt]);return G(P,gt,ft)},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(P){return{$$typeof:c,render:P}},Ot.isValidElement=J,Ot.lazy=function(P){return{$$typeof:g,_payload:{_status:-1,_result:P},_init:K}},Ot.memo=function(P,Y){return{$$typeof:f,type:P,compare:Y===void 0?null:Y}},Ot.startTransition=function(P){var Y=R.T,et={};R.T=et;try{var nt=P(),ft=R.S;ft!==null&&ft(et,nt),typeof nt=="object"&&nt!==null&&typeof nt.then=="function"&&nt.then(O,dt)}catch(gt){dt(gt)}finally{Y!==null&&et.types!==null&&(Y.types=et.types),R.T=Y}},Ot.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ot.use=function(P){return R.H.use(P)},Ot.useActionState=function(P,Y,et){return R.H.useActionState(P,Y,et)},Ot.useCallback=function(P,Y){return R.H.useCallback(P,Y)},Ot.useContext=function(P){return R.H.useContext(P)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(P,Y){return R.H.useDeferredValue(P,Y)},Ot.useEffect=function(P,Y){return R.H.useEffect(P,Y)},Ot.useEffectEvent=function(P){return R.H.useEffectEvent(P)},Ot.useId=function(){return R.H.useId()},Ot.useImperativeHandle=function(P,Y,et){return R.H.useImperativeHandle(P,Y,et)},Ot.useInsertionEffect=function(P,Y){return R.H.useInsertionEffect(P,Y)},Ot.useLayoutEffect=function(P,Y){return R.H.useLayoutEffect(P,Y)},Ot.useMemo=function(P,Y){return R.H.useMemo(P,Y)},Ot.useOptimistic=function(P,Y){return R.H.useOptimistic(P,Y)},Ot.useReducer=function(P,Y,et){return R.H.useReducer(P,Y,et)},Ot.useRef=function(P){return R.H.useRef(P)},Ot.useState=function(P){return R.H.useState(P)},Ot.useSyncExternalStore=function(P,Y,et){return R.H.useSyncExternalStore(P,Y,et)},Ot.useTransition=function(){return R.H.useTransition()},Ot.version="19.2.0",Ot}var kv;function Ug(){return kv||(kv=1,Gf.exports=B1()),Gf.exports}var at=Ug(),Vf={exports:{}},qo={},Xf={exports:{}},Yf={};var Rv;function N1(){return Rv||(Rv=1,(function(u){function t(L,I){var K=L.length;L.push(I);t:for(;0<K;){var dt=K-1>>>1,_t=L[dt];if(0<s(_t,I))L[dt]=I,L[K]=_t,K=dt;else break t}}function e(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var I=L[0],K=L.pop();if(K!==I){L[0]=K;t:for(var dt=0,_t=L.length,P=_t>>>1;dt<P;){var Y=2*(dt+1)-1,et=L[Y],nt=Y+1,ft=L[nt];if(0>s(et,K))nt<_t&&0>s(ft,et)?(L[dt]=ft,L[nt]=K,dt=nt):(L[dt]=et,L[Y]=K,dt=Y);else if(nt<_t&&0>s(ft,K))L[dt]=ft,L[nt]=K,dt=nt;else break t}}return I}function s(L,I){var K=L.sortIndex-I.sortIndex;return K!==0?K:L.id-I.id}if(u.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;u.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();u.unstable_now=function(){return o.now()-c}}var h=[],f=[],g=1,p=null,v=3,b=!1,S=!1,_=!1,C=!1,w=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function D(L){for(var I=e(f);I!==null;){if(I.callback===null)i(f);else if(I.startTime<=L)i(f),I.sortIndex=I.expirationTime,t(h,I);else break;I=e(f)}}function M(L){if(_=!1,D(L),!S)if(e(h)!==null)S=!0,O||(O=!0,st());else{var I=e(f);I!==null&&lt(M,I.startTime-L)}}var O=!1,R=-1,j=5,G=-1;function Q(){return C?!0:!(u.unstable_now()-G<j)}function J(){if(C=!1,O){var L=u.unstable_now();G=L;var I=!0;try{t:{S=!1,_&&(_=!1,T(R),R=-1),b=!0;var K=v;try{e:{for(D(L),p=e(h);p!==null&&!(p.expirationTime>L&&Q());){var dt=p.callback;if(typeof dt=="function"){p.callback=null,v=p.priorityLevel;var _t=dt(p.expirationTime<=L);if(L=u.unstable_now(),typeof _t=="function"){p.callback=_t,D(L),I=!0;break e}p===e(h)&&i(h),D(L)}else i(h);p=e(h)}if(p!==null)I=!0;else{var P=e(f);P!==null&&lt(M,P.startTime-L),I=!1}}break t}finally{p=null,v=K,b=!1}I=void 0}}finally{I?st():O=!1}}}var st;if(typeof E=="function")st=function(){E(J)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,it=rt.port2;rt.port1.onmessage=J,st=function(){it.postMessage(null)}}else st=function(){w(J,0)};function lt(L,I){R=w(function(){L(u.unstable_now())},I)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(L){L.callback=null},u.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<L?Math.floor(1e3/L):5},u.unstable_getCurrentPriorityLevel=function(){return v},u.unstable_next=function(L){switch(v){case 1:case 2:case 3:var I=3;break;default:I=v}var K=v;v=I;try{return L()}finally{v=K}},u.unstable_requestPaint=function(){C=!0},u.unstable_runWithPriority=function(L,I){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var K=v;v=L;try{return I()}finally{v=K}},u.unstable_scheduleCallback=function(L,I,K){var dt=u.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?dt+K:dt):K=dt,L){case 1:var _t=-1;break;case 2:_t=250;break;case 5:_t=1073741823;break;case 4:_t=1e4;break;default:_t=5e3}return _t=K+_t,L={id:g++,callback:I,priorityLevel:L,startTime:K,expirationTime:_t,sortIndex:-1},K>dt?(L.sortIndex=K,t(f,L),e(h)===null&&L===e(f)&&(_?(T(R),R=-1):_=!0,lt(M,K-dt))):(L.sortIndex=_t,t(h,L),S||b||(S=!0,O||(O=!0,st()))),L},u.unstable_shouldYield=Q,u.unstable_wrapCallback=function(L){var I=v;return function(){var K=v;v=I;try{return L.apply(this,arguments)}finally{v=K}}}})(Yf)),Yf}var Lv;function F1(){return Lv||(Lv=1,Xf.exports=N1()),Xf.exports}var qf={exports:{}},$e={};var Pv;function j1(){if(Pv)return $e;Pv=1;var u=Ug();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(h,f,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:h,containerInfo:f,implementation:g}}var o=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return $e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$e.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return r(h,f,null,g)},$e.flushSync=function(h){var f=o.T,g=i.p;try{if(o.T=null,i.p=2,h)return h()}finally{o.T=f,i.p=g,i.d.f()}},$e.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(h,f))},$e.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},$e.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,p=c(g,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?i.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:b}):g==="script"&&i.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},$e.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(h)},$e.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,p=c(g,f.crossOrigin);i.d.L(h,g,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},$e.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);i.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(h)},$e.requestFormReset=function(h){i.d.r(h)},$e.unstable_batchedUpdates=function(h,f){return h(f)},$e.useFormState=function(h,f,g){return o.H.useFormState(h,f,g)},$e.useFormStatus=function(){return o.H.useHostTransitionStatus()},$e.version="19.2.0",$e}var Bv;function z1(){if(Bv)return qf.exports;Bv=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(t){console.error(t)}}return u(),qf.exports=j1(),qf.exports}var Nv;function I1(){if(Nv)return qo;Nv=1;var u=F1(),t=Ug(),e=z1();function i(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function r(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function o(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function c(n){if(n.tag===31){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function h(n){if(r(n)!==n)throw Error(i(188))}function f(n){var a=n.alternate;if(!a){if(a=r(n),a===null)throw Error(i(188));return a!==n?null:n}for(var l=n,d=a;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(d=m.return,d!==null){l=d;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return h(m),n;if(y===d)return h(m),a;y=y.sibling}throw Error(i(188))}if(l.return!==d.return)l=m,d=y;else{for(var x=!1,A=m.child;A;){if(A===l){x=!0,l=m,d=y;break}if(A===d){x=!0,d=m,l=y;break}A=A.sibling}if(!x){for(A=y.child;A;){if(A===l){x=!0,l=y,d=m;break}if(A===d){x=!0,d=y,l=m;break}A=A.sibling}if(!x)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:a}function g(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=g(n),a!==null)return a;n=n.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),E=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function st(n){return n===null||typeof n!="object"?null:(n=J&&n[J]||n["@@iterator"],typeof n=="function"?n:null)}var rt=Symbol.for("react.client.reference");function it(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===rt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _:return"Fragment";case w:return"Profiler";case C:return"StrictMode";case M:return"Suspense";case O:return"SuspenseList";case G:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case S:return"Portal";case E:return n.displayName||"Context";case T:return(n._context.displayName||"Context")+".Consumer";case D:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case R:return a=n.displayName||null,a!==null?a:it(n.type)||"Memo";case j:a=n._payload,n=n._init;try{return it(n(a))}catch{}}return null}var lt=Array.isArray,L=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},dt=[],_t=-1;function P(n){return{current:n}}function Y(n){0>_t||(n.current=dt[_t],dt[_t]=null,_t--)}function et(n,a){_t++,dt[_t]=n.current,n.current=a}var nt=P(null),ft=P(null),gt=P(null),pt=P(null);function Wt(n,a){switch(et(gt,a),et(ft,n),et(nt,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?Ky(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=Ky(a),n=$y(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}Y(nt),et(nt,n)}function Mt(){Y(nt),Y(ft),Y(gt)}function Pt(n){n.memoizedState!==null&&et(pt,n);var a=nt.current,l=$y(a,n.type);a!==l&&(et(ft,n),et(nt,l))}function yt(n){ft.current===n&&(Y(nt),Y(ft)),pt.current===n&&(Y(pt),Uo._currentValue=K)}var ot,Tt;function Et(n){if(ot===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);ot=a&&a[1]||"",Tt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+n+Tt}var Dt=!1;function wt(n,a){if(!n||Dt)return"";Dt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var Z=function(){throw Error()};if(Object.defineProperty(Z.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Z,[])}catch(q){var V=q}Reflect.construct(n,[],Z)}else{try{Z.call()}catch(q){V=q}n.call(Z.prototype)}}else{try{throw Error()}catch(q){V=q}(Z=n())&&typeof Z.catch=="function"&&Z.catch(function(){})}}catch(q){if(q&&V&&typeof q.stack=="string")return[q.stack,V.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),x=y[0],A=y[1];if(x&&A){var k=x.split(`
`),U=A.split(`
`);for(m=d=0;d<k.length&&!k[d].includes("DetermineComponentFrameRoot");)d++;for(;m<U.length&&!U[m].includes("DetermineComponentFrameRoot");)m++;if(d===k.length||m===U.length)for(d=k.length-1,m=U.length-1;1<=d&&0<=m&&k[d]!==U[m];)m--;for(;1<=d&&0<=m;d--,m--)if(k[d]!==U[m]){if(d!==1||m!==1)do if(d--,m--,0>m||k[d]!==U[m]){var W=`
`+k[d].replace(" at new "," at ");return n.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",n.displayName)),W}while(1<=d&&0<=m);break}}}finally{Dt=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?Et(l):""}function bt(n,a){switch(n.tag){case 26:case 27:case 5:return Et(n.type);case 16:return Et("Lazy");case 13:return n.child!==a&&a!==null?Et("Suspense Fallback"):Et("Suspense");case 19:return Et("SuspenseList");case 0:case 15:return wt(n.type,!1);case 11:return wt(n.type.render,!1);case 1:return wt(n.type,!0);case 31:return Et("Activity");default:return""}}function Be(n){try{var a="",l=null;do a+=bt(n,l),l=n,n=n.return;while(n);return a}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Kn=Object.prototype.hasOwnProperty,Za=u.unstable_scheduleCallback,gn=u.unstable_cancelCallback,Au=u.unstable_shouldYield,Tu=u.unstable_requestPaint,ti=u.unstable_now,Eu=u.unstable_getCurrentPriorityLevel,Bl=u.unstable_ImmediatePriority,ts=u.unstable_UserBlockingPriority,es=u.unstable_NormalPriority,gs=u.unstable_LowPriority,Lr=u.unstable_IdlePriority,gx=u.log,px=u.unstable_setDisableYieldValue,Ja=null,xi=null;function pn(n){if(typeof gx=="function"&&px(n),xi&&typeof xi.setStrictMode=="function")try{xi.setStrictMode(Ja,n)}catch{}}var wi=Math.clz32?Math.clz32:vx,mx=Math.log,yx=Math.LN2;function vx(n){return n>>>=0,n===0?32:31-(mx(n)/yx|0)|0}var Nl=256,Fl=262144,jl=4194304;function $n(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function zl(n,a,l){var d=n.pendingLanes;if(d===0)return 0;var m=0,y=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var A=d&134217727;return A!==0?(d=A&~y,d!==0?m=$n(d):(x&=A,x!==0?m=$n(x):l||(l=A&~n,l!==0&&(m=$n(l))))):(A=d&~y,A!==0?m=$n(A):x!==0?m=$n(x):l||(l=d&~n,l!==0&&(m=$n(l)))),m===0?0:a!==0&&a!==m&&(a&y)===0&&(y=m&-m,l=a&-a,y>=l||y===32&&(l&4194048)!==0)?a:m}function to(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function bx(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Op(){var n=jl;return jl<<=1,(jl&62914560)===0&&(jl=4194304),n}function Du(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function eo(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function _x(n,a,l,d,m,y){var x=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var A=n.entanglements,k=n.expirationTimes,U=n.hiddenUpdates;for(l=x&~l;0<l;){var W=31-wi(l),Z=1<<W;A[W]=0,k[W]=-1;var V=U[W];if(V!==null)for(U[W]=null,W=0;W<V.length;W++){var q=V[W];q!==null&&(q.lane&=-536870913)}l&=~Z}d!==0&&kp(n,d,0),y!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=y&~(x&~a))}function kp(n,a,l){n.pendingLanes|=a,n.suspendedLanes&=~a;var d=31-wi(a);n.entangledLanes|=a,n.entanglements[d]=n.entanglements[d]|1073741824|l&261930}function Rp(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var d=31-wi(l),m=1<<d;m&a|n[d]&a&&(n[d]|=a),l&=~m}}function Lp(n,a){var l=a&-a;return l=(l&42)!==0?1:Mu(l),(l&(n.suspendedLanes|a))!==0?0:l}function Mu(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Ou(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Pp(){var n=I.p;return n!==0?n:(n=window.event,n===void 0?32:bv(n.type))}function Bp(n,a){var l=I.p;try{return I.p=n,a()}finally{I.p=l}}var mn=Math.random().toString(36).slice(2),He="__reactFiber$"+mn,oi="__reactProps$"+mn,Pr="__reactContainer$"+mn,ku="__reactEvents$"+mn,Sx="__reactListeners$"+mn,xx="__reactHandles$"+mn,Np="__reactResources$"+mn,io="__reactMarker$"+mn;function Ru(n){delete n[He],delete n[oi],delete n[ku],delete n[Sx],delete n[xx]}function Br(n){var a=n[He];if(a)return a;for(var l=n.parentNode;l;){if(a=l[Pr]||l[He]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=sv(n);n!==null;){if(l=n[He])return l;n=sv(n)}return a}n=l,l=n.parentNode}return null}function Nr(n){if(n=n[He]||n[Pr]){var a=n.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return n}return null}function so(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(i(33))}function Fr(n){var a=n[Np];return a||(a=n[Np]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ne(n){n[io]=!0}var Fp=new Set,jp={};function Qn(n,a){jr(n,a),jr(n+"Capture",a)}function jr(n,a){for(jp[n]=a,n=0;n<a.length;n++)Fp.add(a[n])}var wx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),zp={},Ip={};function Cx(n){return Kn.call(Ip,n)?!0:Kn.call(zp,n)?!1:wx.test(n)?Ip[n]=!0:(zp[n]=!0,!1)}function Il(n,a,l){if(Cx(a))if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+l)}}function Hl(n,a,l){if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+l)}}function Ps(n,a,l,d){if(d===null)n.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(a,l,""+d)}}function Ni(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Hp(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ax(n,a,l){var d=Object.getOwnPropertyDescriptor(n.constructor.prototype,a);if(!n.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var m=d.get,y=d.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return m.call(this)},set:function(x){l=""+x,y.call(this,x)}}),Object.defineProperty(n,a,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Lu(n){if(!n._valueTracker){var a=Hp(n)?"checked":"value";n._valueTracker=Ax(n,a,""+n[a])}}function Up(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),d="";return n&&(d=Hp(n)?n.checked?"true":"false":n.value),n=d,n!==l?(a.setValue(n),!0):!1}function Ul(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Tx=/[\n"\\]/g;function Fi(n){return n.replace(Tx,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Pu(n,a,l,d,m,y,x,A){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),a!=null?x==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+Ni(a)):n.value!==""+Ni(a)&&(n.value=""+Ni(a)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),a!=null?Bu(n,x,Ni(a)):l!=null?Bu(n,x,Ni(l)):d!=null&&n.removeAttribute("value"),m==null&&y!=null&&(n.defaultChecked=!!y),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.name=""+Ni(A):n.removeAttribute("name")}function Gp(n,a,l,d,m,y,x,A){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(n.type=y),a!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||a!=null)){Lu(n);return}l=l!=null?""+Ni(l):"",a=a!=null?""+Ni(a):l,A||a===n.value||(n.value=a),n.defaultValue=a}d=d??m,d=typeof d!="function"&&typeof d!="symbol"&&!!d,n.checked=A?n.checked:!!d,n.defaultChecked=!!d,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),Lu(n)}function Bu(n,a,l){a==="number"&&Ul(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function zr(n,a,l,d){if(n=n.options,a){a={};for(var m=0;m<l.length;m++)a["$"+l[m]]=!0;for(l=0;l<n.length;l++)m=a.hasOwnProperty("$"+n[l].value),n[l].selected!==m&&(n[l].selected=m),m&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Ni(l),a=null,m=0;m<n.length;m++){if(n[m].value===l){n[m].selected=!0,d&&(n[m].defaultSelected=!0);return}a!==null||n[m].disabled||(a=n[m])}a!==null&&(a.selected=!0)}}function Vp(n,a,l){if(a!=null&&(a=""+Ni(a),a!==n.value&&(n.value=a),l==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=l!=null?""+Ni(l):""}function Xp(n,a,l,d){if(a==null){if(d!=null){if(l!=null)throw Error(i(92));if(lt(d)){if(1<d.length)throw Error(i(93));d=d[0]}l=d}l==null&&(l=""),a=l}l=Ni(a),n.defaultValue=l,d=n.textContent,d===l&&d!==""&&d!==null&&(n.value=d),Lu(n)}function Ir(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var Ex=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yp(n,a,l){var d=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":d?n.setProperty(a,l):typeof l!="number"||l===0||Ex.has(a)?a==="float"?n.cssFloat=l:n[a]=(""+l).trim():n[a]=l+"px"}function qp(n,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(n=n.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?n.setProperty(d,""):d==="float"?n.cssFloat="":n[d]="");for(var m in a)d=a[m],a.hasOwnProperty(m)&&l[m]!==d&&Yp(n,m,d)}else for(var y in a)a.hasOwnProperty(y)&&Yp(n,y,a[y])}function Nu(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gl(n){return Mx.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Bs(){}var Fu=null;function ju(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Hr=null,Ur=null;function Wp(n){var a=Nr(n);if(a&&(n=a.stateNode)){var l=n[oi]||null;t:switch(n=a.stateNode,a.type){case"input":if(Pu(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Fi(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var d=l[a];if(d!==n&&d.form===n.form){var m=d[oi]||null;if(!m)throw Error(i(90));Pu(d,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<l.length;a++)d=l[a],d.form===n.form&&Up(d)}break t;case"textarea":Vp(n,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&zr(n,!!l.multiple,a,!1)}}}var zu=!1;function Kp(n,a,l){if(zu)return n(a,l);zu=!0;try{var d=n(a);return d}finally{if(zu=!1,(Hr!==null||Ur!==null)&&(Oc(),Hr&&(a=Hr,n=Ur,Ur=Hr=null,Wp(a),n)))for(a=0;a<n.length;a++)Wp(n[a])}}function no(n,a){var l=n.stateNode;if(l===null)return null;var d=l[oi]||null;if(d===null)return null;l=d[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break t;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Iu=!1;if(Ns)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){Iu=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{Iu=!1}var yn=null,Hu=null,Vl=null;function $p(){if(Vl)return Vl;var n,a=Hu,l=a.length,d,m="value"in yn?yn.value:yn.textContent,y=m.length;for(n=0;n<l&&a[n]===m[n];n++);var x=l-n;for(d=1;d<=x&&a[l-d]===m[y-d];d++);return Vl=m.slice(n,1<d?1-d:void 0)}function Xl(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function Yl(){return!0}function Qp(){return!1}function li(n){function a(l,d,m,y,x){this._reactName=l,this._targetInst=m,this.type=d,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var A in n)n.hasOwnProperty(A)&&(l=n[A],this[A]=l?l(y):y[A]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Yl:Qp,this.isPropagationStopped=Qp,this}return p(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Yl)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Yl)},persist:function(){},isPersistent:Yl}),a}var Zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=li(Zn),ao=p({},Zn,{view:0,detail:0}),Ox=li(ao),Uu,Gu,oo,Wl=p({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==oo&&(oo&&n.type==="mousemove"?(Uu=n.screenX-oo.screenX,Gu=n.screenY-oo.screenY):Gu=Uu=0,oo=n),Uu)},movementY:function(n){return"movementY"in n?n.movementY:Gu}}),Zp=li(Wl),kx=p({},Wl,{dataTransfer:0}),Rx=li(kx),Lx=p({},ao,{relatedTarget:0}),Vu=li(Lx),Px=p({},Zn,{animationName:0,elapsedTime:0,pseudoElement:0}),Bx=li(Px),Nx=p({},Zn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Fx=li(Nx),jx=p({},Zn,{data:0}),Jp=li(jx),zx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ix={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ux(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Hx[n])?!!a[n]:!1}function Xu(){return Ux}var Gx=p({},ao,{key:function(n){if(n.key){var a=zx[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Xl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ix[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(n){return n.type==="keypress"?Xl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Xl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Vx=li(Gx),Xx=p({},Wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tm=li(Xx),Yx=p({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),qx=li(Yx),Wx=p({},Zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kx=li(Wx),$x=p({},Wl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Qx=li($x),Zx=p({},Zn,{newState:0,oldState:0}),Jx=li(Zx),tw=[9,13,27,32],Yu=Ns&&"CompositionEvent"in window,lo=null;Ns&&"documentMode"in document&&(lo=document.documentMode);var ew=Ns&&"TextEvent"in window&&!lo,em=Ns&&(!Yu||lo&&8<lo&&11>=lo),im=" ",sm=!1;function nm(n,a){switch(n){case"keyup":return tw.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Gr=!1;function iw(n,a){switch(n){case"compositionend":return rm(a);case"keypress":return a.which!==32?null:(sm=!0,im);case"textInput":return n=a.data,n===im&&sm?null:n;default:return null}}function sw(n,a){if(Gr)return n==="compositionend"||!Yu&&nm(n,a)?(n=$p(),Vl=Hu=yn=null,Gr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return em&&a.locale!=="ko"?null:a.data;default:return null}}var nw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function am(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!nw[n.type]:a==="textarea"}function om(n,a,l,d){Hr?Ur?Ur.push(d):Ur=[d]:Hr=d,a=Fc(a,"onChange"),0<a.length&&(l=new ql("onChange","change",null,l,d),n.push({event:l,listeners:a}))}var co=null,ho=null;function rw(n){Gy(n,0)}function Kl(n){var a=so(n);if(Up(a))return n}function lm(n,a){if(n==="change")return a}var cm=!1;if(Ns){var qu;if(Ns){var Wu="oninput"in document;if(!Wu){var hm=document.createElement("div");hm.setAttribute("oninput","return;"),Wu=typeof hm.oninput=="function"}qu=Wu}else qu=!1;cm=qu&&(!document.documentMode||9<document.documentMode)}function um(){co&&(co.detachEvent("onpropertychange",dm),ho=co=null)}function dm(n){if(n.propertyName==="value"&&Kl(ho)){var a=[];om(a,ho,n,ju(n)),Kp(rw,a)}}function aw(n,a,l){n==="focusin"?(um(),co=a,ho=l,co.attachEvent("onpropertychange",dm)):n==="focusout"&&um()}function ow(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Kl(ho)}function lw(n,a){if(n==="click")return Kl(a)}function cw(n,a){if(n==="input"||n==="change")return Kl(a)}function hw(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Ci=typeof Object.is=="function"?Object.is:hw;function uo(n,a){if(Ci(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),d=Object.keys(a);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var m=l[d];if(!Kn.call(a,m)||!Ci(n[m],a[m]))return!1}return!0}function fm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function gm(n,a){var l=fm(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=a&&d>=a)return{node:l,offset:a-n};n=d}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=fm(l)}}function pm(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?pm(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function mm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Ul(n.document);a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=Ul(n.document)}return a}function Ku(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var uw=Ns&&"documentMode"in document&&11>=document.documentMode,Vr=null,$u=null,fo=null,Qu=!1;function ym(n,a,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Qu||Vr==null||Vr!==Ul(d)||(d=Vr,"selectionStart"in d&&Ku(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),fo&&uo(fo,d)||(fo=d,d=Fc($u,"onSelect"),0<d.length&&(a=new ql("onSelect","select",null,a,l),n.push({event:a,listeners:d}),a.target=Vr)))}function Jn(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var Xr={animationend:Jn("Animation","AnimationEnd"),animationiteration:Jn("Animation","AnimationIteration"),animationstart:Jn("Animation","AnimationStart"),transitionrun:Jn("Transition","TransitionRun"),transitionstart:Jn("Transition","TransitionStart"),transitioncancel:Jn("Transition","TransitionCancel"),transitionend:Jn("Transition","TransitionEnd")},Zu={},vm={};Ns&&(vm=document.createElement("div").style,"AnimationEvent"in window||(delete Xr.animationend.animation,delete Xr.animationiteration.animation,delete Xr.animationstart.animation),"TransitionEvent"in window||delete Xr.transitionend.transition);function tr(n){if(Zu[n])return Zu[n];if(!Xr[n])return n;var a=Xr[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in vm)return Zu[n]=a[l];return n}var bm=tr("animationend"),_m=tr("animationiteration"),Sm=tr("animationstart"),dw=tr("transitionrun"),fw=tr("transitionstart"),gw=tr("transitioncancel"),xm=tr("transitionend"),wm=new Map,Ju="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ju.push("scrollEnd");function is(n,a){wm.set(n,a),Qn(a,[n])}var $l=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ji=[],Yr=0,td=0;function Ql(){for(var n=Yr,a=td=Yr=0;a<n;){var l=ji[a];ji[a++]=null;var d=ji[a];ji[a++]=null;var m=ji[a];ji[a++]=null;var y=ji[a];if(ji[a++]=null,d!==null&&m!==null){var x=d.pending;x===null?m.next=m:(m.next=x.next,x.next=m),d.pending=m}y!==0&&Cm(l,m,y)}}function Zl(n,a,l,d){ji[Yr++]=n,ji[Yr++]=a,ji[Yr++]=l,ji[Yr++]=d,td|=d,n.lanes|=d,n=n.alternate,n!==null&&(n.lanes|=d)}function ed(n,a,l,d){return Zl(n,a,l,d),Jl(n)}function er(n,a){return Zl(n,null,null,a),Jl(n)}function Cm(n,a,l){n.lanes|=l;var d=n.alternate;d!==null&&(d.lanes|=l);for(var m=!1,y=n.return;y!==null;)y.childLanes|=l,d=y.alternate,d!==null&&(d.childLanes|=l),y.tag===22&&(n=y.stateNode,n===null||n._visibility&1||(m=!0)),n=y,y=y.return;return n.tag===3?(y=n.stateNode,m&&a!==null&&(m=31-wi(l),n=y.hiddenUpdates,d=n[m],d===null?n[m]=[a]:d.push(a),a.lane=l|536870912),y):null}function Jl(n){if(50<Bo)throw Bo=0,uf=null,Error(i(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var qr={};function pw(n,a,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ai(n,a,l,d){return new pw(n,a,l,d)}function id(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Fs(n,a){var l=n.alternate;return l===null?(l=Ai(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function Am(n,a){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,a=l.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function tc(n,a,l,d,m,y){var x=0;if(d=n,typeof n=="function")id(n)&&(x=1);else if(typeof n=="string")x=_1(n,l,nt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case G:return n=Ai(31,l,a,m),n.elementType=G,n.lanes=y,n;case _:return ir(l.children,m,y,a);case C:x=8,m|=24;break;case w:return n=Ai(12,l,a,m|2),n.elementType=w,n.lanes=y,n;case M:return n=Ai(13,l,a,m),n.elementType=M,n.lanes=y,n;case O:return n=Ai(19,l,a,m),n.elementType=O,n.lanes=y,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case E:x=10;break t;case T:x=9;break t;case D:x=11;break t;case R:x=14;break t;case j:x=16,d=null;break t}x=29,l=Error(i(130,n===null?"null":typeof n,"")),d=null}return a=Ai(x,l,a,m),a.elementType=n,a.type=d,a.lanes=y,a}function ir(n,a,l,d){return n=Ai(7,n,d,a),n.lanes=l,n}function sd(n,a,l){return n=Ai(6,n,null,a),n.lanes=l,n}function Tm(n){var a=Ai(18,null,null,0);return a.stateNode=n,a}function nd(n,a,l){return a=Ai(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var Em=new WeakMap;function zi(n,a){if(typeof n=="object"&&n!==null){var l=Em.get(n);return l!==void 0?l:(a={value:n,source:a,stack:Be(a)},Em.set(n,a),a)}return{value:n,source:a,stack:Be(a)}}var Wr=[],Kr=0,ec=null,go=0,Ii=[],Hi=0,vn=null,ps=1,ms="";function js(n,a){Wr[Kr++]=go,Wr[Kr++]=ec,ec=n,go=a}function Dm(n,a,l){Ii[Hi++]=ps,Ii[Hi++]=ms,Ii[Hi++]=vn,vn=n;var d=ps;n=ms;var m=32-wi(d)-1;d&=~(1<<m),l+=1;var y=32-wi(a)+m;if(30<y){var x=m-m%5;y=(d&(1<<x)-1).toString(32),d>>=x,m-=x,ps=1<<32-wi(a)+m|l<<m|d,ms=y+n}else ps=1<<y|l<<m|d,ms=n}function rd(n){n.return!==null&&(js(n,1),Dm(n,1,0))}function ad(n){for(;n===ec;)ec=Wr[--Kr],Wr[Kr]=null,go=Wr[--Kr],Wr[Kr]=null;for(;n===vn;)vn=Ii[--Hi],Ii[Hi]=null,ms=Ii[--Hi],Ii[Hi]=null,ps=Ii[--Hi],Ii[Hi]=null}function Mm(n,a){Ii[Hi++]=ps,Ii[Hi++]=ms,Ii[Hi++]=vn,ps=a.id,ms=a.overflow,vn=n}var Ue=null,le=null,Gt=!1,bn=null,Ui=!1,od=Error(i(519));function _n(n){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw po(zi(a,n)),od}function Om(n){var a=n.stateNode,l=n.type,d=n.memoizedProps;switch(a[He]=n,a[oi]=d,l){case"dialog":zt("cancel",a),zt("close",a);break;case"iframe":case"object":case"embed":zt("load",a);break;case"video":case"audio":for(l=0;l<Fo.length;l++)zt(Fo[l],a);break;case"source":zt("error",a);break;case"img":case"image":case"link":zt("error",a),zt("load",a);break;case"details":zt("toggle",a);break;case"input":zt("invalid",a),Gp(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":zt("invalid",a);break;case"textarea":zt("invalid",a),Xp(a,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||d.suppressHydrationWarning===!0||qy(a.textContent,l)?(d.popover!=null&&(zt("beforetoggle",a),zt("toggle",a)),d.onScroll!=null&&zt("scroll",a),d.onScrollEnd!=null&&zt("scrollend",a),d.onClick!=null&&(a.onclick=Bs),a=!0):a=!1,a||_n(n,!0)}function km(n){for(Ue=n.return;Ue;)switch(Ue.tag){case 5:case 31:case 13:Ui=!1;return;case 27:case 3:Ui=!0;return;default:Ue=Ue.return}}function $r(n){if(n!==Ue)return!1;if(!Gt)return km(n),Gt=!0,!1;var a=n.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Tf(n.type,n.memoizedProps)),l=!l),l&&le&&_n(n),km(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));le=iv(n)}else if(a===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));le=iv(n)}else a===27?(a=le,Pn(n.type)?(n=kf,kf=null,le=n):le=a):le=Ue?Vi(n.stateNode.nextSibling):null;return!0}function sr(){le=Ue=null,Gt=!1}function ld(){var n=bn;return n!==null&&(di===null?di=n:di.push.apply(di,n),bn=null),n}function po(n){bn===null?bn=[n]:bn.push(n)}var cd=P(null),nr=null,zs=null;function Sn(n,a,l){et(cd,a._currentValue),a._currentValue=l}function Is(n){n._currentValue=cd.current,Y(cd)}function hd(n,a,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),n===l)break;n=n.return}}function ud(n,a,l,d){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var y=m.dependencies;if(y!==null){var x=m.child;y=y.firstContext;t:for(;y!==null;){var A=y;y=m;for(var k=0;k<a.length;k++)if(A.context===a[k]){y.lanes|=l,A=y.alternate,A!==null&&(A.lanes|=l),hd(y.return,l,n),d||(x=null);break t}y=A.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(i(341));x.lanes|=l,y=x.alternate,y!==null&&(y.lanes|=l),hd(x,l,n),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===n){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function Qr(n,a,l,d){n=null;for(var m=a,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var A=m.type;Ci(m.pendingProps.value,x.value)||(n!==null?n.push(A):n=[A])}}else if(m===pt.current){if(x=m.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(Uo):n=[Uo])}m=m.return}n!==null&&ud(a,n,l,d),a.flags|=262144}function ic(n){for(n=n.firstContext;n!==null;){if(!Ci(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function rr(n){nr=n,zs=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ge(n){return Rm(nr,n)}function sc(n,a){return nr===null&&rr(n),Rm(n,a)}function Rm(n,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},zs===null){if(n===null)throw Error(i(308));zs=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else zs=zs.next=a;return l}var mw=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(l,d){n.push(d)}};this.abort=function(){a.aborted=!0,n.forEach(function(l){return l()})}},yw=u.unstable_scheduleCallback,vw=u.unstable_NormalPriority,Te={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dd(){return{controller:new mw,data:new Map,refCount:0}}function mo(n){n.refCount--,n.refCount===0&&yw(vw,function(){n.controller.abort()})}var yo=null,fd=0,Zr=0,Jr=null;function bw(n,a){if(yo===null){var l=yo=[];fd=0,Zr=yf(),Jr={status:"pending",value:void 0,then:function(d){l.push(d)}}}return fd++,a.then(Lm,Lm),a}function Lm(){if(--fd===0&&yo!==null){Jr!==null&&(Jr.status="fulfilled");var n=yo;yo=null,Zr=0,Jr=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function _w(n,a){var l=[],d={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return n.then(function(){d.status="fulfilled",d.value=a;for(var m=0;m<l.length;m++)(0,l[m])(a)},function(m){for(d.status="rejected",d.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),d}var Pm=L.S;L.S=function(n,a){yy=ti(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&bw(n,a),Pm!==null&&Pm(n,a)};var ar=P(null);function gd(){var n=ar.current;return n!==null?n:ne.pooledCache}function nc(n,a){a===null?et(ar,ar.current):et(ar,a.pool)}function Bm(){var n=gd();return n===null?null:{parent:Te._currentValue,pool:n}}var ta=Error(i(460)),pd=Error(i(474)),rc=Error(i(542)),ac={then:function(){}};function Nm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Fm(n,a,l){switch(l=n[l],l===void 0?n.push(a):l!==a&&(a.then(Bs,Bs),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,zm(n),n;default:if(typeof a.status=="string")a.then(Bs,Bs);else{if(n=ne,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=a,n.status="pending",n.then(function(d){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=d}},function(d){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,zm(n),n}throw lr=a,ta}}function or(n){try{var a=n._init;return a(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(lr=l,ta):l}}var lr=null;function jm(){if(lr===null)throw Error(i(459));var n=lr;return lr=null,n}function zm(n){if(n===ta||n===rc)throw Error(i(483))}var ea=null,vo=0;function oc(n){var a=vo;return vo+=1,ea===null&&(ea=[]),Fm(ea,n,a)}function bo(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function lc(n,a){throw a.$$typeof===v?Error(i(525)):(n=Object.prototype.toString.call(a),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function Im(n){function a(z,N){if(n){var H=z.deletions;H===null?(z.deletions=[N],z.flags|=16):H.push(N)}}function l(z,N){if(!n)return null;for(;N!==null;)a(z,N),N=N.sibling;return null}function d(z){for(var N=new Map;z!==null;)z.key!==null?N.set(z.key,z):N.set(z.index,z),z=z.sibling;return N}function m(z,N){return z=Fs(z,N),z.index=0,z.sibling=null,z}function y(z,N,H){return z.index=H,n?(H=z.alternate,H!==null?(H=H.index,H<N?(z.flags|=67108866,N):H):(z.flags|=67108866,N)):(z.flags|=1048576,N)}function x(z){return n&&z.alternate===null&&(z.flags|=67108866),z}function A(z,N,H,$){return N===null||N.tag!==6?(N=sd(H,z.mode,$),N.return=z,N):(N=m(N,H),N.return=z,N)}function k(z,N,H,$){var St=H.type;return St===_?W(z,N,H.props.children,$,H.key):N!==null&&(N.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===j&&or(St)===N.type)?(N=m(N,H.props),bo(N,H),N.return=z,N):(N=tc(H.type,H.key,H.props,null,z.mode,$),bo(N,H),N.return=z,N)}function U(z,N,H,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==H.containerInfo||N.stateNode.implementation!==H.implementation?(N=nd(H,z.mode,$),N.return=z,N):(N=m(N,H.children||[]),N.return=z,N)}function W(z,N,H,$,St){return N===null||N.tag!==7?(N=ir(H,z.mode,$,St),N.return=z,N):(N=m(N,H),N.return=z,N)}function Z(z,N,H){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=sd(""+N,z.mode,H),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return H=tc(N.type,N.key,N.props,null,z.mode,H),bo(H,N),H.return=z,H;case S:return N=nd(N,z.mode,H),N.return=z,N;case j:return N=or(N),Z(z,N,H)}if(lt(N)||st(N))return N=ir(N,z.mode,H,null),N.return=z,N;if(typeof N.then=="function")return Z(z,oc(N),H);if(N.$$typeof===E)return Z(z,sc(z,N),H);lc(z,N)}return null}function V(z,N,H,$){var St=N!==null?N.key:null;if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return St!==null?null:A(z,N,""+H,$);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case b:return H.key===St?k(z,N,H,$):null;case S:return H.key===St?U(z,N,H,$):null;case j:return H=or(H),V(z,N,H,$)}if(lt(H)||st(H))return St!==null?null:W(z,N,H,$,null);if(typeof H.then=="function")return V(z,N,oc(H),$);if(H.$$typeof===E)return V(z,N,sc(z,H),$);lc(z,H)}return null}function q(z,N,H,$,St){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return z=z.get(H)||null,A(N,z,""+$,St);if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return z=z.get($.key===null?H:$.key)||null,k(N,z,$,St);case S:return z=z.get($.key===null?H:$.key)||null,U(N,z,$,St);case j:return $=or($),q(z,N,H,$,St)}if(lt($)||st($))return z=z.get(H)||null,W(N,z,$,St,null);if(typeof $.then=="function")return q(z,N,H,oc($),St);if($.$$typeof===E)return q(z,N,H,sc(N,$),St);lc(N,$)}return null}function mt(z,N,H,$){for(var St=null,Yt=null,vt=N,Bt=N=0,Ht=null;vt!==null&&Bt<H.length;Bt++){vt.index>Bt?(Ht=vt,vt=null):Ht=vt.sibling;var qt=V(z,vt,H[Bt],$);if(qt===null){vt===null&&(vt=Ht);break}n&&vt&&qt.alternate===null&&a(z,vt),N=y(qt,N,Bt),Yt===null?St=qt:Yt.sibling=qt,Yt=qt,vt=Ht}if(Bt===H.length)return l(z,vt),Gt&&js(z,Bt),St;if(vt===null){for(;Bt<H.length;Bt++)vt=Z(z,H[Bt],$),vt!==null&&(N=y(vt,N,Bt),Yt===null?St=vt:Yt.sibling=vt,Yt=vt);return Gt&&js(z,Bt),St}for(vt=d(vt);Bt<H.length;Bt++)Ht=q(vt,z,Bt,H[Bt],$),Ht!==null&&(n&&Ht.alternate!==null&&vt.delete(Ht.key===null?Bt:Ht.key),N=y(Ht,N,Bt),Yt===null?St=Ht:Yt.sibling=Ht,Yt=Ht);return n&&vt.forEach(function(zn){return a(z,zn)}),Gt&&js(z,Bt),St}function Ct(z,N,H,$){if(H==null)throw Error(i(151));for(var St=null,Yt=null,vt=N,Bt=N=0,Ht=null,qt=H.next();vt!==null&&!qt.done;Bt++,qt=H.next()){vt.index>Bt?(Ht=vt,vt=null):Ht=vt.sibling;var zn=V(z,vt,qt.value,$);if(zn===null){vt===null&&(vt=Ht);break}n&&vt&&zn.alternate===null&&a(z,vt),N=y(zn,N,Bt),Yt===null?St=zn:Yt.sibling=zn,Yt=zn,vt=Ht}if(qt.done)return l(z,vt),Gt&&js(z,Bt),St;if(vt===null){for(;!qt.done;Bt++,qt=H.next())qt=Z(z,qt.value,$),qt!==null&&(N=y(qt,N,Bt),Yt===null?St=qt:Yt.sibling=qt,Yt=qt);return Gt&&js(z,Bt),St}for(vt=d(vt);!qt.done;Bt++,qt=H.next())qt=q(vt,z,Bt,qt.value,$),qt!==null&&(n&&qt.alternate!==null&&vt.delete(qt.key===null?Bt:qt.key),N=y(qt,N,Bt),Yt===null?St=qt:Yt.sibling=qt,Yt=qt);return n&&vt.forEach(function(k1){return a(z,k1)}),Gt&&js(z,Bt),St}function ie(z,N,H,$){if(typeof H=="object"&&H!==null&&H.type===_&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case b:t:{for(var St=H.key;N!==null;){if(N.key===St){if(St=H.type,St===_){if(N.tag===7){l(z,N.sibling),$=m(N,H.props.children),$.return=z,z=$;break t}}else if(N.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===j&&or(St)===N.type){l(z,N.sibling),$=m(N,H.props),bo($,H),$.return=z,z=$;break t}l(z,N);break}else a(z,N);N=N.sibling}H.type===_?($=ir(H.props.children,z.mode,$,H.key),$.return=z,z=$):($=tc(H.type,H.key,H.props,null,z.mode,$),bo($,H),$.return=z,z=$)}return x(z);case S:t:{for(St=H.key;N!==null;){if(N.key===St)if(N.tag===4&&N.stateNode.containerInfo===H.containerInfo&&N.stateNode.implementation===H.implementation){l(z,N.sibling),$=m(N,H.children||[]),$.return=z,z=$;break t}else{l(z,N);break}else a(z,N);N=N.sibling}$=nd(H,z.mode,$),$.return=z,z=$}return x(z);case j:return H=or(H),ie(z,N,H,$)}if(lt(H))return mt(z,N,H,$);if(st(H)){if(St=st(H),typeof St!="function")throw Error(i(150));return H=St.call(H),Ct(z,N,H,$)}if(typeof H.then=="function")return ie(z,N,oc(H),$);if(H.$$typeof===E)return ie(z,N,sc(z,H),$);lc(z,H)}return typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint"?(H=""+H,N!==null&&N.tag===6?(l(z,N.sibling),$=m(N,H),$.return=z,z=$):(l(z,N),$=sd(H,z.mode,$),$.return=z,z=$),x(z)):l(z,N)}return function(z,N,H,$){try{vo=0;var St=ie(z,N,H,$);return ea=null,St}catch(vt){if(vt===ta||vt===rc)throw vt;var Yt=Ai(29,vt,null,z.mode);return Yt.lanes=$,Yt.return=z,Yt}finally{}}}var cr=Im(!0),Hm=Im(!1),xn=!1;function md(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yd(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function wn(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Cn(n,a,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(Kt&2)!==0){var m=d.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),d.pending=a,a=Jl(n),Cm(n,null,l),a}return Zl(n,d,a,l),Jl(n)}function _o(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var d=a.lanes;d&=n.pendingLanes,l|=d,a.lanes=l,Rp(n,l)}}function vd(n,a){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var x={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?m=y=x:y=y.next=x,l=l.next}while(l!==null);y===null?m=y=a:y=y.next=a}else m=y=a;l={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}var bd=!1;function So(){if(bd){var n=Jr;if(n!==null)throw n}}function xo(n,a,l,d){bd=!1;var m=n.updateQueue;xn=!1;var y=m.firstBaseUpdate,x=m.lastBaseUpdate,A=m.shared.pending;if(A!==null){m.shared.pending=null;var k=A,U=k.next;k.next=null,x===null?y=U:x.next=U,x=k;var W=n.alternate;W!==null&&(W=W.updateQueue,A=W.lastBaseUpdate,A!==x&&(A===null?W.firstBaseUpdate=U:A.next=U,W.lastBaseUpdate=k))}if(y!==null){var Z=m.baseState;x=0,W=U=k=null,A=y;do{var V=A.lane&-536870913,q=V!==A.lane;if(q?(It&V)===V:(d&V)===V){V!==0&&V===Zr&&(bd=!0),W!==null&&(W=W.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});t:{var mt=n,Ct=A;V=a;var ie=l;switch(Ct.tag){case 1:if(mt=Ct.payload,typeof mt=="function"){Z=mt.call(ie,Z,V);break t}Z=mt;break t;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Ct.payload,V=typeof mt=="function"?mt.call(ie,Z,V):mt,V==null)break t;Z=p({},Z,V);break t;case 2:xn=!0}}V=A.callback,V!==null&&(n.flags|=64,q&&(n.flags|=8192),q=m.callbacks,q===null?m.callbacks=[V]:q.push(V))}else q={lane:V,tag:A.tag,payload:A.payload,callback:A.callback,next:null},W===null?(U=W=q,k=Z):W=W.next=q,x|=V;if(A=A.next,A===null){if(A=m.shared.pending,A===null)break;q=A,A=q.next,q.next=null,m.lastBaseUpdate=q,m.shared.pending=null}}while(!0);W===null&&(k=Z),m.baseState=k,m.firstBaseUpdate=U,m.lastBaseUpdate=W,y===null&&(m.shared.lanes=0),Mn|=x,n.lanes=x,n.memoizedState=Z}}function Um(n,a){if(typeof n!="function")throw Error(i(191,n));n.call(a)}function Gm(n,a){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Um(l[n],a)}var ia=P(null),cc=P(0);function Vm(n,a){n=Ks,et(cc,n),et(ia,a),Ks=n|a.baseLanes}function _d(){et(cc,Ks),et(ia,ia.current)}function Sd(){Ks=cc.current,Y(ia),Y(cc)}var Ti=P(null),Gi=null;function An(n){var a=n.alternate;et(_e,_e.current&1),et(Ti,n),Gi===null&&(a===null||ia.current!==null||a.memoizedState!==null)&&(Gi=n)}function xd(n){et(_e,_e.current),et(Ti,n),Gi===null&&(Gi=n)}function Xm(n){n.tag===22?(et(_e,_e.current),et(Ti,n),Gi===null&&(Gi=n)):Tn()}function Tn(){et(_e,_e.current),et(Ti,Ti.current)}function Ei(n){Y(Ti),Gi===n&&(Gi=null),Y(_e)}var _e=P(0);function hc(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Mf(l)||Of(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Hs=0,Lt=null,te=null,Ee=null,uc=!1,sa=!1,hr=!1,dc=0,wo=0,na=null,Sw=0;function ve(){throw Error(i(321))}function wd(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!Ci(n[l],a[l]))return!1;return!0}function Cd(n,a,l,d,m,y){return Hs=y,Lt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,L.H=n===null||n.memoizedState===null?D0:zd,hr=!1,y=l(d,m),hr=!1,sa&&(y=qm(a,l,d,m)),Ym(n),y}function Ym(n){L.H=To;var a=te!==null&&te.next!==null;if(Hs=0,Ee=te=Lt=null,uc=!1,wo=0,na=null,a)throw Error(i(300));n===null||De||(n=n.dependencies,n!==null&&ic(n)&&(De=!0))}function qm(n,a,l,d){Lt=n;var m=0;do{if(sa&&(na=null),wo=0,sa=!1,25<=m)throw Error(i(301));if(m+=1,Ee=te=null,n.updateQueue!=null){var y=n.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}L.H=M0,y=a(l,d)}while(sa);return y}function xw(){var n=L.H,a=n.useState()[0];return a=typeof a.then=="function"?Co(a):a,n=n.useState()[0],(te!==null?te.memoizedState:null)!==n&&(Lt.flags|=1024),a}function Ad(){var n=dc!==0;return dc=0,n}function Td(n,a,l){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~l}function Ed(n){if(uc){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}uc=!1}Hs=0,Ee=te=Lt=null,sa=!1,wo=dc=0,na=null}function ei(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ee===null?Lt.memoizedState=Ee=n:Ee=Ee.next=n,Ee}function Se(){if(te===null){var n=Lt.alternate;n=n!==null?n.memoizedState:null}else n=te.next;var a=Ee===null?Lt.memoizedState:Ee.next;if(a!==null)Ee=a,te=n;else{if(n===null)throw Lt.alternate===null?Error(i(467)):Error(i(310));te=n,n={memoizedState:te.memoizedState,baseState:te.baseState,baseQueue:te.baseQueue,queue:te.queue,next:null},Ee===null?Lt.memoizedState=Ee=n:Ee=Ee.next=n}return Ee}function fc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Co(n){var a=wo;return wo+=1,na===null&&(na=[]),n=Fm(na,n,a),a=Lt,(Ee===null?a.memoizedState:Ee.next)===null&&(a=a.alternate,L.H=a===null||a.memoizedState===null?D0:zd),n}function gc(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Co(n);if(n.$$typeof===E)return Ge(n)}throw Error(i(438,String(n)))}function Dd(n){var a=null,l=Lt.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var d=Lt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=fc(),Lt.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(n),d=0;d<n;d++)l[d]=Q;return a.index++,l}function Us(n,a){return typeof a=="function"?a(n):a}function pc(n){var a=Se();return Md(a,te,n)}function Md(n,a,l){var d=n.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=l;var m=n.baseQueue,y=d.pending;if(y!==null){if(m!==null){var x=m.next;m.next=y.next,y.next=x}a.baseQueue=m=y,d.pending=null}if(y=n.baseState,m===null)n.memoizedState=y;else{a=m.next;var A=x=null,k=null,U=a,W=!1;do{var Z=U.lane&-536870913;if(Z!==U.lane?(It&Z)===Z:(Hs&Z)===Z){var V=U.revertLane;if(V===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),Z===Zr&&(W=!0);else if((Hs&V)===V){U=U.next,V===Zr&&(W=!0);continue}else Z={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},k===null?(A=k=Z,x=y):k=k.next=Z,Lt.lanes|=V,Mn|=V;Z=U.action,hr&&l(y,Z),y=U.hasEagerState?U.eagerState:l(y,Z)}else V={lane:Z,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},k===null?(A=k=V,x=y):k=k.next=V,Lt.lanes|=Z,Mn|=Z;U=U.next}while(U!==null&&U!==a);if(k===null?x=y:k.next=A,!Ci(y,n.memoizedState)&&(De=!0,W&&(l=Jr,l!==null)))throw l;n.memoizedState=y,n.baseState=x,n.baseQueue=k,d.lastRenderedState=y}return m===null&&(d.lanes=0),[n.memoizedState,d.dispatch]}function Od(n){var a=Se(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=l.dispatch,m=l.pending,y=a.memoizedState;if(m!==null){l.pending=null;var x=m=m.next;do y=n(y,x.action),x=x.next;while(x!==m);Ci(y,a.memoizedState)||(De=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),l.lastRenderedState=y}return[y,d]}function Wm(n,a,l){var d=Lt,m=Se(),y=Gt;if(y){if(l===void 0)throw Error(i(407));l=l()}else l=a();var x=!Ci((te||m).memoizedState,l);if(x&&(m.memoizedState=l,De=!0),m=m.queue,Ld(Qm.bind(null,d,m,n),[n]),m.getSnapshot!==a||x||Ee!==null&&Ee.memoizedState.tag&1){if(d.flags|=2048,ra(9,{destroy:void 0},$m.bind(null,d,m,l,a),null),ne===null)throw Error(i(349));y||(Hs&127)!==0||Km(d,a,l)}return l}function Km(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=Lt.updateQueue,a===null?(a=fc(),Lt.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function $m(n,a,l,d){a.value=l,a.getSnapshot=d,Zm(a)&&Jm(n)}function Qm(n,a,l){return l(function(){Zm(a)&&Jm(n)})}function Zm(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!Ci(n,l)}catch{return!0}}function Jm(n){var a=er(n,2);a!==null&&fi(a,n,2)}function kd(n){var a=ei();if(typeof n=="function"){var l=n;if(n=l(),hr){pn(!0);try{l()}finally{pn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:n},a}function t0(n,a,l,d){return n.baseState=l,Md(n,te,typeof d=="function"?d:Us)}function ww(n,a,l,d,m){if(vc(n))throw Error(i(485));if(n=a.action,n!==null){var y={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){y.listeners.push(x)}};L.T!==null?l(!0):y.isTransition=!1,d(y),l=a.pending,l===null?(y.next=a.pending=y,e0(a,y)):(y.next=l.next,a.pending=l.next=y)}}function e0(n,a){var l=a.action,d=a.payload,m=n.state;if(a.isTransition){var y=L.T,x={};L.T=x;try{var A=l(m,d),k=L.S;k!==null&&k(x,A),i0(n,a,A)}catch(U){Rd(n,a,U)}finally{y!==null&&x.types!==null&&(y.types=x.types),L.T=y}}else try{y=l(m,d),i0(n,a,y)}catch(U){Rd(n,a,U)}}function i0(n,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){s0(n,a,d)},function(d){return Rd(n,a,d)}):s0(n,a,l)}function s0(n,a,l){a.status="fulfilled",a.value=l,n0(a),n.state=l,a=n.pending,a!==null&&(l=a.next,l===a?n.pending=null:(l=l.next,a.next=l,e0(n,l)))}function Rd(n,a,l){var d=n.pending;if(n.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=l,n0(a),a=a.next;while(a!==d)}n.action=null}function n0(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function r0(n,a){return a}function a0(n,a){if(Gt){var l=ne.formState;if(l!==null){t:{var d=Lt;if(Gt){if(le){e:{for(var m=le,y=Ui;m.nodeType!==8;){if(!y){m=null;break e}if(m=Vi(m.nextSibling),m===null){m=null;break e}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){le=Vi(m.nextSibling),d=m.data==="F!";break t}}_n(d)}d=!1}d&&(a=l[0])}}return l=ei(),l.memoizedState=l.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:a},l.queue=d,l=A0.bind(null,Lt,d),d.dispatch=l,d=kd(!1),y=jd.bind(null,Lt,!1,d.queue),d=ei(),m={state:a,dispatch:null,action:n,pending:null},d.queue=m,l=ww.bind(null,Lt,m,y,l),m.dispatch=l,d.memoizedState=n,[a,l,!1]}function o0(n){var a=Se();return l0(a,te,n)}function l0(n,a,l){if(a=Md(n,a,r0)[0],n=pc(Us)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=Co(a)}catch(x){throw x===ta?rc:x}else d=a;a=Se();var m=a.queue,y=m.dispatch;return l!==a.memoizedState&&(Lt.flags|=2048,ra(9,{destroy:void 0},Cw.bind(null,m,l),null)),[d,y,n]}function Cw(n,a){n.action=a}function c0(n){var a=Se(),l=te;if(l!==null)return l0(a,l,n);Se(),a=a.memoizedState,l=Se();var d=l.queue.dispatch;return l.memoizedState=n,[a,d,!1]}function ra(n,a,l,d){return n={tag:n,create:l,deps:d,inst:a,next:null},a=Lt.updateQueue,a===null&&(a=fc(),Lt.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,a.lastEffect=n),n}function h0(){return Se().memoizedState}function mc(n,a,l,d){var m=ei();Lt.flags|=n,m.memoizedState=ra(1|a,{destroy:void 0},l,d===void 0?null:d)}function yc(n,a,l,d){var m=Se();d=d===void 0?null:d;var y=m.memoizedState.inst;te!==null&&d!==null&&wd(d,te.memoizedState.deps)?m.memoizedState=ra(a,y,l,d):(Lt.flags|=n,m.memoizedState=ra(1|a,y,l,d))}function u0(n,a){mc(8390656,8,n,a)}function Ld(n,a){yc(2048,8,n,a)}function Aw(n){Lt.flags|=4;var a=Lt.updateQueue;if(a===null)a=fc(),Lt.updateQueue=a,a.events=[n];else{var l=a.events;l===null?a.events=[n]:l.push(n)}}function d0(n){var a=Se().memoizedState;return Aw({ref:a,nextImpl:n}),function(){if((Kt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function f0(n,a){return yc(4,2,n,a)}function g0(n,a){return yc(4,4,n,a)}function p0(n,a){if(typeof a=="function"){n=n();var l=a(n);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function m0(n,a,l){l=l!=null?l.concat([n]):null,yc(4,4,p0.bind(null,a,n),l)}function Pd(){}function y0(n,a){var l=Se();a=a===void 0?null:a;var d=l.memoizedState;return a!==null&&wd(a,d[1])?d[0]:(l.memoizedState=[n,a],n)}function v0(n,a){var l=Se();a=a===void 0?null:a;var d=l.memoizedState;if(a!==null&&wd(a,d[1]))return d[0];if(d=n(),hr){pn(!0);try{n()}finally{pn(!1)}}return l.memoizedState=[d,a],d}function Bd(n,a,l){return l===void 0||(Hs&1073741824)!==0&&(It&261930)===0?n.memoizedState=a:(n.memoizedState=l,n=by(),Lt.lanes|=n,Mn|=n,l)}function b0(n,a,l,d){return Ci(l,a)?l:ia.current!==null?(n=Bd(n,l,d),Ci(n,a)||(De=!0),n):(Hs&42)===0||(Hs&1073741824)!==0&&(It&261930)===0?(De=!0,n.memoizedState=l):(n=by(),Lt.lanes|=n,Mn|=n,a)}function _0(n,a,l,d,m){var y=I.p;I.p=y!==0&&8>y?y:8;var x=L.T,A={};L.T=A,jd(n,!1,a,l);try{var k=m(),U=L.S;if(U!==null&&U(A,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var W=_w(k,d);Ao(n,a,W,Oi(n))}else Ao(n,a,d,Oi(n))}catch(Z){Ao(n,a,{then:function(){},status:"rejected",reason:Z},Oi())}finally{I.p=y,x!==null&&A.types!==null&&(x.types=A.types),L.T=x}}function Tw(){}function Nd(n,a,l,d){if(n.tag!==5)throw Error(i(476));var m=S0(n).queue;_0(n,m,a,K,l===null?Tw:function(){return x0(n),l(d)})}function S0(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:K},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:l},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function x0(n){var a=S0(n);a.next===null&&(a=n.alternate.memoizedState),Ao(n,a.next.queue,{},Oi())}function Fd(){return Ge(Uo)}function w0(){return Se().memoizedState}function C0(){return Se().memoizedState}function Ew(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var l=Oi();n=wn(l);var d=Cn(a,n,l);d!==null&&(fi(d,a,l),_o(d,a,l)),a={cache:dd()},n.payload=a;return}a=a.return}}function Dw(n,a,l){var d=Oi();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},vc(n)?T0(a,l):(l=ed(n,a,l,d),l!==null&&(fi(l,n,d),E0(l,a,d)))}function A0(n,a,l){var d=Oi();Ao(n,a,l,d)}function Ao(n,a,l,d){var m={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(vc(n))T0(a,m);else{var y=n.alternate;if(n.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var x=a.lastRenderedState,A=y(x,l);if(m.hasEagerState=!0,m.eagerState=A,Ci(A,x))return Zl(n,a,m,0),ne===null&&Ql(),!1}catch{}finally{}if(l=ed(n,a,m,d),l!==null)return fi(l,n,d),E0(l,a,d),!0}return!1}function jd(n,a,l,d){if(d={lane:2,revertLane:yf(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},vc(n)){if(a)throw Error(i(479))}else a=ed(n,l,d,2),a!==null&&fi(a,n,2)}function vc(n){var a=n.alternate;return n===Lt||a!==null&&a===Lt}function T0(n,a){sa=uc=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function E0(n,a,l){if((l&4194048)!==0){var d=a.lanes;d&=n.pendingLanes,l|=d,a.lanes=l,Rp(n,l)}}var To={readContext:Ge,use:gc,useCallback:ve,useContext:ve,useEffect:ve,useImperativeHandle:ve,useLayoutEffect:ve,useInsertionEffect:ve,useMemo:ve,useReducer:ve,useRef:ve,useState:ve,useDebugValue:ve,useDeferredValue:ve,useTransition:ve,useSyncExternalStore:ve,useId:ve,useHostTransitionStatus:ve,useFormState:ve,useActionState:ve,useOptimistic:ve,useMemoCache:ve,useCacheRefresh:ve};To.useEffectEvent=ve;var D0={readContext:Ge,use:gc,useCallback:function(n,a){return ei().memoizedState=[n,a===void 0?null:a],n},useContext:Ge,useEffect:u0,useImperativeHandle:function(n,a,l){l=l!=null?l.concat([n]):null,mc(4194308,4,p0.bind(null,a,n),l)},useLayoutEffect:function(n,a){return mc(4194308,4,n,a)},useInsertionEffect:function(n,a){mc(4,2,n,a)},useMemo:function(n,a){var l=ei();a=a===void 0?null:a;var d=n();if(hr){pn(!0);try{n()}finally{pn(!1)}}return l.memoizedState=[d,a],d},useReducer:function(n,a,l){var d=ei();if(l!==void 0){var m=l(a);if(hr){pn(!0);try{l(a)}finally{pn(!1)}}}else m=a;return d.memoizedState=d.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},d.queue=n,n=n.dispatch=Dw.bind(null,Lt,n),[d.memoizedState,n]},useRef:function(n){var a=ei();return n={current:n},a.memoizedState=n},useState:function(n){n=kd(n);var a=n.queue,l=A0.bind(null,Lt,a);return a.dispatch=l,[n.memoizedState,l]},useDebugValue:Pd,useDeferredValue:function(n,a){var l=ei();return Bd(l,n,a)},useTransition:function(){var n=kd(!1);return n=_0.bind(null,Lt,n.queue,!0,!1),ei().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,l){var d=Lt,m=ei();if(Gt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),ne===null)throw Error(i(349));(It&127)!==0||Km(d,a,l)}m.memoizedState=l;var y={value:l,getSnapshot:a};return m.queue=y,u0(Qm.bind(null,d,y,n),[n]),d.flags|=2048,ra(9,{destroy:void 0},$m.bind(null,d,y,l,a),null),l},useId:function(){var n=ei(),a=ne.identifierPrefix;if(Gt){var l=ms,d=ps;l=(d&~(1<<32-wi(d)-1)).toString(32)+l,a="_"+a+"R_"+l,l=dc++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=Sw++,a="_"+a+"r_"+l.toString(32)+"_";return n.memoizedState=a},useHostTransitionStatus:Fd,useFormState:a0,useActionState:a0,useOptimistic:function(n){var a=ei();a.memoizedState=a.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=jd.bind(null,Lt,!0,l),l.dispatch=a,[n,a]},useMemoCache:Dd,useCacheRefresh:function(){return ei().memoizedState=Ew.bind(null,Lt)},useEffectEvent:function(n){var a=ei(),l={impl:n};return a.memoizedState=l,function(){if((Kt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},zd={readContext:Ge,use:gc,useCallback:y0,useContext:Ge,useEffect:Ld,useImperativeHandle:m0,useInsertionEffect:f0,useLayoutEffect:g0,useMemo:v0,useReducer:pc,useRef:h0,useState:function(){return pc(Us)},useDebugValue:Pd,useDeferredValue:function(n,a){var l=Se();return b0(l,te.memoizedState,n,a)},useTransition:function(){var n=pc(Us)[0],a=Se().memoizedState;return[typeof n=="boolean"?n:Co(n),a]},useSyncExternalStore:Wm,useId:w0,useHostTransitionStatus:Fd,useFormState:o0,useActionState:o0,useOptimistic:function(n,a){var l=Se();return t0(l,te,n,a)},useMemoCache:Dd,useCacheRefresh:C0};zd.useEffectEvent=d0;var M0={readContext:Ge,use:gc,useCallback:y0,useContext:Ge,useEffect:Ld,useImperativeHandle:m0,useInsertionEffect:f0,useLayoutEffect:g0,useMemo:v0,useReducer:Od,useRef:h0,useState:function(){return Od(Us)},useDebugValue:Pd,useDeferredValue:function(n,a){var l=Se();return te===null?Bd(l,n,a):b0(l,te.memoizedState,n,a)},useTransition:function(){var n=Od(Us)[0],a=Se().memoizedState;return[typeof n=="boolean"?n:Co(n),a]},useSyncExternalStore:Wm,useId:w0,useHostTransitionStatus:Fd,useFormState:c0,useActionState:c0,useOptimistic:function(n,a){var l=Se();return te!==null?t0(l,te,n,a):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Dd,useCacheRefresh:C0};M0.useEffectEvent=d0;function Id(n,a,l,d){a=n.memoizedState,l=l(d,a),l=l==null?a:p({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Hd={enqueueSetState:function(n,a,l){n=n._reactInternals;var d=Oi(),m=wn(d);m.payload=a,l!=null&&(m.callback=l),a=Cn(n,m,d),a!==null&&(fi(a,n,d),_o(a,n,d))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var d=Oi(),m=wn(d);m.tag=1,m.payload=a,l!=null&&(m.callback=l),a=Cn(n,m,d),a!==null&&(fi(a,n,d),_o(a,n,d))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=Oi(),d=wn(l);d.tag=2,a!=null&&(d.callback=a),a=Cn(n,d,l),a!==null&&(fi(a,n,l),_o(a,n,l))}};function O0(n,a,l,d,m,y,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,y,x):a.prototype&&a.prototype.isPureReactComponent?!uo(l,d)||!uo(m,y):!0}function k0(n,a,l,d){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,d),a.state!==n&&Hd.enqueueReplaceState(a,a.state,null)}function ur(n,a){var l=a;if("ref"in a){l={};for(var d in a)d!=="ref"&&(l[d]=a[d])}if(n=n.defaultProps){l===a&&(l=p({},l));for(var m in n)l[m]===void 0&&(l[m]=n[m])}return l}function R0(n){$l(n)}function L0(n){console.error(n)}function P0(n){$l(n)}function bc(n,a){try{var l=n.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function B0(n,a,l){try{var d=n.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Ud(n,a,l){return l=wn(l),l.tag=3,l.payload={element:null},l.callback=function(){bc(n,a)},l}function N0(n){return n=wn(n),n.tag=3,n}function F0(n,a,l,d){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=d.value;n.payload=function(){return m(y)},n.callback=function(){B0(a,l,d)}}var x=l.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){B0(a,l,d),typeof m!="function"&&(On===null?On=new Set([this]):On.add(this));var A=d.stack;this.componentDidCatch(d.value,{componentStack:A!==null?A:""})})}function Mw(n,a,l,d,m){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=l.alternate,a!==null&&Qr(a,l,m,!0),l=Ti.current,l!==null){switch(l.tag){case 31:case 13:return Gi===null?kc():l.alternate===null&&be===0&&(be=3),l.flags&=-257,l.flags|=65536,l.lanes=m,d===ac?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([d]):a.add(d),gf(n,d,m)),!1;case 22:return l.flags|=65536,d===ac?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([d]):l.add(d)),gf(n,d,m)),!1}throw Error(i(435,l.tag))}return gf(n,d,m),kc(),!1}if(Gt)return a=Ti.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,d!==od&&(n=Error(i(422),{cause:d}),po(zi(n,l)))):(d!==od&&(a=Error(i(423),{cause:d}),po(zi(a,l))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,d=zi(d,l),m=Ud(n.stateNode,d,m),vd(n,m),be!==4&&(be=2)),!1;var y=Error(i(520),{cause:d});if(y=zi(y,l),Po===null?Po=[y]:Po.push(y),be!==4&&(be=2),a===null)return!0;d=zi(d,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,n=m&-m,l.lanes|=n,n=Ud(l.stateNode,d,n),vd(l,n),!1;case 1:if(a=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(On===null||!On.has(y))))return l.flags|=65536,m&=-m,l.lanes|=m,m=N0(m),F0(m,n,l,d),vd(l,m),!1}l=l.return}while(l!==null);return!1}var Gd=Error(i(461)),De=!1;function Ve(n,a,l,d){a.child=n===null?Hm(a,null,l,d):cr(a,n.child,l,d)}function j0(n,a,l,d,m){l=l.render;var y=a.ref;if("ref"in d){var x={};for(var A in d)A!=="ref"&&(x[A]=d[A])}else x=d;return rr(a),d=Cd(n,a,l,x,y,m),A=Ad(),n!==null&&!De?(Td(n,a,m),Gs(n,a,m)):(Gt&&A&&rd(a),a.flags|=1,Ve(n,a,d,m),a.child)}function z0(n,a,l,d,m){if(n===null){var y=l.type;return typeof y=="function"&&!id(y)&&y.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=y,I0(n,a,y,d,m)):(n=tc(l.type,null,d,a,a.mode,m),n.ref=a.ref,n.return=a,a.child=n)}if(y=n.child,!Qd(n,m)){var x=y.memoizedProps;if(l=l.compare,l=l!==null?l:uo,l(x,d)&&n.ref===a.ref)return Gs(n,a,m)}return a.flags|=1,n=Fs(y,d),n.ref=a.ref,n.return=a,a.child=n}function I0(n,a,l,d,m){if(n!==null){var y=n.memoizedProps;if(uo(y,d)&&n.ref===a.ref)if(De=!1,a.pendingProps=d=y,Qd(n,m))(n.flags&131072)!==0&&(De=!0);else return a.lanes=n.lanes,Gs(n,a,m)}return Vd(n,a,l,d,m)}function H0(n,a,l,d){var m=d.children,y=n!==null?n.memoizedState:null;if(n===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((a.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,n!==null){for(d=a.child=n.child,m=0;d!==null;)m=m|d.lanes|d.childLanes,d=d.sibling;d=m&~y}else d=0,a.child=null;return U0(n,a,y,l,d)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&nc(a,y!==null?y.cachePool:null),y!==null?Vm(a,y):_d(),Xm(a);else return d=a.lanes=536870912,U0(n,a,y!==null?y.baseLanes|l:l,l,d)}else y!==null?(nc(a,y.cachePool),Vm(a,y),Tn(),a.memoizedState=null):(n!==null&&nc(a,null),_d(),Tn());return Ve(n,a,m,l),a.child}function Eo(n,a){return n!==null&&n.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function U0(n,a,l,d,m){var y=gd();return y=y===null?null:{parent:Te._currentValue,pool:y},a.memoizedState={baseLanes:l,cachePool:y},n!==null&&nc(a,null),_d(),Xm(a),n!==null&&Qr(n,a,d,!0),a.childLanes=m,null}function _c(n,a){return a=xc({mode:a.mode,children:a.children},n.mode),a.ref=n.ref,n.child=a,a.return=n,a}function G0(n,a,l){return cr(a,n.child,null,l),n=_c(a,a.pendingProps),n.flags|=2,Ei(a),a.memoizedState=null,n}function Ow(n,a,l){var d=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,n===null){if(Gt){if(d.mode==="hidden")return n=_c(a,d),a.lanes=536870912,Eo(null,n);if(xd(a),(n=le)?(n=ev(n,Ui),n=n!==null&&n.data==="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:vn!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},l=Tm(n),l.return=a,a.child=l,Ue=a,le=null)):n=null,n===null)throw _n(a);return a.lanes=536870912,null}return _c(a,d)}var y=n.memoizedState;if(y!==null){var x=y.dehydrated;if(xd(a),m)if(a.flags&256)a.flags&=-257,a=G0(n,a,l);else if(a.memoizedState!==null)a.child=n.child,a.flags|=128,a=null;else throw Error(i(558));else if(De||Qr(n,a,l,!1),m=(l&n.childLanes)!==0,De||m){if(d=ne,d!==null&&(x=Lp(d,l),x!==0&&x!==y.retryLane))throw y.retryLane=x,er(n,x),fi(d,n,x),Gd;kc(),a=G0(n,a,l)}else n=y.treeContext,le=Vi(x.nextSibling),Ue=a,Gt=!0,bn=null,Ui=!1,n!==null&&Mm(a,n),a=_c(a,d),a.flags|=4096;return a}return n=Fs(n.child,{mode:d.mode,children:d.children}),n.ref=a.ref,a.child=n,n.return=a,n}function Sc(n,a){var l=a.ref;if(l===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(n===null||n.ref!==l)&&(a.flags|=4194816)}}function Vd(n,a,l,d,m){return rr(a),l=Cd(n,a,l,d,void 0,m),d=Ad(),n!==null&&!De?(Td(n,a,m),Gs(n,a,m)):(Gt&&d&&rd(a),a.flags|=1,Ve(n,a,l,m),a.child)}function V0(n,a,l,d,m,y){return rr(a),a.updateQueue=null,l=qm(a,d,l,m),Ym(n),d=Ad(),n!==null&&!De?(Td(n,a,y),Gs(n,a,y)):(Gt&&d&&rd(a),a.flags|=1,Ve(n,a,l,y),a.child)}function X0(n,a,l,d,m){if(rr(a),a.stateNode===null){var y=qr,x=l.contextType;typeof x=="object"&&x!==null&&(y=Ge(x)),y=new l(d,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Hd,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=d,y.state=a.memoizedState,y.refs={},md(a),x=l.contextType,y.context=typeof x=="object"&&x!==null?Ge(x):qr,y.state=a.memoizedState,x=l.getDerivedStateFromProps,typeof x=="function"&&(Id(a,l,x,d),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(x=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),x!==y.state&&Hd.enqueueReplaceState(y,y.state,null),xo(a,d,y,m),So(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(n===null){y=a.stateNode;var A=a.memoizedProps,k=ur(l,A);y.props=k;var U=y.context,W=l.contextType;x=qr,typeof W=="object"&&W!==null&&(x=Ge(W));var Z=l.getDerivedStateFromProps;W=typeof Z=="function"||typeof y.getSnapshotBeforeUpdate=="function",A=a.pendingProps!==A,W||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(A||U!==x)&&k0(a,y,d,x),xn=!1;var V=a.memoizedState;y.state=V,xo(a,d,y,m),So(),U=a.memoizedState,A||V!==U||xn?(typeof Z=="function"&&(Id(a,l,Z,d),U=a.memoizedState),(k=xn||O0(a,l,k,d,V,U,x))?(W||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=U),y.props=d,y.state=U,y.context=x,d=k):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{y=a.stateNode,yd(n,a),x=a.memoizedProps,W=ur(l,x),y.props=W,Z=a.pendingProps,V=y.context,U=l.contextType,k=qr,typeof U=="object"&&U!==null&&(k=Ge(U)),A=l.getDerivedStateFromProps,(U=typeof A=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x!==Z||V!==k)&&k0(a,y,d,k),xn=!1,V=a.memoizedState,y.state=V,xo(a,d,y,m),So();var q=a.memoizedState;x!==Z||V!==q||xn||n!==null&&n.dependencies!==null&&ic(n.dependencies)?(typeof A=="function"&&(Id(a,l,A,d),q=a.memoizedState),(W=xn||O0(a,l,W,d,V,q,k)||n!==null&&n.dependencies!==null&&ic(n.dependencies))?(U||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,q,k),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,q,k)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||x===n.memoizedProps&&V===n.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&V===n.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=q),y.props=d,y.state=q,y.context=k,d=W):(typeof y.componentDidUpdate!="function"||x===n.memoizedProps&&V===n.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&V===n.memoizedState||(a.flags|=1024),d=!1)}return y=d,Sc(n,a),d=(a.flags&128)!==0,y||d?(y=a.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,n!==null&&d?(a.child=cr(a,n.child,null,m),a.child=cr(a,null,l,m)):Ve(n,a,l,m),a.memoizedState=y.state,n=a.child):n=Gs(n,a,m),n}function Y0(n,a,l,d){return sr(),a.flags|=256,Ve(n,a,l,d),a.child}var Xd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yd(n){return{baseLanes:n,cachePool:Bm()}}function qd(n,a,l){return n=n!==null?n.childLanes&~l:0,a&&(n|=Mi),n}function q0(n,a,l){var d=a.pendingProps,m=!1,y=(a.flags&128)!==0,x;if((x=y)||(x=n!==null&&n.memoizedState===null?!1:(_e.current&2)!==0),x&&(m=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,n===null){if(Gt){if(m?An(a):Tn(),(n=le)?(n=ev(n,Ui),n=n!==null&&n.data!=="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:vn!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},l=Tm(n),l.return=a,a.child=l,Ue=a,le=null)):n=null,n===null)throw _n(a);return Of(n)?a.lanes=32:a.lanes=536870912,null}var A=d.children;return d=d.fallback,m?(Tn(),m=a.mode,A=xc({mode:"hidden",children:A},m),d=ir(d,m,l,null),A.return=a,d.return=a,A.sibling=d,a.child=A,d=a.child,d.memoizedState=Yd(l),d.childLanes=qd(n,x,l),a.memoizedState=Xd,Eo(null,d)):(An(a),Wd(a,A))}var k=n.memoizedState;if(k!==null&&(A=k.dehydrated,A!==null)){if(y)a.flags&256?(An(a),a.flags&=-257,a=Kd(n,a,l)):a.memoizedState!==null?(Tn(),a.child=n.child,a.flags|=128,a=null):(Tn(),A=d.fallback,m=a.mode,d=xc({mode:"visible",children:d.children},m),A=ir(A,m,l,null),A.flags|=2,d.return=a,A.return=a,d.sibling=A,a.child=d,cr(a,n.child,null,l),d=a.child,d.memoizedState=Yd(l),d.childLanes=qd(n,x,l),a.memoizedState=Xd,a=Eo(null,d));else if(An(a),Of(A)){if(x=A.nextSibling&&A.nextSibling.dataset,x)var U=x.dgst;x=U,d=Error(i(419)),d.stack="",d.digest=x,po({value:d,source:null,stack:null}),a=Kd(n,a,l)}else if(De||Qr(n,a,l,!1),x=(l&n.childLanes)!==0,De||x){if(x=ne,x!==null&&(d=Lp(x,l),d!==0&&d!==k.retryLane))throw k.retryLane=d,er(n,d),fi(x,n,d),Gd;Mf(A)||kc(),a=Kd(n,a,l)}else Mf(A)?(a.flags|=192,a.child=n.child,a=null):(n=k.treeContext,le=Vi(A.nextSibling),Ue=a,Gt=!0,bn=null,Ui=!1,n!==null&&Mm(a,n),a=Wd(a,d.children),a.flags|=4096);return a}return m?(Tn(),A=d.fallback,m=a.mode,k=n.child,U=k.sibling,d=Fs(k,{mode:"hidden",children:d.children}),d.subtreeFlags=k.subtreeFlags&65011712,U!==null?A=Fs(U,A):(A=ir(A,m,l,null),A.flags|=2),A.return=a,d.return=a,d.sibling=A,a.child=d,Eo(null,d),d=a.child,A=n.child.memoizedState,A===null?A=Yd(l):(m=A.cachePool,m!==null?(k=Te._currentValue,m=m.parent!==k?{parent:k,pool:k}:m):m=Bm(),A={baseLanes:A.baseLanes|l,cachePool:m}),d.memoizedState=A,d.childLanes=qd(n,x,l),a.memoizedState=Xd,Eo(n.child,d)):(An(a),l=n.child,n=l.sibling,l=Fs(l,{mode:"visible",children:d.children}),l.return=a,l.sibling=null,n!==null&&(x=a.deletions,x===null?(a.deletions=[n],a.flags|=16):x.push(n)),a.child=l,a.memoizedState=null,l)}function Wd(n,a){return a=xc({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function xc(n,a){return n=Ai(22,n,null,a),n.lanes=0,n}function Kd(n,a,l){return cr(a,n.child,null,l),n=Wd(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function W0(n,a,l){n.lanes|=a;var d=n.alternate;d!==null&&(d.lanes|=a),hd(n.return,a,l)}function $d(n,a,l,d,m,y){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:m,treeForkCount:y}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=d,x.tail=l,x.tailMode=m,x.treeForkCount=y)}function K0(n,a,l){var d=a.pendingProps,m=d.revealOrder,y=d.tail;d=d.children;var x=_e.current,A=(x&2)!==0;if(A?(x=x&1|2,a.flags|=128):x&=1,et(_e,x),Ve(n,a,d,l),d=Gt?go:0,!A&&n!==null&&(n.flags&128)!==0)t:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&W0(n,l,a);else if(n.tag===19)W0(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break t;for(;n.sibling===null;){if(n.return===null||n.return===a)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(l=a.child,m=null;l!==null;)n=l.alternate,n!==null&&hc(n)===null&&(m=l),l=l.sibling;l=m,l===null?(m=a.child,a.child=null):(m=l.sibling,l.sibling=null),$d(a,!1,m,l,y,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=a.child,a.child=null;m!==null;){if(n=m.alternate,n!==null&&hc(n)===null){a.child=m;break}n=m.sibling,m.sibling=l,l=m,m=n}$d(a,!0,l,null,y,d);break;case"together":$d(a,!1,null,null,void 0,d);break;default:a.memoizedState=null}return a.child}function Gs(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),Mn|=a.lanes,(l&a.childLanes)===0)if(n!==null){if(Qr(n,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(i(153));if(a.child!==null){for(n=a.child,l=Fs(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=Fs(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function Qd(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&ic(n)))}function kw(n,a,l){switch(a.tag){case 3:Wt(a,a.stateNode.containerInfo),Sn(a,Te,n.memoizedState.cache),sr();break;case 27:case 5:Pt(a);break;case 4:Wt(a,a.stateNode.containerInfo);break;case 10:Sn(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,xd(a),null;break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(An(a),a.flags|=128,null):(l&a.child.childLanes)!==0?q0(n,a,l):(An(a),n=Gs(n,a,l),n!==null?n.sibling:null);An(a);break;case 19:var m=(n.flags&128)!==0;if(d=(l&a.childLanes)!==0,d||(Qr(n,a,l,!1),d=(l&a.childLanes)!==0),m){if(d)return K0(n,a,l);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),et(_e,_e.current),d)break;return null;case 22:return a.lanes=0,H0(n,a,l,a.pendingProps);case 24:Sn(a,Te,n.memoizedState.cache)}return Gs(n,a,l)}function $0(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps)De=!0;else{if(!Qd(n,l)&&(a.flags&128)===0)return De=!1,kw(n,a,l);De=(n.flags&131072)!==0}else De=!1,Gt&&(a.flags&1048576)!==0&&Dm(a,go,a.index);switch(a.lanes=0,a.tag){case 16:t:{var d=a.pendingProps;if(n=or(a.elementType),a.type=n,typeof n=="function")id(n)?(d=ur(n,d),a.tag=1,a=X0(null,a,n,d,l)):(a.tag=0,a=Vd(null,a,n,d,l));else{if(n!=null){var m=n.$$typeof;if(m===D){a.tag=11,a=j0(null,a,n,d,l);break t}else if(m===R){a.tag=14,a=z0(null,a,n,d,l);break t}}throw a=it(n)||n,Error(i(306,a,""))}}return a;case 0:return Vd(n,a,a.type,a.pendingProps,l);case 1:return d=a.type,m=ur(d,a.pendingProps),X0(n,a,d,m,l);case 3:t:{if(Wt(a,a.stateNode.containerInfo),n===null)throw Error(i(387));d=a.pendingProps;var y=a.memoizedState;m=y.element,yd(n,a),xo(a,d,null,l);var x=a.memoizedState;if(d=x.cache,Sn(a,Te,d),d!==y.cache&&ud(a,[Te],l,!0),So(),d=x.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=Y0(n,a,d,l);break t}else if(d!==m){m=zi(Error(i(424)),a),po(m),a=Y0(n,a,d,l);break t}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(le=Vi(n.firstChild),Ue=a,Gt=!0,bn=null,Ui=!0,l=Hm(a,null,d,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(sr(),d===m){a=Gs(n,a,l);break t}Ve(n,a,d,l)}a=a.child}return a;case 26:return Sc(n,a),n===null?(l=ov(a.type,null,a.pendingProps,null))?a.memoizedState=l:Gt||(l=a.type,n=a.pendingProps,d=jc(gt.current).createElement(l),d[He]=a,d[oi]=n,Xe(d,l,n),Ne(d),a.stateNode=d):a.memoizedState=ov(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return Pt(a),n===null&&Gt&&(d=a.stateNode=nv(a.type,a.pendingProps,gt.current),Ue=a,Ui=!0,m=le,Pn(a.type)?(kf=m,le=Vi(d.firstChild)):le=m),Ve(n,a,a.pendingProps.children,l),Sc(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&Gt&&((m=d=le)&&(d=o1(d,a.type,a.pendingProps,Ui),d!==null?(a.stateNode=d,Ue=a,le=Vi(d.firstChild),Ui=!1,m=!0):m=!1),m||_n(a)),Pt(a),m=a.type,y=a.pendingProps,x=n!==null?n.memoizedProps:null,d=y.children,Tf(m,y)?d=null:x!==null&&Tf(m,x)&&(a.flags|=32),a.memoizedState!==null&&(m=Cd(n,a,xw,null,null,l),Uo._currentValue=m),Sc(n,a),Ve(n,a,d,l),a.child;case 6:return n===null&&Gt&&((n=l=le)&&(l=l1(l,a.pendingProps,Ui),l!==null?(a.stateNode=l,Ue=a,le=null,n=!0):n=!1),n||_n(a)),null;case 13:return q0(n,a,l);case 4:return Wt(a,a.stateNode.containerInfo),d=a.pendingProps,n===null?a.child=cr(a,null,d,l):Ve(n,a,d,l),a.child;case 11:return j0(n,a,a.type,a.pendingProps,l);case 7:return Ve(n,a,a.pendingProps,l),a.child;case 8:return Ve(n,a,a.pendingProps.children,l),a.child;case 12:return Ve(n,a,a.pendingProps.children,l),a.child;case 10:return d=a.pendingProps,Sn(a,a.type,d.value),Ve(n,a,d.children,l),a.child;case 9:return m=a.type._context,d=a.pendingProps.children,rr(a),m=Ge(m),d=d(m),a.flags|=1,Ve(n,a,d,l),a.child;case 14:return z0(n,a,a.type,a.pendingProps,l);case 15:return I0(n,a,a.type,a.pendingProps,l);case 19:return K0(n,a,l);case 31:return Ow(n,a,l);case 22:return H0(n,a,l,a.pendingProps);case 24:return rr(a),d=Ge(Te),n===null?(m=gd(),m===null&&(m=ne,y=dd(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=l),m=y),a.memoizedState={parent:d,cache:m},md(a),Sn(a,Te,m)):((n.lanes&l)!==0&&(yd(n,a),xo(a,null,null,l),So()),m=n.memoizedState,y=a.memoizedState,m.parent!==d?(m={parent:d,cache:d},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Sn(a,Te,d)):(d=y.cache,Sn(a,Te,d),d!==m.cache&&ud(a,[Te],l,!0))),Ve(n,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Vs(n){n.flags|=4}function Zd(n,a,l,d,m){if((a=(n.mode&32)!==0)&&(a=!1),a){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(wy())n.flags|=8192;else throw lr=ac,pd}else n.flags&=-16777217}function Q0(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!dv(a))if(wy())n.flags|=8192;else throw lr=ac,pd}function wc(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?Op():536870912,n.lanes|=a,ca|=a)}function Do(n,a){if(!Gt)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function ce(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(a)for(var m=n.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags&65011712,d|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=d,n.childLanes=l,a}function Rw(n,a,l){var d=a.pendingProps;switch(ad(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ce(a),null;case 1:return ce(a),null;case 3:return l=a.stateNode,d=null,n!==null&&(d=n.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Is(Te),Mt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&($r(a)?Vs(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,ld())),ce(a),null;case 26:var m=a.type,y=a.memoizedState;return n===null?(Vs(a),y!==null?(ce(a),Q0(a,y)):(ce(a),Zd(a,m,null,d,l))):y?y!==n.memoizedState?(Vs(a),ce(a),Q0(a,y)):(ce(a),a.flags&=-16777217):(n=n.memoizedProps,n!==d&&Vs(a),ce(a),Zd(a,m,n,d,l)),null;case 27:if(yt(a),l=gt.current,m=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==d&&Vs(a);else{if(!d){if(a.stateNode===null)throw Error(i(166));return ce(a),null}n=nt.current,$r(a)?Om(a):(n=nv(m,d,l),a.stateNode=n,Vs(a))}return ce(a),null;case 5:if(yt(a),m=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==d&&Vs(a);else{if(!d){if(a.stateNode===null)throw Error(i(166));return ce(a),null}if(y=nt.current,$r(a))Om(a);else{var x=jc(gt.current);switch(y){case 1:y=x.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=x.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=x.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?x.createElement("select",{is:d.is}):x.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?x.createElement(m,{is:d.is}):x.createElement(m)}}y[He]=a,y[oi]=d;t:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)y.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break t;for(;x.sibling===null;){if(x.return===null||x.return===a)break t;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=y;t:switch(Xe(y,m,d),m){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}d&&Vs(a)}}return ce(a),Zd(a,a.type,n===null?null:n.memoizedProps,a.pendingProps,l),null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==d&&Vs(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(i(166));if(n=gt.current,$r(a)){if(n=a.stateNode,l=a.memoizedProps,d=null,m=Ue,m!==null)switch(m.tag){case 27:case 5:d=m.memoizedProps}n[He]=a,n=!!(n.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||qy(n.nodeValue,l)),n||_n(a,!0)}else n=jc(n).createTextNode(d),n[He]=a,a.stateNode=n}return ce(a),null;case 31:if(l=a.memoizedState,n===null||n.memoizedState!==null){if(d=$r(a),l!==null){if(n===null){if(!d)throw Error(i(318));if(n=a.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[He]=a}else sr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ce(a),n=!1}else l=ld(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return a.flags&256?(Ei(a),a):(Ei(a),null);if((a.flags&128)!==0)throw Error(i(558))}return ce(a),null;case 13:if(d=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=$r(a),d!==null&&d.dehydrated!==null){if(n===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[He]=a}else sr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ce(a),m=!1}else m=ld(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Ei(a),a):(Ei(a),null)}return Ei(a),(a.flags&128)!==0?(a.lanes=l,a):(l=d!==null,n=n!==null&&n.memoizedState!==null,l&&(d=a.child,m=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(m=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==m&&(d.flags|=2048)),l!==n&&l&&(a.child.flags|=8192),wc(a,a.updateQueue),ce(a),null);case 4:return Mt(),n===null&&Sf(a.stateNode.containerInfo),ce(a),null;case 10:return Is(a.type),ce(a),null;case 19:if(Y(_e),d=a.memoizedState,d===null)return ce(a),null;if(m=(a.flags&128)!==0,y=d.rendering,y===null)if(m)Do(d,!1);else{if(be!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(y=hc(n),y!==null){for(a.flags|=128,Do(d,!1),n=y.updateQueue,a.updateQueue=n,wc(a,n),a.subtreeFlags=0,n=l,l=a.child;l!==null;)Am(l,n),l=l.sibling;return et(_e,_e.current&1|2),Gt&&js(a,d.treeForkCount),a.child}n=n.sibling}d.tail!==null&&ti()>Dc&&(a.flags|=128,m=!0,Do(d,!1),a.lanes=4194304)}else{if(!m)if(n=hc(y),n!==null){if(a.flags|=128,m=!0,n=n.updateQueue,a.updateQueue=n,wc(a,n),Do(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!Gt)return ce(a),null}else 2*ti()-d.renderingStartTime>Dc&&l!==536870912&&(a.flags|=128,m=!0,Do(d,!1),a.lanes=4194304);d.isBackwards?(y.sibling=a.child,a.child=y):(n=d.last,n!==null?n.sibling=y:a.child=y,d.last=y)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=ti(),n.sibling=null,l=_e.current,et(_e,m?l&1|2:l&1),Gt&&js(a,d.treeForkCount),n):(ce(a),null);case 22:case 23:return Ei(a),Sd(),d=a.memoizedState!==null,n!==null?n.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(l&536870912)!==0&&(a.flags&128)===0&&(ce(a),a.subtreeFlags&6&&(a.flags|=8192)):ce(a),l=a.updateQueue,l!==null&&wc(a,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==l&&(a.flags|=2048),n!==null&&Y(ar),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Is(Te),ce(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Lw(n,a){switch(ad(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return Is(Te),Mt(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return yt(a),null;case 31:if(a.memoizedState!==null){if(Ei(a),a.alternate===null)throw Error(i(340));sr()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 13:if(Ei(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(i(340));sr()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return Y(_e),null;case 4:return Mt(),null;case 10:return Is(a.type),null;case 22:case 23:return Ei(a),Sd(),n!==null&&Y(ar),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return Is(Te),null;case 25:return null;default:return null}}function Z0(n,a){switch(ad(a),a.tag){case 3:Is(Te),Mt();break;case 26:case 27:case 5:yt(a);break;case 4:Mt();break;case 31:a.memoizedState!==null&&Ei(a);break;case 13:Ei(a);break;case 19:Y(_e);break;case 10:Is(a.type);break;case 22:case 23:Ei(a),Sd(),n!==null&&Y(ar);break;case 24:Is(Te)}}function Mo(n,a){try{var l=a.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var m=d.next;l=m;do{if((l.tag&n)===n){d=void 0;var y=l.create,x=l.inst;d=y(),x.destroy=d}l=l.next}while(l!==m)}}catch(A){Jt(a,a.return,A)}}function En(n,a,l){try{var d=a.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var y=m.next;d=y;do{if((d.tag&n)===n){var x=d.inst,A=x.destroy;if(A!==void 0){x.destroy=void 0,m=a;var k=l,U=A;try{U()}catch(W){Jt(m,k,W)}}}d=d.next}while(d!==y)}}catch(W){Jt(a,a.return,W)}}function J0(n){var a=n.updateQueue;if(a!==null){var l=n.stateNode;try{Gm(a,l)}catch(d){Jt(n,n.return,d)}}}function ty(n,a,l){l.props=ur(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(d){Jt(n,a,d)}}function Oo(n,a){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var d=n.stateNode;break;case 30:d=n.stateNode;break;default:d=n.stateNode}typeof l=="function"?n.refCleanup=l(d):l.current=d}}catch(m){Jt(n,a,m)}}function ys(n,a){var l=n.ref,d=n.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(m){Jt(n,a,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Jt(n,a,m)}else l.current=null}function ey(n){var a=n.type,l=n.memoizedProps,d=n.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break t;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(m){Jt(n,n.return,m)}}function Jd(n,a,l){try{var d=n.stateNode;e1(d,n.type,l,a),d[oi]=a}catch(m){Jt(n,n.return,m)}}function iy(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Pn(n.type)||n.tag===4}function tf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||iy(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Pn(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ef(n,a,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(n),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Bs));else if(d!==4&&(d===27&&Pn(n.type)&&(l=n.stateNode,a=null),n=n.child,n!==null))for(ef(n,a,l),n=n.sibling;n!==null;)ef(n,a,l),n=n.sibling}function Cc(n,a,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(d!==4&&(d===27&&Pn(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(Cc(n,a,l),n=n.sibling;n!==null;)Cc(n,a,l),n=n.sibling}function sy(n){var a=n.stateNode,l=n.memoizedProps;try{for(var d=n.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Xe(a,d,l),a[He]=n,a[oi]=l}catch(y){Jt(n,n.return,y)}}var Xs=!1,Me=!1,sf=!1,ny=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function Pw(n,a){if(n=n.containerInfo,Cf=Xc,n=mm(n),Ku(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else t:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var m=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break t}var x=0,A=-1,k=-1,U=0,W=0,Z=n,V=null;e:for(;;){for(var q;Z!==l||m!==0&&Z.nodeType!==3||(A=x+m),Z!==y||d!==0&&Z.nodeType!==3||(k=x+d),Z.nodeType===3&&(x+=Z.nodeValue.length),(q=Z.firstChild)!==null;)V=Z,Z=q;for(;;){if(Z===n)break e;if(V===l&&++U===m&&(A=x),V===y&&++W===d&&(k=x),(q=Z.nextSibling)!==null)break;Z=V,V=Z.parentNode}Z=q}l=A===-1||k===-1?null:{start:A,end:k}}else l=null}l=l||{start:0,end:0}}else l=null;for(Af={focusedElem:n,selectionRange:l},Xc=!1,Fe=a;Fe!==null;)if(a=Fe,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Fe=n;else for(;Fe!==null;){switch(a=Fe,y=a.alternate,n=a.flags,a.tag){case 0:if((n&4)!==0&&(n=a.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)m=n[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&y!==null){n=void 0,l=a,m=y.memoizedProps,y=y.memoizedState,d=l.stateNode;try{var mt=ur(l.type,m);n=d.getSnapshotBeforeUpdate(mt,y),d.__reactInternalSnapshotBeforeUpdate=n}catch(Ct){Jt(l,l.return,Ct)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,l=n.nodeType,l===9)Df(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Df(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=a.sibling,n!==null){n.return=a.return,Fe=n;break}Fe=a.return}}function ry(n,a,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:qs(n,l),d&4&&Mo(5,l);break;case 1:if(qs(n,l),d&4)if(n=l.stateNode,a===null)try{n.componentDidMount()}catch(x){Jt(l,l.return,x)}else{var m=ur(l.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(m,a,n.__reactInternalSnapshotBeforeUpdate)}catch(x){Jt(l,l.return,x)}}d&64&&J0(l),d&512&&Oo(l,l.return);break;case 3:if(qs(n,l),d&64&&(n=l.updateQueue,n!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Gm(n,a)}catch(x){Jt(l,l.return,x)}}break;case 27:a===null&&d&4&&sy(l);case 26:case 5:qs(n,l),a===null&&d&4&&ey(l),d&512&&Oo(l,l.return);break;case 12:qs(n,l);break;case 31:qs(n,l),d&4&&ly(n,l);break;case 13:qs(n,l),d&4&&cy(n,l),d&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=Gw.bind(null,l),c1(n,l))));break;case 22:if(d=l.memoizedState!==null||Xs,!d){a=a!==null&&a.memoizedState!==null||Me,m=Xs;var y=Me;Xs=d,(Me=a)&&!y?Ws(n,l,(l.subtreeFlags&8772)!==0):qs(n,l),Xs=m,Me=y}break;case 30:break;default:qs(n,l)}}function ay(n){var a=n.alternate;a!==null&&(n.alternate=null,ay(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&Ru(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ue=null,ci=!1;function Ys(n,a,l){for(l=l.child;l!==null;)oy(n,a,l),l=l.sibling}function oy(n,a,l){if(xi&&typeof xi.onCommitFiberUnmount=="function")try{xi.onCommitFiberUnmount(Ja,l)}catch{}switch(l.tag){case 26:Me||ys(l,a),Ys(n,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Me||ys(l,a);var d=ue,m=ci;Pn(l.type)&&(ue=l.stateNode,ci=!1),Ys(n,a,l),zo(l.stateNode),ue=d,ci=m;break;case 5:Me||ys(l,a);case 6:if(d=ue,m=ci,ue=null,Ys(n,a,l),ue=d,ci=m,ue!==null)if(ci)try{(ue.nodeType===9?ue.body:ue.nodeName==="HTML"?ue.ownerDocument.body:ue).removeChild(l.stateNode)}catch(y){Jt(l,a,y)}else try{ue.removeChild(l.stateNode)}catch(y){Jt(l,a,y)}break;case 18:ue!==null&&(ci?(n=ue,Jy(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),ya(n)):Jy(ue,l.stateNode));break;case 4:d=ue,m=ci,ue=l.stateNode.containerInfo,ci=!0,Ys(n,a,l),ue=d,ci=m;break;case 0:case 11:case 14:case 15:En(2,l,a),Me||En(4,l,a),Ys(n,a,l);break;case 1:Me||(ys(l,a),d=l.stateNode,typeof d.componentWillUnmount=="function"&&ty(l,a,d)),Ys(n,a,l);break;case 21:Ys(n,a,l);break;case 22:Me=(d=Me)||l.memoizedState!==null,Ys(n,a,l),Me=d;break;default:Ys(n,a,l)}}function ly(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ya(n)}catch(l){Jt(a,a.return,l)}}}function cy(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ya(n)}catch(l){Jt(a,a.return,l)}}function Bw(n){switch(n.tag){case 31:case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new ny),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new ny),a;default:throw Error(i(435,n.tag))}}function Ac(n,a){var l=Bw(n);a.forEach(function(d){if(!l.has(d)){l.add(d);var m=Vw.bind(null,n,d);d.then(m,m)}})}function hi(n,a){var l=a.deletions;if(l!==null)for(var d=0;d<l.length;d++){var m=l[d],y=n,x=a,A=x;t:for(;A!==null;){switch(A.tag){case 27:if(Pn(A.type)){ue=A.stateNode,ci=!1;break t}break;case 5:ue=A.stateNode,ci=!1;break t;case 3:case 4:ue=A.stateNode.containerInfo,ci=!0;break t}A=A.return}if(ue===null)throw Error(i(160));oy(y,x,m),ue=null,ci=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)hy(a,n),a=a.sibling}var ss=null;function hy(n,a){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:hi(a,n),ui(n),d&4&&(En(3,n,n.return),Mo(3,n),En(5,n,n.return));break;case 1:hi(a,n),ui(n),d&512&&(Me||l===null||ys(l,l.return)),d&64&&Xs&&(n=n.updateQueue,n!==null&&(d=n.callbacks,d!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var m=ss;if(hi(a,n),ui(n),d&512&&(Me||l===null||ys(l,l.return)),d&4){var y=l!==null?l.memoizedState:null;if(d=n.memoizedState,l===null)if(d===null)if(n.stateNode===null){t:{d=n.type,l=n.memoizedProps,m=m.ownerDocument||m;e:switch(d){case"title":y=m.getElementsByTagName("title")[0],(!y||y[io]||y[He]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(d),m.head.insertBefore(y,m.querySelector("head > title"))),Xe(y,d,l),y[He]=n,Ne(y),d=y;break t;case"link":var x=hv("link","href",m).get(d+(l.href||""));if(x){for(var A=0;A<x.length;A++)if(y=x[A],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){x.splice(A,1);break e}}y=m.createElement(d),Xe(y,d,l),m.head.appendChild(y);break;case"meta":if(x=hv("meta","content",m).get(d+(l.content||""))){for(A=0;A<x.length;A++)if(y=x[A],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){x.splice(A,1);break e}}y=m.createElement(d),Xe(y,d,l),m.head.appendChild(y);break;default:throw Error(i(468,d))}y[He]=n,Ne(y),d=y}n.stateNode=d}else uv(m,n.type,n.stateNode);else n.stateNode=cv(m,d,n.memoizedProps);else y!==d?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,d===null?uv(m,n.type,n.stateNode):cv(m,d,n.memoizedProps)):d===null&&n.stateNode!==null&&Jd(n,n.memoizedProps,l.memoizedProps)}break;case 27:hi(a,n),ui(n),d&512&&(Me||l===null||ys(l,l.return)),l!==null&&d&4&&Jd(n,n.memoizedProps,l.memoizedProps);break;case 5:if(hi(a,n),ui(n),d&512&&(Me||l===null||ys(l,l.return)),n.flags&32){m=n.stateNode;try{Ir(m,"")}catch(mt){Jt(n,n.return,mt)}}d&4&&n.stateNode!=null&&(m=n.memoizedProps,Jd(n,m,l!==null?l.memoizedProps:m)),d&1024&&(sf=!0);break;case 6:if(hi(a,n),ui(n),d&4){if(n.stateNode===null)throw Error(i(162));d=n.memoizedProps,l=n.stateNode;try{l.nodeValue=d}catch(mt){Jt(n,n.return,mt)}}break;case 3:if(Hc=null,m=ss,ss=zc(a.containerInfo),hi(a,n),ss=m,ui(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{ya(a.containerInfo)}catch(mt){Jt(n,n.return,mt)}sf&&(sf=!1,uy(n));break;case 4:d=ss,ss=zc(n.stateNode.containerInfo),hi(a,n),ui(n),ss=d;break;case 12:hi(a,n),ui(n);break;case 31:hi(a,n),ui(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,Ac(n,d)));break;case 13:hi(a,n),ui(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Ec=ti()),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,Ac(n,d)));break;case 22:m=n.memoizedState!==null;var k=l!==null&&l.memoizedState!==null,U=Xs,W=Me;if(Xs=U||m,Me=W||k,hi(a,n),Me=W,Xs=U,ui(n),d&8192)t:for(a=n.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(l===null||k||Xs||Me||dr(n)),l=null,a=n;;){if(a.tag===5||a.tag===26){if(l===null){k=l=a;try{if(y=k.stateNode,m)x=y.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{A=k.stateNode;var Z=k.memoizedProps.style,V=Z!=null&&Z.hasOwnProperty("display")?Z.display:null;A.style.display=V==null||typeof V=="boolean"?"":(""+V).trim()}}catch(mt){Jt(k,k.return,mt)}}}else if(a.tag===6){if(l===null){k=a;try{k.stateNode.nodeValue=m?"":k.memoizedProps}catch(mt){Jt(k,k.return,mt)}}}else if(a.tag===18){if(l===null){k=a;try{var q=k.stateNode;m?tv(q,!0):tv(k.stateNode,!1)}catch(mt){Jt(k,k.return,mt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break t;for(;a.sibling===null;){if(a.return===null||a.return===n)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=n.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,Ac(n,l))));break;case 19:hi(a,n),ui(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,Ac(n,d)));break;case 30:break;case 21:break;default:hi(a,n),ui(n)}}function ui(n){var a=n.flags;if(a&2){try{for(var l,d=n.return;d!==null;){if(iy(d)){l=d;break}d=d.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,y=tf(n);Cc(n,y,m);break;case 5:var x=l.stateNode;l.flags&32&&(Ir(x,""),l.flags&=-33);var A=tf(n);Cc(n,A,x);break;case 3:case 4:var k=l.stateNode.containerInfo,U=tf(n);ef(n,U,k);break;default:throw Error(i(161))}}catch(W){Jt(n,n.return,W)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function uy(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;uy(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function qs(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)ry(n,a.alternate,a),a=a.sibling}function dr(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:En(4,a,a.return),dr(a);break;case 1:ys(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&ty(a,a.return,l),dr(a);break;case 27:zo(a.stateNode);case 26:case 5:ys(a,a.return),dr(a);break;case 22:a.memoizedState===null&&dr(a);break;case 30:dr(a);break;default:dr(a)}n=n.sibling}}function Ws(n,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,m=n,y=a,x=y.flags;switch(y.tag){case 0:case 11:case 15:Ws(m,y,l),Mo(4,y);break;case 1:if(Ws(m,y,l),d=y,m=d.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(U){Jt(d,d.return,U)}if(d=y,m=d.updateQueue,m!==null){var A=d.stateNode;try{var k=m.shared.hiddenCallbacks;if(k!==null)for(m.shared.hiddenCallbacks=null,m=0;m<k.length;m++)Um(k[m],A)}catch(U){Jt(d,d.return,U)}}l&&x&64&&J0(y),Oo(y,y.return);break;case 27:sy(y);case 26:case 5:Ws(m,y,l),l&&d===null&&x&4&&ey(y),Oo(y,y.return);break;case 12:Ws(m,y,l);break;case 31:Ws(m,y,l),l&&x&4&&ly(m,y);break;case 13:Ws(m,y,l),l&&x&4&&cy(m,y);break;case 22:y.memoizedState===null&&Ws(m,y,l),Oo(y,y.return);break;case 30:break;default:Ws(m,y,l)}a=a.sibling}}function nf(n,a){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&mo(l))}function rf(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&mo(n))}function ns(n,a,l,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)dy(n,a,l,d),a=a.sibling}function dy(n,a,l,d){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ns(n,a,l,d),m&2048&&Mo(9,a);break;case 1:ns(n,a,l,d);break;case 3:ns(n,a,l,d),m&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&mo(n)));break;case 12:if(m&2048){ns(n,a,l,d),n=a.stateNode;try{var y=a.memoizedProps,x=y.id,A=y.onPostCommit;typeof A=="function"&&A(x,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(k){Jt(a,a.return,k)}}else ns(n,a,l,d);break;case 31:ns(n,a,l,d);break;case 13:ns(n,a,l,d);break;case 23:break;case 22:y=a.stateNode,x=a.alternate,a.memoizedState!==null?y._visibility&2?ns(n,a,l,d):ko(n,a):y._visibility&2?ns(n,a,l,d):(y._visibility|=2,aa(n,a,l,d,(a.subtreeFlags&10256)!==0||!1)),m&2048&&nf(x,a);break;case 24:ns(n,a,l,d),m&2048&&rf(a.alternate,a);break;default:ns(n,a,l,d)}}function aa(n,a,l,d,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var y=n,x=a,A=l,k=d,U=x.flags;switch(x.tag){case 0:case 11:case 15:aa(y,x,A,k,m),Mo(8,x);break;case 23:break;case 22:var W=x.stateNode;x.memoizedState!==null?W._visibility&2?aa(y,x,A,k,m):ko(y,x):(W._visibility|=2,aa(y,x,A,k,m)),m&&U&2048&&nf(x.alternate,x);break;case 24:aa(y,x,A,k,m),m&&U&2048&&rf(x.alternate,x);break;default:aa(y,x,A,k,m)}a=a.sibling}}function ko(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=n,d=a,m=d.flags;switch(d.tag){case 22:ko(l,d),m&2048&&nf(d.alternate,d);break;case 24:ko(l,d),m&2048&&rf(d.alternate,d);break;default:ko(l,d)}a=a.sibling}}var Ro=8192;function oa(n,a,l){if(n.subtreeFlags&Ro)for(n=n.child;n!==null;)fy(n,a,l),n=n.sibling}function fy(n,a,l){switch(n.tag){case 26:oa(n,a,l),n.flags&Ro&&n.memoizedState!==null&&S1(l,ss,n.memoizedState,n.memoizedProps);break;case 5:oa(n,a,l);break;case 3:case 4:var d=ss;ss=zc(n.stateNode.containerInfo),oa(n,a,l),ss=d;break;case 22:n.memoizedState===null&&(d=n.alternate,d!==null&&d.memoizedState!==null?(d=Ro,Ro=16777216,oa(n,a,l),Ro=d):oa(n,a,l));break;default:oa(n,a,l)}}function gy(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function Lo(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];Fe=d,my(d,n)}gy(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)py(n),n=n.sibling}function py(n){switch(n.tag){case 0:case 11:case 15:Lo(n),n.flags&2048&&En(9,n,n.return);break;case 3:Lo(n);break;case 12:Lo(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,Tc(n)):Lo(n);break;default:Lo(n)}}function Tc(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];Fe=d,my(d,n)}gy(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:En(8,a,a.return),Tc(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Tc(a));break;default:Tc(a)}n=n.sibling}}function my(n,a){for(;Fe!==null;){var l=Fe;switch(l.tag){case 0:case 11:case 15:En(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:mo(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,Fe=d;else t:for(l=n;Fe!==null;){d=Fe;var m=d.sibling,y=d.return;if(ay(d),d===l){Fe=null;break t}if(m!==null){m.return=y,Fe=m;break t}Fe=y}}}var Nw={getCacheForType:function(n){var a=Ge(Te),l=a.data.get(n);return l===void 0&&(l=n(),a.data.set(n,l)),l},cacheSignal:function(){return Ge(Te).controller.signal}},Fw=typeof WeakMap=="function"?WeakMap:Map,Kt=0,ne=null,jt=null,It=0,Zt=0,Di=null,Dn=!1,la=!1,af=!1,Ks=0,be=0,Mn=0,fr=0,of=0,Mi=0,ca=0,Po=null,di=null,lf=!1,Ec=0,yy=0,Dc=1/0,Mc=null,On=null,Re=0,kn=null,ha=null,$s=0,cf=0,hf=null,vy=null,Bo=0,uf=null;function Oi(){return(Kt&2)!==0&&It!==0?It&-It:L.T!==null?yf():Pp()}function by(){if(Mi===0)if((It&536870912)===0||Gt){var n=Fl;Fl<<=1,(Fl&3932160)===0&&(Fl=262144),Mi=n}else Mi=536870912;return n=Ti.current,n!==null&&(n.flags|=32),Mi}function fi(n,a,l){(n===ne&&(Zt===2||Zt===9)||n.cancelPendingCommit!==null)&&(ua(n,0),Rn(n,It,Mi,!1)),eo(n,l),((Kt&2)===0||n!==ne)&&(n===ne&&((Kt&2)===0&&(fr|=l),be===4&&Rn(n,It,Mi,!1)),vs(n))}function _y(n,a,l){if((Kt&6)!==0)throw Error(i(327));var d=!l&&(a&127)===0&&(a&n.expiredLanes)===0||to(n,a),m=d?Iw(n,a):ff(n,a,!0),y=d;do{if(m===0){la&&!d&&Rn(n,a,0,!1);break}else{if(l=n.current.alternate,y&&!jw(l)){m=ff(n,a,!1),y=!1;continue}if(m===2){if(y=a,n.errorRecoveryDisabledLanes&y)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;t:{var A=n;m=Po;var k=A.current.memoizedState.isDehydrated;if(k&&(ua(A,x).flags|=256),x=ff(A,x,!1),x!==2){if(af&&!k){A.errorRecoveryDisabledLanes|=y,fr|=y,m=4;break t}y=di,di=m,y!==null&&(di===null?di=y:di.push.apply(di,y))}m=x}if(y=!1,m!==2)continue}}if(m===1){ua(n,0),Rn(n,a,0,!0);break}t:{switch(d=n,y=m,y){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Rn(d,a,Mi,!Dn);break t;case 2:di=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Ec+300-ti(),10<m)){if(Rn(d,a,Mi,!Dn),zl(d,0,!0)!==0)break t;$s=a,d.timeoutHandle=Qy(Sy.bind(null,d,l,di,Mc,lf,a,Mi,fr,ca,Dn,y,"Throttled",-0,0),m);break t}Sy(d,l,di,Mc,lf,a,Mi,fr,ca,Dn,y,null,-0,0)}}break}while(!0);vs(n)}function Sy(n,a,l,d,m,y,x,A,k,U,W,Z,V,q){if(n.timeoutHandle=-1,Z=a.subtreeFlags,Z&8192||(Z&16785408)===16785408){Z={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Bs},fy(a,y,Z);var mt=(y&62914560)===y?Ec-ti():(y&4194048)===y?yy-ti():0;if(mt=x1(Z,mt),mt!==null){$s=y,n.cancelPendingCommit=mt(My.bind(null,n,a,y,l,d,m,x,A,k,W,Z,null,V,q)),Rn(n,y,x,!U);return}}My(n,a,y,l,d,m,x,A,k)}function jw(n){for(var a=n;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var m=l[d],y=m.getSnapshot;m=m.value;try{if(!Ci(y(),m))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Rn(n,a,l,d){a&=~of,a&=~fr,n.suspendedLanes|=a,n.pingedLanes&=~a,d&&(n.warmLanes|=a),d=n.expirationTimes;for(var m=a;0<m;){var y=31-wi(m),x=1<<y;d[y]=-1,m&=~x}l!==0&&kp(n,l,a)}function Oc(){return(Kt&6)===0?(No(0),!1):!0}function df(){if(jt!==null){if(Zt===0)var n=jt.return;else n=jt,zs=nr=null,Ed(n),ea=null,vo=0,n=jt;for(;n!==null;)Z0(n.alternate,n),n=n.return;jt=null}}function ua(n,a){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,n1(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),$s=0,df(),ne=n,jt=l=Fs(n.current,null),It=a,Zt=0,Di=null,Dn=!1,la=to(n,a),af=!1,ca=Mi=of=fr=Mn=be=0,di=Po=null,lf=!1,(a&8)!==0&&(a|=a&32);var d=n.entangledLanes;if(d!==0)for(n=n.entanglements,d&=a;0<d;){var m=31-wi(d),y=1<<m;a|=n[m],d&=~y}return Ks=a,Ql(),l}function xy(n,a){Lt=null,L.H=To,a===ta||a===rc?(a=jm(),Zt=3):a===pd?(a=jm(),Zt=4):Zt=a===Gd?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Di=a,jt===null&&(be=1,bc(n,zi(a,n.current)))}function wy(){var n=Ti.current;return n===null?!0:(It&4194048)===It?Gi===null:(It&62914560)===It||(It&536870912)!==0?n===Gi:!1}function Cy(){var n=L.H;return L.H=To,n===null?To:n}function Ay(){var n=L.A;return L.A=Nw,n}function kc(){be=4,Dn||(It&4194048)!==It&&Ti.current!==null||(la=!0),(Mn&134217727)===0&&(fr&134217727)===0||ne===null||Rn(ne,It,Mi,!1)}function ff(n,a,l){var d=Kt;Kt|=2;var m=Cy(),y=Ay();(ne!==n||It!==a)&&(Mc=null,ua(n,a)),a=!1;var x=be;t:do try{if(Zt!==0&&jt!==null){var A=jt,k=Di;switch(Zt){case 8:df(),x=6;break t;case 3:case 2:case 9:case 6:Ti.current===null&&(a=!0);var U=Zt;if(Zt=0,Di=null,da(n,A,k,U),l&&la){x=0;break t}break;default:U=Zt,Zt=0,Di=null,da(n,A,k,U)}}zw(),x=be;break}catch(W){xy(n,W)}while(!0);return a&&n.shellSuspendCounter++,zs=nr=null,Kt=d,L.H=m,L.A=y,jt===null&&(ne=null,It=0,Ql()),x}function zw(){for(;jt!==null;)Ty(jt)}function Iw(n,a){var l=Kt;Kt|=2;var d=Cy(),m=Ay();ne!==n||It!==a?(Mc=null,Dc=ti()+500,ua(n,a)):la=to(n,a);t:do try{if(Zt!==0&&jt!==null){a=jt;var y=Di;e:switch(Zt){case 1:Zt=0,Di=null,da(n,a,y,1);break;case 2:case 9:if(Nm(y)){Zt=0,Di=null,Ey(a);break}a=function(){Zt!==2&&Zt!==9||ne!==n||(Zt=7),vs(n)},y.then(a,a);break t;case 3:Zt=7;break t;case 4:Zt=5;break t;case 7:Nm(y)?(Zt=0,Di=null,Ey(a)):(Zt=0,Di=null,da(n,a,y,7));break;case 5:var x=null;switch(jt.tag){case 26:x=jt.memoizedState;case 5:case 27:var A=jt;if(x?dv(x):A.stateNode.complete){Zt=0,Di=null;var k=A.sibling;if(k!==null)jt=k;else{var U=A.return;U!==null?(jt=U,Rc(U)):jt=null}break e}}Zt=0,Di=null,da(n,a,y,5);break;case 6:Zt=0,Di=null,da(n,a,y,6);break;case 8:df(),be=6;break t;default:throw Error(i(462))}}Hw();break}catch(W){xy(n,W)}while(!0);return zs=nr=null,L.H=d,L.A=m,Kt=l,jt!==null?0:(ne=null,It=0,Ql(),be)}function Hw(){for(;jt!==null&&!Au();)Ty(jt)}function Ty(n){var a=$0(n.alternate,n,Ks);n.memoizedProps=n.pendingProps,a===null?Rc(n):jt=a}function Ey(n){var a=n,l=a.alternate;switch(a.tag){case 15:case 0:a=V0(l,a,a.pendingProps,a.type,void 0,It);break;case 11:a=V0(l,a,a.pendingProps,a.type.render,a.ref,It);break;case 5:Ed(a);default:Z0(l,a),a=jt=Am(a,Ks),a=$0(l,a,Ks)}n.memoizedProps=n.pendingProps,a===null?Rc(n):jt=a}function da(n,a,l,d){zs=nr=null,Ed(a),ea=null,vo=0;var m=a.return;try{if(Mw(n,m,a,l,It)){be=1,bc(n,zi(l,n.current)),jt=null;return}}catch(y){if(m!==null)throw jt=m,y;be=1,bc(n,zi(l,n.current)),jt=null;return}a.flags&32768?(Gt||d===1?n=!0:la||(It&536870912)!==0?n=!1:(Dn=n=!0,(d===2||d===9||d===3||d===6)&&(d=Ti.current,d!==null&&d.tag===13&&(d.flags|=16384))),Dy(a,n)):Rc(a)}function Rc(n){var a=n;do{if((a.flags&32768)!==0){Dy(a,Dn);return}n=a.return;var l=Rw(a.alternate,a,Ks);if(l!==null){jt=l;return}if(a=a.sibling,a!==null){jt=a;return}jt=a=n}while(a!==null);be===0&&(be=5)}function Dy(n,a){do{var l=Lw(n.alternate,n);if(l!==null){l.flags&=32767,jt=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(n=n.sibling,n!==null)){jt=n;return}jt=n=l}while(n!==null);be=6,jt=null}function My(n,a,l,d,m,y,x,A,k){n.cancelPendingCommit=null;do Lc();while(Re!==0);if((Kt&6)!==0)throw Error(i(327));if(a!==null){if(a===n.current)throw Error(i(177));if(y=a.lanes|a.childLanes,y|=td,_x(n,l,y,x,A,k),n===ne&&(jt=ne=null,It=0),ha=a,kn=n,$s=l,cf=y,hf=m,vy=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Xw(es,function(){return Py(),null})):(n.callbackNode=null,n.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=L.T,L.T=null,m=I.p,I.p=2,x=Kt,Kt|=4;try{Pw(n,a,l)}finally{Kt=x,I.p=m,L.T=d}}Re=1,Oy(),ky(),Ry()}}function Oy(){if(Re===1){Re=0;var n=kn,a=ha,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=L.T,L.T=null;var d=I.p;I.p=2;var m=Kt;Kt|=4;try{hy(a,n);var y=Af,x=mm(n.containerInfo),A=y.focusedElem,k=y.selectionRange;if(x!==A&&A&&A.ownerDocument&&pm(A.ownerDocument.documentElement,A)){if(k!==null&&Ku(A)){var U=k.start,W=k.end;if(W===void 0&&(W=U),"selectionStart"in A)A.selectionStart=U,A.selectionEnd=Math.min(W,A.value.length);else{var Z=A.ownerDocument||document,V=Z&&Z.defaultView||window;if(V.getSelection){var q=V.getSelection(),mt=A.textContent.length,Ct=Math.min(k.start,mt),ie=k.end===void 0?Ct:Math.min(k.end,mt);!q.extend&&Ct>ie&&(x=ie,ie=Ct,Ct=x);var z=gm(A,Ct),N=gm(A,ie);if(z&&N&&(q.rangeCount!==1||q.anchorNode!==z.node||q.anchorOffset!==z.offset||q.focusNode!==N.node||q.focusOffset!==N.offset)){var H=Z.createRange();H.setStart(z.node,z.offset),q.removeAllRanges(),Ct>ie?(q.addRange(H),q.extend(N.node,N.offset)):(H.setEnd(N.node,N.offset),q.addRange(H))}}}}for(Z=[],q=A;q=q.parentNode;)q.nodeType===1&&Z.push({element:q,left:q.scrollLeft,top:q.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<Z.length;A++){var $=Z[A];$.element.scrollLeft=$.left,$.element.scrollTop=$.top}}Xc=!!Cf,Af=Cf=null}finally{Kt=m,I.p=d,L.T=l}}n.current=a,Re=2}}function ky(){if(Re===2){Re=0;var n=kn,a=ha,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=L.T,L.T=null;var d=I.p;I.p=2;var m=Kt;Kt|=4;try{ry(n,a.alternate,a)}finally{Kt=m,I.p=d,L.T=l}}Re=3}}function Ry(){if(Re===4||Re===3){Re=0,Tu();var n=kn,a=ha,l=$s,d=vy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Re=5:(Re=0,ha=kn=null,Ly(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(On=null),Ou(l),a=a.stateNode,xi&&typeof xi.onCommitFiberRoot=="function")try{xi.onCommitFiberRoot(Ja,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=L.T,m=I.p,I.p=2,L.T=null;try{for(var y=n.onRecoverableError,x=0;x<d.length;x++){var A=d[x];y(A.value,{componentStack:A.stack})}}finally{L.T=a,I.p=m}}($s&3)!==0&&Lc(),vs(n),m=n.pendingLanes,(l&261930)!==0&&(m&42)!==0?n===uf?Bo++:(Bo=0,uf=n):Bo=0,No(0)}}function Ly(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,mo(a)))}function Lc(){return Oy(),ky(),Ry(),Py()}function Py(){if(Re!==5)return!1;var n=kn,a=cf;cf=0;var l=Ou($s),d=L.T,m=I.p;try{I.p=32>l?32:l,L.T=null,l=hf,hf=null;var y=kn,x=$s;if(Re=0,ha=kn=null,$s=0,(Kt&6)!==0)throw Error(i(331));var A=Kt;if(Kt|=4,py(y.current),dy(y,y.current,x,l),Kt=A,No(0,!1),xi&&typeof xi.onPostCommitFiberRoot=="function")try{xi.onPostCommitFiberRoot(Ja,y)}catch{}return!0}finally{I.p=m,L.T=d,Ly(n,a)}}function By(n,a,l){a=zi(l,a),a=Ud(n.stateNode,a,2),n=Cn(n,a,2),n!==null&&(eo(n,2),vs(n))}function Jt(n,a,l){if(n.tag===3)By(n,n,l);else for(;a!==null;){if(a.tag===3){By(a,n,l);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(On===null||!On.has(d))){n=zi(l,n),l=N0(2),d=Cn(a,l,2),d!==null&&(F0(l,d,a,n),eo(d,2),vs(d));break}}a=a.return}}function gf(n,a,l){var d=n.pingCache;if(d===null){d=n.pingCache=new Fw;var m=new Set;d.set(a,m)}else m=d.get(a),m===void 0&&(m=new Set,d.set(a,m));m.has(l)||(af=!0,m.add(l),n=Uw.bind(null,n,a,l),a.then(n,n))}function Uw(n,a,l){var d=n.pingCache;d!==null&&d.delete(a),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,ne===n&&(It&l)===l&&(be===4||be===3&&(It&62914560)===It&&300>ti()-Ec?(Kt&2)===0&&ua(n,0):of|=l,ca===It&&(ca=0)),vs(n)}function Ny(n,a){a===0&&(a=Op()),n=er(n,a),n!==null&&(eo(n,a),vs(n))}function Gw(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),Ny(n,l)}function Vw(n,a){var l=0;switch(n.tag){case 31:case 13:var d=n.stateNode,m=n.memoizedState;m!==null&&(l=m.retryLane);break;case 19:d=n.stateNode;break;case 22:d=n.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(a),Ny(n,l)}function Xw(n,a){return Za(n,a)}var Pc=null,fa=null,pf=!1,Bc=!1,mf=!1,Ln=0;function vs(n){n!==fa&&n.next===null&&(fa===null?Pc=fa=n:fa=fa.next=n),Bc=!0,pf||(pf=!0,qw())}function No(n,a){if(!mf&&Bc){mf=!0;do for(var l=!1,d=Pc;d!==null;){if(n!==0){var m=d.pendingLanes;if(m===0)var y=0;else{var x=d.suspendedLanes,A=d.pingedLanes;y=(1<<31-wi(42|n)+1)-1,y&=m&~(x&~A),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,Iy(d,y))}else y=It,y=zl(d,d===ne?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||to(d,y)||(l=!0,Iy(d,y));d=d.next}while(l);mf=!1}}function Yw(){Fy()}function Fy(){Bc=pf=!1;var n=0;Ln!==0&&s1()&&(n=Ln);for(var a=ti(),l=null,d=Pc;d!==null;){var m=d.next,y=jy(d,a);y===0?(d.next=null,l===null?Pc=m:l.next=m,m===null&&(fa=l)):(l=d,(n!==0||(y&3)!==0)&&(Bc=!0)),d=m}Re!==0&&Re!==5||No(n),Ln!==0&&(Ln=0)}function jy(n,a){for(var l=n.suspendedLanes,d=n.pingedLanes,m=n.expirationTimes,y=n.pendingLanes&-62914561;0<y;){var x=31-wi(y),A=1<<x,k=m[x];k===-1?((A&l)===0||(A&d)!==0)&&(m[x]=bx(A,a)):k<=a&&(n.expiredLanes|=A),y&=~A}if(a=ne,l=It,l=zl(n,n===a?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d=n.callbackNode,l===0||n===a&&(Zt===2||Zt===9)||n.cancelPendingCommit!==null)return d!==null&&d!==null&&gn(d),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||to(n,l)){if(a=l&-l,a===n.callbackPriority)return a;switch(d!==null&&gn(d),Ou(l)){case 2:case 8:l=ts;break;case 32:l=es;break;case 268435456:l=Lr;break;default:l=es}return d=zy.bind(null,n),l=Za(l,d),n.callbackPriority=a,n.callbackNode=l,a}return d!==null&&d!==null&&gn(d),n.callbackPriority=2,n.callbackNode=null,2}function zy(n,a){if(Re!==0&&Re!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Lc()&&n.callbackNode!==l)return null;var d=It;return d=zl(n,n===ne?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d===0?null:(_y(n,d,a),jy(n,ti()),n.callbackNode!=null&&n.callbackNode===l?zy.bind(null,n):null)}function Iy(n,a){if(Lc())return null;_y(n,a,!0)}function qw(){r1(function(){(Kt&6)!==0?Za(Bl,Yw):Fy()})}function yf(){if(Ln===0){var n=Zr;n===0&&(n=Nl,Nl<<=1,(Nl&261888)===0&&(Nl=256)),Ln=n}return Ln}function Hy(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Gl(""+n)}function Uy(n,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,n.id&&l.setAttribute("form",n.id),a.parentNode.insertBefore(l,a),n=new FormData(n),l.parentNode.removeChild(l),n}function Ww(n,a,l,d,m){if(a==="submit"&&l&&l.stateNode===m){var y=Hy((m[oi]||null).action),x=d.submitter;x&&(a=(a=x[oi]||null)?Hy(a.formAction):x.getAttribute("formAction"),a!==null&&(y=a,x=null));var A=new ql("action","action",null,d,m);n.push({event:A,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Ln!==0){var k=x?Uy(m,x):new FormData(m);Nd(l,{pending:!0,data:k,method:m.method,action:y},null,k)}}else typeof y=="function"&&(A.preventDefault(),k=x?Uy(m,x):new FormData(m),Nd(l,{pending:!0,data:k,method:m.method,action:y},y,k))},currentTarget:m}]})}}for(var vf=0;vf<Ju.length;vf++){var bf=Ju[vf],Kw=bf.toLowerCase(),$w=bf[0].toUpperCase()+bf.slice(1);is(Kw,"on"+$w)}is(bm,"onAnimationEnd"),is(_m,"onAnimationIteration"),is(Sm,"onAnimationStart"),is("dblclick","onDoubleClick"),is("focusin","onFocus"),is("focusout","onBlur"),is(dw,"onTransitionRun"),is(fw,"onTransitionStart"),is(gw,"onTransitionCancel"),is(xm,"onTransitionEnd"),jr("onMouseEnter",["mouseout","mouseover"]),jr("onMouseLeave",["mouseout","mouseover"]),jr("onPointerEnter",["pointerout","pointerover"]),jr("onPointerLeave",["pointerout","pointerover"]),Qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fo));function Gy(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],m=d.event;d=d.listeners;t:{var y=void 0;if(a)for(var x=d.length-1;0<=x;x--){var A=d[x],k=A.instance,U=A.currentTarget;if(A=A.listener,k!==y&&m.isPropagationStopped())break t;y=A,m.currentTarget=U;try{y(m)}catch(W){$l(W)}m.currentTarget=null,y=k}else for(x=0;x<d.length;x++){if(A=d[x],k=A.instance,U=A.currentTarget,A=A.listener,k!==y&&m.isPropagationStopped())break t;y=A,m.currentTarget=U;try{y(m)}catch(W){$l(W)}m.currentTarget=null,y=k}}}}function zt(n,a){var l=a[ku];l===void 0&&(l=a[ku]=new Set);var d=n+"__bubble";l.has(d)||(Vy(a,n,2,!1),l.add(d))}function _f(n,a,l){var d=0;a&&(d|=4),Vy(l,n,d,a)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function Sf(n){if(!n[Nc]){n[Nc]=!0,Fp.forEach(function(l){l!=="selectionchange"&&(Qw.has(l)||_f(l,!1,n),_f(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Nc]||(a[Nc]=!0,_f("selectionchange",!1,a))}}function Vy(n,a,l,d){switch(bv(a)){case 2:var m=A1;break;case 8:m=T1;break;default:m=Nf}l=m.bind(null,a,l,n),m=void 0,!Iu||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),d?m!==void 0?n.addEventListener(a,l,{capture:!0,passive:m}):n.addEventListener(a,l,!0):m!==void 0?n.addEventListener(a,l,{passive:m}):n.addEventListener(a,l,!1)}function xf(n,a,l,d,m){var y=d;if((a&1)===0&&(a&2)===0&&d!==null)t:for(;;){if(d===null)return;var x=d.tag;if(x===3||x===4){var A=d.stateNode.containerInfo;if(A===m)break;if(x===4)for(x=d.return;x!==null;){var k=x.tag;if((k===3||k===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;A!==null;){if(x=Br(A),x===null)return;if(k=x.tag,k===5||k===6||k===26||k===27){d=y=x;continue t}A=A.parentNode}}d=d.return}Kp(function(){var U=y,W=ju(l),Z=[];t:{var V=wm.get(n);if(V!==void 0){var q=ql,mt=n;switch(n){case"keypress":if(Xl(l)===0)break t;case"keydown":case"keyup":q=Vx;break;case"focusin":mt="focus",q=Vu;break;case"focusout":mt="blur",q=Vu;break;case"beforeblur":case"afterblur":q=Vu;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Zp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=Rx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=qx;break;case bm:case _m:case Sm:q=Bx;break;case xm:q=Kx;break;case"scroll":case"scrollend":q=Ox;break;case"wheel":q=Qx;break;case"copy":case"cut":case"paste":q=Fx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=tm;break;case"toggle":case"beforetoggle":q=Jx}var Ct=(a&4)!==0,ie=!Ct&&(n==="scroll"||n==="scrollend"),z=Ct?V!==null?V+"Capture":null:V;Ct=[];for(var N=U,H;N!==null;){var $=N;if(H=$.stateNode,$=$.tag,$!==5&&$!==26&&$!==27||H===null||z===null||($=no(N,z),$!=null&&Ct.push(jo(N,$,H))),ie)break;N=N.return}0<Ct.length&&(V=new q(V,mt,null,l,W),Z.push({event:V,listeners:Ct}))}}if((a&7)===0){t:{if(V=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",V&&l!==Fu&&(mt=l.relatedTarget||l.fromElement)&&(Br(mt)||mt[Pr]))break t;if((q||V)&&(V=W.window===W?W:(V=W.ownerDocument)?V.defaultView||V.parentWindow:window,q?(mt=l.relatedTarget||l.toElement,q=U,mt=mt?Br(mt):null,mt!==null&&(ie=r(mt),Ct=mt.tag,mt!==ie||Ct!==5&&Ct!==27&&Ct!==6)&&(mt=null)):(q=null,mt=U),q!==mt)){if(Ct=Zp,$="onMouseLeave",z="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(Ct=tm,$="onPointerLeave",z="onPointerEnter",N="pointer"),ie=q==null?V:so(q),H=mt==null?V:so(mt),V=new Ct($,N+"leave",q,l,W),V.target=ie,V.relatedTarget=H,$=null,Br(W)===U&&(Ct=new Ct(z,N+"enter",mt,l,W),Ct.target=H,Ct.relatedTarget=ie,$=Ct),ie=$,q&&mt)e:{for(Ct=Zw,z=q,N=mt,H=0,$=z;$;$=Ct($))H++;$=0;for(var St=N;St;St=Ct(St))$++;for(;0<H-$;)z=Ct(z),H--;for(;0<$-H;)N=Ct(N),$--;for(;H--;){if(z===N||N!==null&&z===N.alternate){Ct=z;break e}z=Ct(z),N=Ct(N)}Ct=null}else Ct=null;q!==null&&Xy(Z,V,q,Ct,!1),mt!==null&&ie!==null&&Xy(Z,ie,mt,Ct,!0)}}t:{if(V=U?so(U):window,q=V.nodeName&&V.nodeName.toLowerCase(),q==="select"||q==="input"&&V.type==="file")var Yt=lm;else if(am(V))if(cm)Yt=cw;else{Yt=ow;var vt=aw}else q=V.nodeName,!q||q.toLowerCase()!=="input"||V.type!=="checkbox"&&V.type!=="radio"?U&&Nu(U.elementType)&&(Yt=lm):Yt=lw;if(Yt&&(Yt=Yt(n,U))){om(Z,Yt,l,W);break t}vt&&vt(n,V,U),n==="focusout"&&U&&V.type==="number"&&U.memoizedProps.value!=null&&Bu(V,"number",V.value)}switch(vt=U?so(U):window,n){case"focusin":(am(vt)||vt.contentEditable==="true")&&(Vr=vt,$u=U,fo=null);break;case"focusout":fo=$u=Vr=null;break;case"mousedown":Qu=!0;break;case"contextmenu":case"mouseup":case"dragend":Qu=!1,ym(Z,l,W);break;case"selectionchange":if(uw)break;case"keydown":case"keyup":ym(Z,l,W)}var Bt;if(Yu)t:{switch(n){case"compositionstart":var Ht="onCompositionStart";break t;case"compositionend":Ht="onCompositionEnd";break t;case"compositionupdate":Ht="onCompositionUpdate";break t}Ht=void 0}else Gr?nm(n,l)&&(Ht="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Ht="onCompositionStart");Ht&&(em&&l.locale!=="ko"&&(Gr||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&Gr&&(Bt=$p()):(yn=W,Hu="value"in yn?yn.value:yn.textContent,Gr=!0)),vt=Fc(U,Ht),0<vt.length&&(Ht=new Jp(Ht,n,null,l,W),Z.push({event:Ht,listeners:vt}),Bt?Ht.data=Bt:(Bt=rm(l),Bt!==null&&(Ht.data=Bt)))),(Bt=ew?iw(n,l):sw(n,l))&&(Ht=Fc(U,"onBeforeInput"),0<Ht.length&&(vt=new Jp("onBeforeInput","beforeinput",null,l,W),Z.push({event:vt,listeners:Ht}),vt.data=Bt)),Ww(Z,n,U,l,W)}Gy(Z,a)})}function jo(n,a,l){return{instance:n,listener:a,currentTarget:l}}function Fc(n,a){for(var l=a+"Capture",d=[];n!==null;){var m=n,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=no(n,l),m!=null&&d.unshift(jo(n,m,y)),m=no(n,a),m!=null&&d.push(jo(n,m,y))),n.tag===3)return d;n=n.return}return[]}function Zw(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Xy(n,a,l,d,m){for(var y=a._reactName,x=[];l!==null&&l!==d;){var A=l,k=A.alternate,U=A.stateNode;if(A=A.tag,k!==null&&k===d)break;A!==5&&A!==26&&A!==27||U===null||(k=U,m?(U=no(l,y),U!=null&&x.unshift(jo(l,U,k))):m||(U=no(l,y),U!=null&&x.push(jo(l,U,k)))),l=l.return}x.length!==0&&n.push({event:a,listeners:x})}var Jw=/\r\n?/g,t1=/\u0000|\uFFFD/g;function Yy(n){return(typeof n=="string"?n:""+n).replace(Jw,`
`).replace(t1,"")}function qy(n,a){return a=Yy(a),Yy(n)===a}function ee(n,a,l,d,m,y){switch(l){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Ir(n,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Ir(n,""+d);break;case"className":Hl(n,"class",d);break;case"tabIndex":Hl(n,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Hl(n,l,d);break;case"style":qp(n,d,y);break;case"data":if(a!=="object"){Hl(n,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||l!=="href")){n.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(l);break}d=Gl(""+d),n.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(a!=="input"&&ee(n,a,"name",m.name,m,null),ee(n,a,"formEncType",m.formEncType,m,null),ee(n,a,"formMethod",m.formMethod,m,null),ee(n,a,"formTarget",m.formTarget,m,null)):(ee(n,a,"encType",m.encType,m,null),ee(n,a,"method",m.method,m,null),ee(n,a,"target",m.target,m,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(l);break}d=Gl(""+d),n.setAttribute(l,d);break;case"onClick":d!=null&&(n.onclick=Bs);break;case"onScroll":d!=null&&zt("scroll",n);break;case"onScrollEnd":d!=null&&zt("scrollend",n);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"multiple":n.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":n.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){n.removeAttribute("xlink:href");break}l=Gl(""+d),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,""+d):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":d===!0?n.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,d):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?n.setAttribute(l,d):n.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?n.removeAttribute(l):n.setAttribute(l,d);break;case"popover":zt("beforetoggle",n),zt("toggle",n),Il(n,"popover",d);break;case"xlinkActuate":Ps(n,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Ps(n,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Ps(n,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Ps(n,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Ps(n,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Ps(n,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Ps(n,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Ps(n,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Ps(n,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Il(n,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Dx.get(l)||l,Il(n,l,d))}}function wf(n,a,l,d,m,y){switch(l){case"style":qp(n,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"children":typeof d=="string"?Ir(n,d):(typeof d=="number"||typeof d=="bigint")&&Ir(n,""+d);break;case"onScroll":d!=null&&zt("scroll",n);break;case"onScrollEnd":d!=null&&zt("scrollend",n);break;case"onClick":d!=null&&(n.onclick=Bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jp.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),a=l.slice(2,m?l.length-7:void 0),y=n[oi]||null,y=y!=null?y[l]:null,typeof y=="function"&&n.removeEventListener(a,y,m),typeof d=="function")){typeof y!="function"&&y!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(a,d,m);break t}l in n?n[l]=d:d===!0?n.setAttribute(l,""):Il(n,l,d)}}}function Xe(n,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",n),zt("load",n);var d=!1,m=!1,y;for(y in l)if(l.hasOwnProperty(y)){var x=l[y];if(x!=null)switch(y){case"src":d=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:ee(n,a,y,x,l,null)}}m&&ee(n,a,"srcSet",l.srcSet,l,null),d&&ee(n,a,"src",l.src,l,null);return;case"input":zt("invalid",n);var A=y=x=m=null,k=null,U=null;for(d in l)if(l.hasOwnProperty(d)){var W=l[d];if(W!=null)switch(d){case"name":m=W;break;case"type":x=W;break;case"checked":k=W;break;case"defaultChecked":U=W;break;case"value":y=W;break;case"defaultValue":A=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,a));break;default:ee(n,a,d,W,l,null)}}Gp(n,y,A,k,U,x,m,!1);return;case"select":zt("invalid",n),d=x=y=null;for(m in l)if(l.hasOwnProperty(m)&&(A=l[m],A!=null))switch(m){case"value":y=A;break;case"defaultValue":x=A;break;case"multiple":d=A;default:ee(n,a,m,A,l,null)}a=y,l=x,n.multiple=!!d,a!=null?zr(n,!!d,a,!1):l!=null&&zr(n,!!d,l,!0);return;case"textarea":zt("invalid",n),y=m=d=null;for(x in l)if(l.hasOwnProperty(x)&&(A=l[x],A!=null))switch(x){case"value":d=A;break;case"defaultValue":m=A;break;case"children":y=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:ee(n,a,x,A,l,null)}Xp(n,d,m,y);return;case"option":for(k in l)if(l.hasOwnProperty(k)&&(d=l[k],d!=null))switch(k){case"selected":n.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:ee(n,a,k,d,l,null)}return;case"dialog":zt("beforetoggle",n),zt("toggle",n),zt("cancel",n),zt("close",n);break;case"iframe":case"object":zt("load",n);break;case"video":case"audio":for(d=0;d<Fo.length;d++)zt(Fo[d],n);break;case"image":zt("error",n),zt("load",n);break;case"details":zt("toggle",n);break;case"embed":case"source":case"link":zt("error",n),zt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in l)if(l.hasOwnProperty(U)&&(d=l[U],d!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:ee(n,a,U,d,l,null)}return;default:if(Nu(a)){for(W in l)l.hasOwnProperty(W)&&(d=l[W],d!==void 0&&wf(n,a,W,d,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(d=l[A],d!=null&&ee(n,a,A,d,l,null))}function e1(n,a,l,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,x=null,A=null,k=null,U=null,W=null;for(q in l){var Z=l[q];if(l.hasOwnProperty(q)&&Z!=null)switch(q){case"checked":break;case"value":break;case"defaultValue":k=Z;default:d.hasOwnProperty(q)||ee(n,a,q,null,d,Z)}}for(var V in d){var q=d[V];if(Z=l[V],d.hasOwnProperty(V)&&(q!=null||Z!=null))switch(V){case"type":y=q;break;case"name":m=q;break;case"checked":U=q;break;case"defaultChecked":W=q;break;case"value":x=q;break;case"defaultValue":A=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(137,a));break;default:q!==Z&&ee(n,a,V,q,d,Z)}}Pu(n,x,A,k,U,W,y,m);return;case"select":q=x=A=V=null;for(y in l)if(k=l[y],l.hasOwnProperty(y)&&k!=null)switch(y){case"value":break;case"multiple":q=k;default:d.hasOwnProperty(y)||ee(n,a,y,null,d,k)}for(m in d)if(y=d[m],k=l[m],d.hasOwnProperty(m)&&(y!=null||k!=null))switch(m){case"value":V=y;break;case"defaultValue":A=y;break;case"multiple":x=y;default:y!==k&&ee(n,a,m,y,d,k)}a=A,l=x,d=q,V!=null?zr(n,!!l,V,!1):!!d!=!!l&&(a!=null?zr(n,!!l,a,!0):zr(n,!!l,l?[]:"",!1));return;case"textarea":q=V=null;for(A in l)if(m=l[A],l.hasOwnProperty(A)&&m!=null&&!d.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ee(n,a,A,null,d,m)}for(x in d)if(m=d[x],y=l[x],d.hasOwnProperty(x)&&(m!=null||y!=null))switch(x){case"value":V=m;break;case"defaultValue":q=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==y&&ee(n,a,x,m,d,y)}Vp(n,V,q);return;case"option":for(var mt in l)if(V=l[mt],l.hasOwnProperty(mt)&&V!=null&&!d.hasOwnProperty(mt))switch(mt){case"selected":n.selected=!1;break;default:ee(n,a,mt,null,d,V)}for(k in d)if(V=d[k],q=l[k],d.hasOwnProperty(k)&&V!==q&&(V!=null||q!=null))switch(k){case"selected":n.selected=V&&typeof V!="function"&&typeof V!="symbol";break;default:ee(n,a,k,V,d,q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ct in l)V=l[Ct],l.hasOwnProperty(Ct)&&V!=null&&!d.hasOwnProperty(Ct)&&ee(n,a,Ct,null,d,V);for(U in d)if(V=d[U],q=l[U],d.hasOwnProperty(U)&&V!==q&&(V!=null||q!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(137,a));break;default:ee(n,a,U,V,d,q)}return;default:if(Nu(a)){for(var ie in l)V=l[ie],l.hasOwnProperty(ie)&&V!==void 0&&!d.hasOwnProperty(ie)&&wf(n,a,ie,void 0,d,V);for(W in d)V=d[W],q=l[W],!d.hasOwnProperty(W)||V===q||V===void 0&&q===void 0||wf(n,a,W,V,d,q);return}}for(var z in l)V=l[z],l.hasOwnProperty(z)&&V!=null&&!d.hasOwnProperty(z)&&ee(n,a,z,null,d,V);for(Z in d)V=d[Z],q=l[Z],!d.hasOwnProperty(Z)||V===q||V==null&&q==null||ee(n,a,Z,V,d,q)}function Wy(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function i1(){if(typeof performance.getEntriesByType=="function"){for(var n=0,a=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var m=l[d],y=m.transferSize,x=m.initiatorType,A=m.duration;if(y&&A&&Wy(x)){for(x=0,A=m.responseEnd,d+=1;d<l.length;d++){var k=l[d],U=k.startTime;if(U>A)break;var W=k.transferSize,Z=k.initiatorType;W&&Wy(Z)&&(k=k.responseEnd,x+=W*(k<A?1:(A-U)/(k-U)))}if(--d,a+=8*(y+x)/(m.duration/1e3),n++,10<n)break}}if(0<n)return a/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Cf=null,Af=null;function jc(n){return n.nodeType===9?n:n.ownerDocument}function Ky(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $y(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function Tf(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ef=null;function s1(){var n=window.event;return n&&n.type==="popstate"?n===Ef?!1:(Ef=n,!0):(Ef=null,!1)}var Qy=typeof setTimeout=="function"?setTimeout:void 0,n1=typeof clearTimeout=="function"?clearTimeout:void 0,Zy=typeof Promise=="function"?Promise:void 0,r1=typeof queueMicrotask=="function"?queueMicrotask:typeof Zy<"u"?function(n){return Zy.resolve(null).then(n).catch(a1)}:Qy;function a1(n){setTimeout(function(){throw n})}function Pn(n){return n==="head"}function Jy(n,a){var l=a,d=0;do{var m=l.nextSibling;if(n.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(d===0){n.removeChild(m),ya(a);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")zo(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,zo(l);for(var y=l.firstChild;y;){var x=y.nextSibling,A=y.nodeName;y[io]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=x}}else l==="body"&&zo(n.ownerDocument.body);l=m}while(l);ya(a)}function tv(n,a){var l=n;n=0;do{var d=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=d}while(l)}function Df(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Df(l),Ru(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function o1(n,a,l,d){for(;n.nodeType===1;){var m=l;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(d){if(!n[io])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(y=n.getAttribute("rel"),y==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(y!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(y=n.getAttribute("src"),(y!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===y)return n}else return n;if(n=Vi(n.nextSibling),n===null)break}return null}function l1(n,a,l){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=Vi(n.nextSibling),n===null))return null;return n}function ev(n,a){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=Vi(n.nextSibling),n===null))return null;return n}function Mf(n){return n.data==="$?"||n.data==="$~"}function Of(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function c1(n,a){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=a;else if(n.data!=="$?"||l.readyState!=="loading")a();else{var d=function(){a(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),n._reactRetry=d}}function Vi(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return n}var kf=null;function iv(n){n=n.nextSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(a===0)return Vi(n.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}n=n.nextSibling}return null}function sv(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return n;a--}else l!=="/$"&&l!=="/&"||a++}n=n.previousSibling}return null}function nv(n,a,l){switch(a=jc(l),n){case"html":if(n=a.documentElement,!n)throw Error(i(452));return n;case"head":if(n=a.head,!n)throw Error(i(453));return n;case"body":if(n=a.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function zo(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);Ru(n)}var Xi=new Map,rv=new Set;function zc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Qs=I.d;I.d={f:h1,r:u1,D:d1,C:f1,L:g1,m:p1,X:y1,S:m1,M:v1};function h1(){var n=Qs.f(),a=Oc();return n||a}function u1(n){var a=Nr(n);a!==null&&a.tag===5&&a.type==="form"?x0(a):Qs.r(n)}var ga=typeof document>"u"?null:document;function av(n,a,l){var d=ga;if(d&&typeof a=="string"&&a){var m=Fi(a);m='link[rel="'+n+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),rv.has(m)||(rv.add(m),n={rel:n,crossOrigin:l,href:a},d.querySelector(m)===null&&(a=d.createElement("link"),Xe(a,"link",n),Ne(a),d.head.appendChild(a)))}}function d1(n){Qs.D(n),av("dns-prefetch",n,null)}function f1(n,a){Qs.C(n,a),av("preconnect",n,a)}function g1(n,a,l){Qs.L(n,a,l);var d=ga;if(d&&n&&a){var m='link[rel="preload"][as="'+Fi(a)+'"]';a==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Fi(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Fi(l.imageSizes)+'"]')):m+='[href="'+Fi(n)+'"]';var y=m;switch(a){case"style":y=pa(n);break;case"script":y=ma(n)}Xi.has(y)||(n=p({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:n,as:a},l),Xi.set(y,n),d.querySelector(m)!==null||a==="style"&&d.querySelector(Io(y))||a==="script"&&d.querySelector(Ho(y))||(a=d.createElement("link"),Xe(a,"link",n),Ne(a),d.head.appendChild(a)))}}function p1(n,a){Qs.m(n,a);var l=ga;if(l&&n){var d=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Fi(d)+'"][href="'+Fi(n)+'"]',y=m;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ma(n)}if(!Xi.has(y)&&(n=p({rel:"modulepreload",href:n},a),Xi.set(y,n),l.querySelector(m)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ho(y)))return}d=l.createElement("link"),Xe(d,"link",n),Ne(d),l.head.appendChild(d)}}}function m1(n,a,l){Qs.S(n,a,l);var d=ga;if(d&&n){var m=Fr(d).hoistableStyles,y=pa(n);a=a||"default";var x=m.get(y);if(!x){var A={loading:0,preload:null};if(x=d.querySelector(Io(y)))A.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":a},l),(l=Xi.get(y))&&Rf(n,l);var k=x=d.createElement("link");Ne(k),Xe(k,"link",n),k._p=new Promise(function(U,W){k.onload=U,k.onerror=W}),k.addEventListener("load",function(){A.loading|=1}),k.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Ic(x,a,d)}x={type:"stylesheet",instance:x,count:1,state:A},m.set(y,x)}}}function y1(n,a){Qs.X(n,a);var l=ga;if(l&&n){var d=Fr(l).hoistableScripts,m=ma(n),y=d.get(m);y||(y=l.querySelector(Ho(m)),y||(n=p({src:n,async:!0},a),(a=Xi.get(m))&&Lf(n,a),y=l.createElement("script"),Ne(y),Xe(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(m,y))}}function v1(n,a){Qs.M(n,a);var l=ga;if(l&&n){var d=Fr(l).hoistableScripts,m=ma(n),y=d.get(m);y||(y=l.querySelector(Ho(m)),y||(n=p({src:n,async:!0,type:"module"},a),(a=Xi.get(m))&&Lf(n,a),y=l.createElement("script"),Ne(y),Xe(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(m,y))}}function ov(n,a,l,d){var m=(m=gt.current)?zc(m):null;if(!m)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=pa(l.href),l=Fr(m).hoistableStyles,d=l.get(a),d||(d={type:"style",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=pa(l.href);var y=Fr(m).hoistableStyles,x=y.get(n);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(n,x),(y=m.querySelector(Io(n)))&&!y._p&&(x.instance=y,x.state.loading=5),Xi.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Xi.set(n,l),y||b1(m,n,l,x.state))),a&&d===null)throw Error(i(528,""));return x}if(a&&d!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ma(l),l=Fr(m).hoistableScripts,d=l.get(a),d||(d={type:"script",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function pa(n){return'href="'+Fi(n)+'"'}function Io(n){return'link[rel="stylesheet"]['+n+"]"}function lv(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function b1(n,a,l,d){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=n.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),Xe(a,"link",l),Ne(a),n.head.appendChild(a))}function ma(n){return'[src="'+Fi(n)+'"]'}function Ho(n){return"script[async]"+n}function cv(n,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var d=n.querySelector('style[data-href~="'+Fi(l.href)+'"]');if(d)return a.instance=d,Ne(d),d;var m=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(n.ownerDocument||n).createElement("style"),Ne(d),Xe(d,"style",m),Ic(d,l.precedence,n),a.instance=d;case"stylesheet":m=pa(l.href);var y=n.querySelector(Io(m));if(y)return a.state.loading|=4,a.instance=y,Ne(y),y;d=lv(l),(m=Xi.get(m))&&Rf(d,m),y=(n.ownerDocument||n).createElement("link"),Ne(y);var x=y;return x._p=new Promise(function(A,k){x.onload=A,x.onerror=k}),Xe(y,"link",d),a.state.loading|=4,Ic(y,l.precedence,n),a.instance=y;case"script":return y=ma(l.src),(m=n.querySelector(Ho(y)))?(a.instance=m,Ne(m),m):(d=l,(m=Xi.get(y))&&(d=p({},l),Lf(d,m)),n=n.ownerDocument||n,m=n.createElement("script"),Ne(m),Xe(m,"link",d),n.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,Ic(d,l.precedence,n));return a.instance}function Ic(n,a,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=d.length?d[d.length-1]:null,y=m,x=0;x<d.length;x++){var A=d[x];if(A.dataset.precedence===a)y=A;else if(y!==m)break}y?y.parentNode.insertBefore(n,y.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(n,a.firstChild))}function Rf(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function Lf(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var Hc=null;function hv(n,a,l){if(Hc===null){var d=new Map,m=Hc=new Map;m.set(l,d)}else m=Hc,d=m.get(l),d||(d=new Map,m.set(l,d));if(d.has(n))return d;for(d.set(n,null),l=l.getElementsByTagName(n),m=0;m<l.length;m++){var y=l[m];if(!(y[io]||y[He]||n==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var x=y.getAttribute(a)||"";x=n+x;var A=d.get(x);A?A.push(y):d.set(x,[y])}}return d}function uv(n,a,l){n=n.ownerDocument||n,n.head.insertBefore(l,a==="title"?n.querySelector("head > title"):null)}function _1(n,a,l){if(l===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function dv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function S1(n,a,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=pa(d.href),y=a.querySelector(Io(m));if(y){a=y._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(n.count++,n=Uc.bind(n),a.then(n,n)),l.state.loading|=4,l.instance=y,Ne(y);return}y=a.ownerDocument||a,d=lv(d),(m=Xi.get(m))&&Rf(d,m),y=y.createElement("link"),Ne(y);var x=y;x._p=new Promise(function(A,k){x.onload=A,x.onerror=k}),Xe(y,"link",d),l.instance=y}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=Uc.bind(n),a.addEventListener("load",l),a.addEventListener("error",l))}}var Pf=0;function x1(n,a){return n.stylesheets&&n.count===0&&Vc(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var d=setTimeout(function(){if(n.stylesheets&&Vc(n,n.stylesheets),n.unsuspend){var y=n.unsuspend;n.unsuspend=null,y()}},6e4+a);0<n.imgBytes&&Pf===0&&(Pf=62500*i1());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Vc(n,n.stylesheets),n.unsuspend)){var y=n.unsuspend;n.unsuspend=null,y()}},(n.imgBytes>Pf?50:800)+a);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(d),clearTimeout(m)}}:null}function Uc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Gc=null;function Vc(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Gc=new Map,a.forEach(w1,n),Gc=null,Uc.call(n))}function w1(n,a){if(!(a.state.loading&4)){var l=Gc.get(n);if(l)var d=l.get(null);else{l=new Map,Gc.set(n,l);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var x=m[y];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(l.set(x.dataset.precedence,x),d=x)}d&&l.set(null,d)}m=a.instance,x=m.getAttribute("data-precedence"),y=l.get(x)||d,y===d&&l.set(null,m),l.set(x,m),this.count++,d=Uc.bind(this),m.addEventListener("load",d),m.addEventListener("error",d),y?y.parentNode.insertBefore(m,y.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),a.state.loading|=4}}var Uo={$$typeof:E,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function C1(n,a,l,d,m,y,x,A,k){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Du(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Du(0),this.hiddenUpdates=Du(null),this.identifierPrefix=d,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function fv(n,a,l,d,m,y,x,A,k,U,W,Z){return n=new C1(n,a,l,x,k,U,W,Z,A),a=1,y===!0&&(a|=24),y=Ai(3,null,null,a),n.current=y,y.stateNode=n,a=dd(),a.refCount++,n.pooledCache=a,a.refCount++,y.memoizedState={element:d,isDehydrated:l,cache:a},md(y),n}function gv(n){return n?(n=qr,n):qr}function pv(n,a,l,d,m,y){m=gv(m),d.context===null?d.context=m:d.pendingContext=m,d=wn(a),d.payload={element:l},y=y===void 0?null:y,y!==null&&(d.callback=y),l=Cn(n,d,a),l!==null&&(fi(l,n,a),_o(l,n,a))}function mv(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function Bf(n,a){mv(n,a),(n=n.alternate)&&mv(n,a)}function yv(n){if(n.tag===13||n.tag===31){var a=er(n,67108864);a!==null&&fi(a,n,67108864),Bf(n,67108864)}}function vv(n){if(n.tag===13||n.tag===31){var a=Oi();a=Mu(a);var l=er(n,a);l!==null&&fi(l,n,a),Bf(n,a)}}var Xc=!0;function A1(n,a,l,d){var m=L.T;L.T=null;var y=I.p;try{I.p=2,Nf(n,a,l,d)}finally{I.p=y,L.T=m}}function T1(n,a,l,d){var m=L.T;L.T=null;var y=I.p;try{I.p=8,Nf(n,a,l,d)}finally{I.p=y,L.T=m}}function Nf(n,a,l,d){if(Xc){var m=Ff(d);if(m===null)xf(n,a,d,Yc,l),_v(n,d);else if(D1(m,n,a,l,d))d.stopPropagation();else if(_v(n,d),a&4&&-1<E1.indexOf(n)){for(;m!==null;){var y=Nr(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var x=$n(y.pendingLanes);if(x!==0){var A=y;for(A.pendingLanes|=2,A.entangledLanes|=2;x;){var k=1<<31-wi(x);A.entanglements[1]|=k,x&=~k}vs(y),(Kt&6)===0&&(Dc=ti()+500,No(0))}}break;case 31:case 13:A=er(y,2),A!==null&&fi(A,y,2),Oc(),Bf(y,2)}if(y=Ff(d),y===null&&xf(n,a,d,Yc,l),y===m)break;m=y}m!==null&&d.stopPropagation()}else xf(n,a,d,null,l)}}function Ff(n){return n=ju(n),jf(n)}var Yc=null;function jf(n){if(Yc=null,n=Br(n),n!==null){var a=r(n);if(a===null)n=null;else{var l=a.tag;if(l===13){if(n=o(a),n!==null)return n;n=null}else if(l===31){if(n=c(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Yc=n,null}function bv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Eu()){case Bl:return 2;case ts:return 8;case es:case gs:return 32;case Lr:return 268435456;default:return 32}default:return 32}}var zf=!1,Bn=null,Nn=null,Fn=null,Go=new Map,Vo=new Map,jn=[],E1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _v(n,a){switch(n){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Go.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vo.delete(a.pointerId)}}function Xo(n,a,l,d,m,y){return n===null||n.nativeEvent!==y?(n={blockedOn:a,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[m]},a!==null&&(a=Nr(a),a!==null&&yv(a)),n):(n.eventSystemFlags|=d,a=n.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),n)}function D1(n,a,l,d,m){switch(a){case"focusin":return Bn=Xo(Bn,n,a,l,d,m),!0;case"dragenter":return Nn=Xo(Nn,n,a,l,d,m),!0;case"mouseover":return Fn=Xo(Fn,n,a,l,d,m),!0;case"pointerover":var y=m.pointerId;return Go.set(y,Xo(Go.get(y)||null,n,a,l,d,m)),!0;case"gotpointercapture":return y=m.pointerId,Vo.set(y,Xo(Vo.get(y)||null,n,a,l,d,m)),!0}return!1}function Sv(n){var a=Br(n.target);if(a!==null){var l=r(a);if(l!==null){if(a=l.tag,a===13){if(a=o(l),a!==null){n.blockedOn=a,Bp(n.priority,function(){vv(l)});return}}else if(a===31){if(a=c(l),a!==null){n.blockedOn=a,Bp(n.priority,function(){vv(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function qc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=Ff(n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Fu=d,l.target.dispatchEvent(d),Fu=null}else return a=Nr(l),a!==null&&yv(a),n.blockedOn=l,!1;a.shift()}return!0}function xv(n,a,l){qc(n)&&l.delete(a)}function M1(){zf=!1,Bn!==null&&qc(Bn)&&(Bn=null),Nn!==null&&qc(Nn)&&(Nn=null),Fn!==null&&qc(Fn)&&(Fn=null),Go.forEach(xv),Vo.forEach(xv)}function Wc(n,a){n.blockedOn===a&&(n.blockedOn=null,zf||(zf=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,M1)))}var Kc=null;function wv(n){Kc!==n&&(Kc=n,u.unstable_scheduleCallback(u.unstable_NormalPriority,function(){Kc===n&&(Kc=null);for(var a=0;a<n.length;a+=3){var l=n[a],d=n[a+1],m=n[a+2];if(typeof d!="function"){if(jf(d||l)===null)continue;break}var y=Nr(l);y!==null&&(n.splice(a,3),a-=3,Nd(y,{pending:!0,data:m,method:l.method,action:d},d,m))}}))}function ya(n){function a(k){return Wc(k,n)}Bn!==null&&Wc(Bn,n),Nn!==null&&Wc(Nn,n),Fn!==null&&Wc(Fn,n),Go.forEach(a),Vo.forEach(a);for(var l=0;l<jn.length;l++){var d=jn[l];d.blockedOn===n&&(d.blockedOn=null)}for(;0<jn.length&&(l=jn[0],l.blockedOn===null);)Sv(l),l.blockedOn===null&&jn.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var m=l[d],y=l[d+1],x=m[oi]||null;if(typeof y=="function")x||wv(l);else if(x){var A=null;if(y&&y.hasAttribute("formAction")){if(m=y,x=y[oi]||null)A=x.formAction;else if(jf(m)!==null)continue}else A=x.action;typeof A=="function"?l[d+1]=A:(l.splice(d,3),d-=3),wv(l)}}}function Cv(){function n(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(x){return m=x})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function If(n){this._internalRoot=n}$c.prototype.render=If.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,d=Oi();pv(l,d,n,a,null,null)},$c.prototype.unmount=If.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;pv(n.current,2,null,n,null,null),Oc(),a[Pr]=null}};function $c(n){this._internalRoot=n}$c.prototype.unstable_scheduleHydration=function(n){if(n){var a=Pp();n={blockedOn:null,target:n,priority:a};for(var l=0;l<jn.length&&a!==0&&a<jn[l].priority;l++);jn.splice(l,0,n),l===0&&Sv(n)}};var Av=t.version;if(Av!=="19.2.0")throw Error(i(527,Av,"19.2.0"));I.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(a),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var O1={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{Ja=Qc.inject(O1),xi=Qc}catch{}}return qo.createRoot=function(n,a){if(!s(n))throw Error(i(299));var l=!1,d="",m=R0,y=L0,x=P0;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=fv(n,1,!1,null,null,l,d,null,m,y,x,Cv),n[Pr]=a.current,Sf(n),new If(a)},qo.hydrateRoot=function(n,a,l){if(!s(n))throw Error(i(299));var d=!1,m="",y=R0,x=L0,A=P0,k=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(k=l.formState)),a=fv(n,1,!0,a,l??null,d,m,k,y,x,A,Cv),a.context=gv(null),l=a.current,d=Oi(),d=Mu(d),m=wn(d),m.callback=null,Cn(l,m,d),l=d,a.current.lanes=l,eo(a,l),vs(a),n[Pr]=a.current,Sf(n),new $c(a)},qo.version="19.2.0",qo}var Fv;function H1(){if(Fv)return Vf.exports;Fv=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(t){console.error(t)}}return u(),Vf.exports=I1(),Vf.exports}var U1=H1();const ii=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),yg=[.001,0,0,.001,0,0],Wf=1.35,Ri={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Es={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ul="pdfjs_internal_editor_",kt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ut={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},f_={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ye={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},rl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},xe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Sa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},wl={ERRORS:0,WARNINGS:1,INFOS:5},ja={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Zc={moveTo:0,lineTo:1,curveTo:2,closePath:3},g_={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let nu=wl.WARNINGS;function G1(u){Number.isInteger(u)&&(nu=u)}function V1(){return nu}function ru(u){nu>=wl.INFOS&&console.info(`Info: ${u}`)}function Rt(u){nu>=wl.WARNINGS&&console.warn(`Warning: ${u}`)}function ae(u){throw new Error(u)}function Vt(u,t){u||ae(t)}function X1(u){switch(u?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Gg(u,t=null,e=null){if(!u)return null;if(e&&typeof u=="string"&&(e.addDefaultProtocol&&u.startsWith("www.")&&u.match(/\./g)?.length>=2&&(u=`http://${u}`),e.tryConvertEncoding))try{u=$1(u)}catch{}const i=t?URL.parse(u,t):URL.parse(u);return X1(i)?i:null}function Vg(u,t,e=!1){const i=URL.parse(u);return i?(i.hash=t,i.href):e&&Gg(u,"http://example.com")?u.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Nt(u,t,e,i=!1){return Object.defineProperty(u,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Or=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class jv extends Or{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Kf extends Or{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ih extends Or{constructor(t){super(t,"InvalidPDFException")}}class dl extends Or{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class Y1 extends Or{constructor(t){super(t,"FormatError")}}class an extends Or{constructor(t){super(t,"AbortException")}}function p_(u){(typeof u!="object"||u?.length===void 0)&&ae("Invalid argument for bytesToString");const t=u.length,e=8192;if(t<e)return String.fromCharCode.apply(null,u);const i=[];for(let s=0;s<t;s+=e){const r=Math.min(s+e,t),o=u.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Cl(u){typeof u!="string"&&ae("Invalid argument for stringToBytes");const t=u.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=u.charCodeAt(i)&255;return e}function q1(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function W1(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function K1(){try{return new Function(""),!0}catch{return!1}}class Ie{static get isLittleEndian(){return Nt(this,"isLittleEndian",W1())}static get isEvalSupported(){return Nt(this,"isEvalSupported",K1())}static get isOffscreenCanvasSupported(){return Nt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Nt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Nt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Nt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const $f=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class ut{static makeHexColor(t,e,i){return`#${$f[t]}${$f[e]}${$f[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const s=t[i],r=t[i+1];t[i]=s*e[0]+r*e[2]+e[4],t[i+1]=s*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const s=e[0],r=e[1],o=e[2],c=e[3],h=e[4],f=e[5];for(let g=0;g<6;g+=2){const p=t[i+g],v=t[i+g+1];t[i+g]=p*s+v*o+h,t[i+g+1]=p*r+v*c+f}}static applyInverseTransform(t,e){const i=t[0],s=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-i*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,i){const s=e[0],r=e[1],o=e[2],c=e[3],h=e[4],f=e[5],g=t[0],p=t[1],v=t[2],b=t[3];let S=s*g+h,_=S,C=s*v+h,w=C,T=c*p+f,E=T,D=c*b+f,M=D;if(r!==0||o!==0){const O=r*g,R=r*v,j=o*p,G=o*b;S+=j,w+=j,C+=G,_+=G,T+=O,M+=O,D+=R,E+=R}i[0]=Math.min(i[0],S,C,_,w),i[1]=Math.min(i[1],T,D,E,M),i[2]=Math.max(i[2],S,C,_,w),i[3]=Math.max(i[3],T,D,E,M)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],s=t[1],r=t[2],o=t[3],c=i**2+s**2,h=i*r+s*o,f=r**2+o**2,g=(c+f)/2,p=Math.sqrt(g**2-(c*f-h**2));e[0]=Math.sqrt(g+p||1),e[1]=Math.sqrt(g-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>o?null:[i,r,s,o]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,s,r){r[0]=Math.min(r[0],t,i),r[1]=Math.min(r[1],e,s),r[2]=Math.max(r[2],t,i),r[3]=Math.max(r[3],e,s)}static#t(t,e,i,s,r,o,c,h,f,g){if(f<=0||f>=1)return;const p=1-f,v=f*f,b=v*f,S=p*(p*(p*t+3*f*e)+3*v*i)+b*s,_=p*(p*(p*r+3*f*o)+3*v*c)+b*h;g[0]=Math.min(g[0],S),g[1]=Math.min(g[1],_),g[2]=Math.max(g[2],S),g[3]=Math.max(g[3],_)}static#e(t,e,i,s,r,o,c,h,f,g,p,v){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,i,s,r,o,c,h,-p/g,v);return}const b=g**2-4*p*f;if(b<0)return;const S=Math.sqrt(b),_=2*f;this.#t(t,e,i,s,r,o,c,h,(-g+S)/_,v),this.#t(t,e,i,s,r,o,c,h,(-g-S)/_,v)}static bezierBoundingBox(t,e,i,s,r,o,c,h,f){f[0]=Math.min(f[0],t,c),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,c),f[3]=Math.max(f[3],e,h),this.#e(t,i,r,c,e,s,o,h,3*(-t+3*(i-r)+c),6*(t-2*i+r),3*(i-t),f),this.#e(t,i,r,c,e,s,o,h,3*(-e+3*(s-o)+h),6*(e-2*s+o),3*(s-e),f)}}function $1(u){return decodeURIComponent(escape(u))}let Qf=null,zv=null;function m_(u){return Qf||(Qf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zv=new Map([["","t"]])),u.replaceAll(Qf,(t,e,i)=>e?e.normalize("NFKC"):zv.get(i))}function Xg(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const u=new Uint8Array(32);return crypto.getRandomValues(u),p_(u)}const Yg="pdfjs_internal_id_";function Q1(u,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,s,...r]=e;if(!u(i)&&!Number.isInteger(i)||!t(s))return!1;const o=r.length;let c=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const h of r)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Qe(u,t,e){return Math.min(Math.max(u,t),e)}function y_(u){return Uint8Array.prototype.toBase64?u.toBase64():btoa(p_(u))}function Z1(u){return Uint8Array.fromBase64?Uint8Array.fromBase64(u):Cl(atob(u))}typeof Promise.try!="function"&&(Promise.try=function(u,...t){return new Promise(e=>{e(u(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(u){return u.reduce((t,e)=>t+e,0)});class fl{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(r){if(!r)return;let o=null;const c=r.name;if(c==="#text")o=r.value;else if(fl.shouldBuildText(c))r?.attributes?.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&e.push({str:o}),!!r.children)for(const h of r.children)s(h)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class qg{static setupStorage(t,e,i,s,r){const o=s.getValue(e,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),r==="print")break;t.addEventListener("input",c=>{s.setValue(e,{value:c.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?t.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",c=>{s.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),r==="print")break;t.addEventListener("input",c=>{s.setValue(e,{value:c.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const c of i.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:r}){const{attributes:o}=e,c=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[h,f]of Object.entries(o))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}c&&r.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,r=t.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const c=r!=="richText",h=t.div;if(h.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=p}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);o.append(p),c&&fl.shouldBuildText(s.name)&&f.push(p)}return{textDivs:f}}const g=[[s,-1,o]];for(;g.length>0;){const[p,v,b]=g.at(-1);if(v+1===p.children.length){g.pop();continue}const S=p.children[++g.at(-1)[1]];if(S===null)continue;const{name:_}=S;if(_==="#text"){const w=document.createTextNode(S.value);f.push(w),b.append(w);continue}const C=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,_):document.createElement(_);if(b.append(C),S.attributes&&this.setAttributes({html:C,element:S,storage:e,intent:r,linkService:i}),S.children?.length>0)g.push([S,-1,C]);else if(S.value){const w=document.createTextNode(S.value);c&&fl.shouldBuildText(_)&&f.push(w),C.append(w)}}for(const p of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Zs="http://www.w3.org/2000/svg";class Tr{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Ua(u,t="text"){if(el(u,document.baseURI)){const e=await fetch(u);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",u,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Al{constructor({viewBox:t,userUnit:e,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,p,v,b;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,p=0,v=0,b=1;break;case 90:g=0,p=1,v=1,b=0;break;case 270:g=0,p=-1,v=-1,b=0;break;case 0:g=1,p=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,b=-b);let S,_,C,w;g===0?(S=Math.abs(f-t[1])*i+r,_=Math.abs(h-t[0])*i+o,C=(t[3]-t[1])*i,w=(t[2]-t[0])*i):(S=Math.abs(h-t[0])*i+r,_=Math.abs(f-t[1])*i+o,C=(t[2]-t[0])*i,w=(t[3]-t[1])*i),this.transform=[g*i,p*i,v*i,b*i,S-g*i*h-v*i*f,_-p*i*h-b*i*f],this.width=C,this.height=w}get rawDims(){const t=this.viewBox;return Nt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Al({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(t,e){const i=[t,e];return ut.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];ut.applyTransform(e,this.transform);const i=[t[2],t[3]];return ut.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return ut.applyInverseTransform(i,this.transform),i}}class au extends Or{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Tl(u){const t=u.length;let e=0;for(;e<t&&u[e].trim()==="";)e++;return u.substring(e,e+5).toLowerCase()==="data:"}function ou(u){return typeof u=="string"&&/\.pdf$/i.test(u)}function v_(u){return[u]=u.split(/[#?]/,1),u.substring(u.lastIndexOf("/")+1)}function b_(u,t="document.pdf"){if(typeof u!="string")return t;if(Tl(u))return Rt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(u);if(!i)return t;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},r=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(r.test(o))return s(o);if(i.searchParams.size>0){const c=Array.from(i.searchParams.values()).reverse();for(const f of c)if(r.test(f))return s(f);const h=Array.from(i.searchParams.keys()).reverse();for(const f of h)if(r.test(f))return s(f)}if(i.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(h)return s(h[0])}return t}class Iv{started=Object.create(null);times=[];time(t){t in this.started&&Rt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Rt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-s}ms
`);return t.join("")}}function el(u,t){const e=t?URL.parse(u,t):URL.parse(u);return e?.protocol==="http:"||e?.protocol==="https:"}function Bi(u){u.preventDefault()}function me(u){u.preventDefault(),u.stopPropagation()}function J1(u){console.log("Deprecated API usage: "+u)}class Hh{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(o+=g,c+=p):f==="+"&&(o-=g,c-=p),new Date(Date.UTC(i,s,r,o,c,h))}}function __(u,{scale:t=1,rotation:e=0}){const{width:i,height:s}=u.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Al({viewBox:r,userUnit:1,scale:t,rotation:e})}function Ga(u){if(u.startsWith("#")){const t=parseInt(u.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return u.startsWith("rgb(")?u.slice(4,-1).split(",").map(t=>parseInt(t)):u.startsWith("rgba(")?u.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Rt(`Not a valid color format: "${u}"`),[0,0,0])}function tC(u){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of u.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;u.set(e,Ga(i))}t.remove()}function ge(u){const{a:t,b:e,c:i,d:s,e:r,f:o}=u.getTransform();return[t,e,i,s,r,o]}function Ss(u){const{a:t,b:e,c:i,d:s,e:r,f:o}=u.getTransform().invertSelf();return[t,e,i,s,r,o]}function Xn(u,t,e=!1,i=!0){if(t instanceof Al){const{pageWidth:s,pageHeight:r}=t.rawDims,{style:o}=u,c=Ie.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${r}px`,g=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,p=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(o.width=g,o.height=p):(o.width=p,o.height=g)}i&&u.setAttribute("data-main-rotation",t.rotation)}class fs{constructor(){const{pixelRatio:t}=fs;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,s,r=-1){let o=1/0,c=1/0,h=1/0;i=fs.capPixels(i,r),i>0&&(o=Math.sqrt(i/(t*e))),s!==-1&&(c=s/t,h=s/e);const f=Math.min(o,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Uh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class eC{static get isDarkMode(){return Nt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class S_{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),Nt(this,"commentForegroundColor",Ga(i))}}function x_(u,t,e,i){i=Math.min(Math.max(i??1,0),1);const s=255*(1-i);return u=Math.round(u*i+s),t=Math.round(t*i+s),e=Math.round(e*i+s),[u,t,e]}function Hv(u,t){const e=u[0]/255,i=u[1]/255,s=u[2]/255,r=Math.max(e,i,s),o=Math.min(e,i,s),c=(r+o)/2;if(r===o)t[0]=t[1]=0;else{const h=r-o;switch(t[1]=c<.5?h/(r+o):h/(2-r-o),r){case e:t[0]=((i-s)/h+(i<s?6:0))*60;break;case i:t[0]=((s-e)/h+2)*60;break;case s:t[0]=((e-i)/h+4)*60;break}}t[2]=c}function vg(u,t){const e=u[0],i=u[1],s=u[2],r=(1-Math.abs(2*s-1))*i,o=r*(1-Math.abs(e/60%2-1)),c=s-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+c,t[1]=o+c,t[2]=c;break;case 1:t[0]=o+c,t[1]=r+c,t[2]=c;break;case 2:t[0]=c,t[1]=r+c,t[2]=o+c;break;case 3:t[0]=c,t[1]=o+c,t[2]=r+c;break;case 4:t[0]=o+c,t[1]=c,t[2]=r+c;break;case 5:case 6:t[0]=r+c,t[1]=c,t[2]=o+c;break}}function Uv(u){return u<=.03928?u/12.92:((u+.055)/1.055)**2.4}function Gv(u,t,e){vg(u,e),e.map(Uv);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];vg(t,e),e.map(Uv);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const Vv=new Map;function w_(u,t){const e=u[0]+u[1]*256+u[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=Vv.get(e);if(i)return i;const s=new Float32Array(9),r=s.subarray(0,3),o=s.subarray(3,6);Hv(u,o);const c=s.subarray(6,9);Hv(t,c);const h=c[2]<.5,f=h?12:4.5;if(o[2]=h?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Gv(o,c,r)<f){let g,p;h?(g=o[2],p=1):(g=0,p=o[2]);const v=.005;for(;p-g>v;){const b=o[2]=(g+p)/2;h===Gv(o,c,r)<f?g=b:p=b}o[2]=h?p:g}return vg(o,r),i=ut.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),Vv.set(e,i),i}function Wg({html:u,dir:t,className:e},i){const s=document.createDocumentFragment();if(typeof u=="string"){const r=document.createElement("p");r.dir=t||"auto";const o=u.split(/(?:\r\n?|\n)/);for(let c=0,h=o.length;c<h;++c){const f=o[c];r.append(document.createTextNode(f)),c<h-1&&r.append(document.createElement("br"))}s.append(r)}else qg.render({xfaHtml:u,div:s,intent:"richText"});s.firstChild.classList.add("richText",e),i.append(s)}class al{#t=null;#e=null;#s;#i=null;#a=null;#n=null;#r=null;#o=null;static#c=null;constructor(t){this.#s=t,al.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#s._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Bi,{signal:e}),t.addEventListener("pointerdown",al.#l,{signal:e}));const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const s=this.#s.toolbarPosition;if(s){const{style:r}=t,o=this.#s._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#s._focusEventsAllowed=!1,me(t)}#u(t){this.#s._focusEventsAllowed=!0,me(t)}#f(t){const e=this.#s._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Bi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#n?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#s,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",al.#c[t]),this.#f(i)&&i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#n)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const s=this.#r=this.#m;e?(this.#i.insertBefore(i,e),this.#i.insertBefore(s,e)):this.#i.append(i,s),this.#n=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#s);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#n?.removeToolbarCommentButton(),this.#n=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,i){const s=this.#i.querySelector(i);s&&t==="comment"&&this.addComment(e,s)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class iC{#t=null;#e=null;#s;constructor(t){this.#s=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#s._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Bi,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#s.hasCommentManager()&&this.#n("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#s.commentSelection("floating_button")}),this.#n("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#s.highlightSelection("floating_button")}),t}#a(t,e){let i=0,s=0;for(const r of t){const o=r.y+r.height;if(o<i)continue;const c=r.x+(e?r.width:0);if(o>i){s=c,i=o;continue}e?c>s&&(s=c):c<s&&(s=c)}return[e?1-s:s,i]}show(t,e,i){const[s,r]=this.#a(e,i),{style:o}=this.#e||=this.#i();t.append(this.#e),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(t,e,i,s){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const o=document.createElement("span");r.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const c=this.#s._signal;c instanceof AbortSignal&&!c.aborted&&(r.addEventListener("contextmenu",Bi,{signal:c}),r.addEventListener("click",s,{signal:c})),this.#t.append(r)}}function C_(u,t,e){for(const i of e)t.addEventListener(i,u[i].bind(u))}class sC{#t=0;get id(){return`${ul}${this.#t++}`}}class Kg{#t=Xg();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Nt(this,"_isSVGFittingCanvas",r)}async#i(t,e){this.#s||=new Map;let i=this.#s.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(i.url=e,s=await Ua(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const r=Kg._isSVGFittingCanvas,o=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{i.bitmap=c,i.isSvg=!0,f()},o.onload=async()=>{const p=i.svgUrl=o.result;c.src=await r?`${p}#svgView(preserveAspectRatio(none))`:p},c.onerror=o.onerror=g});o.readAsDataURL(s),await h}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){Rt(s),i=null}return this.#s.set(t,i),i&&this.#s.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:s,type:r}=t;return this.#i(`${e}_${i}_${s}_${r}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#s||=new Map;let i=this.#s.get(t);if(i?.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,i),this.#s.set(i.id,i),i}getSvgUrl(t){const e=this.#s.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=s.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class nC{#t=[];#e=!1;#s;#i=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:e,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(s&&t(),this.#e)return;const h={cmd:t,undo:e,post:i,type:r};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(o&&this.#t[this.#i].type===r){c&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#s?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class El{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ie.platform;for(const[i,s,r={}]of t)for(const o of i){const c=o.startsWith("mac+");e&&c?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!e&&!c&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:c=null}}=i;c&&!c(t,e)||(s.bind(t,...o,e)(),r||me(e))}}class $g{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return tC(t),Nt(this,"_colors",t)}convert(t){const e=Ga(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((r,o)=>r===e[o]))return $g._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?ut.makeHexColor(...e):t}}class on{#t=new AbortController;#e=null;#s=null;#i=new Map;#a=new Map;#n=null;#r=null;#o=null;#c=new nC;#l=null;#d=null;#u=null;#f=0;#m=new Set;#g=null;#h=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#A=null;#w=null;#_=null;#E=null;#x=!1;#C=null;#O=new sC;#D=!1;#M=!1;#F=!1;#R=null;#P=null;#j=null;#B=null;#V=null;#T=kt.NONE;#S=new Set;#L=null;#z=null;#H=null;#q=null;#Y=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#U=[0,0];#N=null;#X=null;#Z=null;#J=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=on.prototype,e=o=>o.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Nt(this,"_keyboardManager",new El([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#X.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,i,s,r,o,c,h,f,g,p,v,b,S,_,C){const w=this._signal=this.#t.signal;this.#X=t,this.#Z=e,this.#J=i,this.#n=s,this.#l=r,this.#z=o,this.#Y=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:w}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),c._on("setpreference",this.onSetPreference.bind(this),{signal:w}),c._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:w}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:w}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:w}),this.#lt(),this.#dt(),this.#et(),this.#r=h.annotationStorage,this.#A=h.filterFactory,this.#H=f,this.#E=g||null,this.#y=p,this.#b=v,this.#v=b,this.#V=S||null,this.viewParameters={realScale:Tr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=C!==!1,r?.setSidebarUiManager(this)}destroy(){this.#I?.resolve(),this.#I=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#S.clear(),this.#c.destroy(),this.#n?.destroy(),this.#l?.destroy(),this.#z?.destroy(),this.#C?.hide(),this.#C=null,this.#j?.destroy(),this.#j=null,this.#s=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#N&&(clearTimeout(this.#N),this.#N=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Nt(this,"hcmFilter",this.#H?this.#A.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return Nt(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return Nt(this,"_highlightColors",this.#E?new Map(this.#E.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Nt(this,"highlightColors",null);const e=new Map,i=!!this.#H;for(const[s,r]of t){const o=s.endsWith("_HCM");if(i&&o){e.set(s.replace("_HCM",""),r);continue}!i&&!o&&e.set(s,r)}return Nt(this,"highlightColors",e)}get highlightColorNames(){return Nt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#j=t}editAltText(t,e=!1){this.#n?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,s){this.#l?.showDialog(this,t,e,i,s)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),s=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",s),e())};this._eventBus.on("editorsrendered",s),await i}getSignature(t){this.#z?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#z}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#X.focus()}findParent(t,e){for(const i of this.#a.values()){const{x:s,y:r,width:o,height:c}=i.div.getBoundingClientRect();if(t>=s&&t<=s+o&&e>=r&&e<=r+c)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Tr.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#a.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:c}=i,h=i.toString(),g=this.#Q(i).closest(".textLayer"),p=this.getSelectionBoxes(g);if(!p)return;i.empty();const v=this.#tt(g),b=this.#T===kt.NONE,S=()=>{const _=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:c,text:h});b&&this.showAllEditors("highlight",!0,!0),e&&_?.editComment()};if(b){this.switchToMode(kt.HIGHLIGHT,S);return}S()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#C||=new iC(this),this.#C.show(i,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${ul}${t}`,i=this.#r.getRawValue(e);return i&&this.#r.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#C?.hide(),this.#L=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#L)return;const s=this.#Q(t).closest(".textLayer");if(!s){this.#L&&(this.#C?.hide(),this.#L=null,this.#k({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#L=e,this.#k({hasSelectedText:!0}),!(this.#T!==kt.HIGHLIGHT&&this.#T!==kt.NONE)&&(this.#T===kt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#T===kt.HIGHLIGHT?this.#tt(s):null;if(r?.toggleDrawing(),this.#M){const o=new AbortController,c=this.combinedSignal(o),h=f=>{f.type==="pointerup"&&f.button!==0||(o.abort(),r?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else r?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===kt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ht(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#S)if(e.div.contains(t)){this.#P=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#P)return;const[t,e]=this.#P;this.#P=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#R)return;this.#R=new AbortController;const t=this.combinedSignal(this.#R);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ut(){this.#R?.abort(),this.#R=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#st(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ut(),this.#st()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#S){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const o of this.#h)if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Rt(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const h of i){const f=await s.deserialize(h);if(!f)return;r.push(f)}const o=()=>{for(const h of r)this.#nt(h);this.#rt(r)},c=()=>{for(const h of r)h.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(r){Rt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==kt.NONE&&!this.isEditorHandlingKeyboard&&on._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#k(t){Object.entries(t).some(([i,s])=>this.#W[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#T===kt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Ut.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#k({isEditing:this.#T!==kt.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ht(),this.#st(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#G(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#D?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,s=!1,r=!1){if(this.#T!==t&&!(this.#I&&(await this.#I.promise,!this.#I))){if(this.#I=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#T===kt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===kt.NONE){this.setEditingState(!1),this.#gt();for(const o of this.#i.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#I.resolve();return}for(const o of this.#i.values())o.addStandaloneCommentButton();t===kt.SIGNATURE&&await this.#z?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const o of this.#a.values())o.updateMode(t);if(t===kt.POPUP){this.#s||=await this.#Y.getAnnotationsByType(new Set(this.#h.map(h=>h._editorType)));const o=new Set,c=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:g,deleted:p}=h;f&&o.add(f),g&&!p&&c.push(h.getData())}for(const h of this.#s){const{id:f,popupRef:g,contentsObj:p}=h;g&&p?.str&&!o.has(f)&&!this.#m.has(f)&&c.push(h)}this.#l?.showSidebar(c)}if(!e){i&&this.addNewEditorFromKeyboard(),this.#I.resolve();return}for(const o of this.#i.values())o.uid===e?(this.setSelected(o),r?o.editComment():s?o.enterInEditMode():o.focus()):o.unselect();this.#I.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case Ut.CREATE:this.currentLayer.addNewEditor(e);return;case Ut.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#S)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const r of this.#i.values())r.editorType===t&&r.show(e);(this.#q?.get(Ut.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#G([[Ut.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#F!==t){this.#F=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#D){this.#D=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#gt(){if(this.unselectAll(),this.#D){this.#D=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#S);return t}updateUI(t){this.#pt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#S.has(t)){this.#S.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#S.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#S)e!==t&&e.unselect();this.#S.clear(),this.#S.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#S.has(t)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(t){t.unselect(),this.#S.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#k({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(t){this.#c.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}cleanUndoStack(t){this.#c.cleanType(t)}#$(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#S],i=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},s=()=>{for(const r of e)this.#nt(r)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#S)e.unselect();this.#S.clear();for(const e of t)e.isEmpty()||(this.#S.add(e),e.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#S)t.commit();this.#rt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==kt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#S)t.unselect();this.#S.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#U[0]+=t,this.#U[1]+=e;const[s,r]=this.#U,o=[...this.#S],c=1e3;this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.#N=null,this.#U[0]=this.#U[1]=0,this.addCommands({cmd:()=>{for(const h of o)this.#i.has(h.id)&&(h.translateInPage(s,r),h.translationDone())},undo:()=>{for(const h of o)this.#i.has(h.id)&&(h.translateInPage(-s,-r),h.translationDone())},mustExec:!1})},c);for(const h of o)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#S)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:s,y:r,pageIndex:o},c]of t)c.newX=s,c.newY=r,c.newPageIndex=o,e||=s!==c.savedX||r!==c.savedY||o!==c.savedPageIndex;if(!e)return!1;const i=(s,r,o,c)=>{if(this.#i.has(s.id)){const h=this.#a.get(c);h?s._setParentAndPosition(h,r,o):(s.pageIndex=c,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:c}]of t)i(s,r,o,c)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:c}]of t)i(s,r,o,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const i of this.#g.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==kt.NONE}get imageManager(){return Nt(this,"imageManager",new Kg)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(f,g,p,v)=>({x:(g-s)/o,y:1-(f+p-i)/r,width:v/o,height:p/r});break;case"180":c=(f,g,p,v)=>({x:1-(f+p-i)/r,y:1-(g+v-s)/o,width:p/r,height:v/o});break;case"270":c=(f,g,p,v)=>({x:1-(g+v-s)/o,y:(f-i)/r,width:v/o,height:p/r});break;default:c=(f,g,p,v)=>({x:(f-i)/r,y:(g-s)/o,width:p/r,height:v/o});break}const h=[];for(let f=0,g=e.rangeCount;f<g;f++){const p=e.getRangeAt(f);if(!p.collapsed)for(const{x:v,y:b,width:S,height:_}of p.getClientRects())S===0||_===0||h.push(c(v,b,S,_))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#T===kt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const s=this.#B?.get(t);s&&(s.setCanvas(e,i),this.#B.delete(t))}addMissingCanvas(t,e){(this.#B||=new Map).set(t,e)}}class Cs{#t=null;#e=!1;#s=null;#i=null;#a=null;#n=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#u=t._uiManager.useNewAltTextFlow,Cs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Cs._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Cs.#f.missing),e.setAttribute("data-l10n-id",Cs.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",Bi,{signal:i}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#r=!0,s(r))},{signal:i}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Cs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(this.#l=i,this.#d=s),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#g())}toggle(t=!1){this.#s&&(!t&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#s.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#s?.remove(),this.#s=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#s;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Cs.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Cs.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const s=100,r=this.#c._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#a?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Jc{#t=null;#e=null;#s=!1;#i=null;#a=null;#n=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const s=this.#i.commentButtonColor;s&&(i.backgroundColor=s)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:s,y:r,width:o,height:c}=this.#i.parent.boundingClientRect;return[(t-s)/o,(e+i-r)/c]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=this.#i._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",Bi,{signal:i}),e&&(t.addEventListener("focusin",r=>{this.#i._focusEventsAllowed=!1,me(r)},{capture:!0,signal:i}),t.addEventListener("focusout",r=>{this.#i._focusEventsAllowed=!0,me(r)},{capture:!0,signal:i})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#s=!0,s(r))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,s;if(e)[i,s]=e;else{[i,s]=this.#i.commentButtonPosition;const{width:g,height:p,x:v,y:b}=this.#i;i=v+i*g,s=b+s*p}const r=this.#i.parent.boundingClientRect,{x:o,y:c,width:h,height:f}=r;this.#i._uiManager.editComment(this.#i,o+i*h,c+s*f,{...t,parentDimensions:r})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#s}),this.#s=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#n,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#n=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#n=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#n=null,this.#o=null,this.#i=null,this.#s=!1,this.#c=!1}}class Dl{#t;#e=!1;#s=null;#i;#a;#n;#r;#o=null;#c;#l=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:c}){this.#t=t,this.#s=i,this.#i=e,this.#a=s,this.#n=r,this.#r=o,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/fs.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,r=AbortSignal.any([this.#c,s.signal]),o=this.#t,c={capture:!0,signal:r,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(me(f),h(f))},c),o.addEventListener("pointerup",h,c),o.addEventListener("pointercancel",h,c);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#c,this.#u.signal]),r=this.#t,o={signal:s,capture:!1,passive:!1};r.addEventListener("touchmove",this.#m.bind(this),o);const c=this.#g.bind(this);r.addEventListener("touchend",c,o),r.addEventListener("touchcancel",c,o),o.capture=!0,r.addEventListener("pointerdown",me,o),r.addEventListener("pointermove",me,o),r.addEventListener("pointercancel",me,o),r.addEventListener("pointerup",me,o),this.#a?.()}if(me(t),t.touches.length!==2||this.#s?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;me(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:s,screenY:r}=e,{screenX:o,screenY:c}=i,h=this.#l,{touch0X:f,touch0Y:g,touch1X:p,touch1Y:v}=h,b=p-f,S=v-g,_=o-s,C=c-r,w=Math.hypot(_,C)||1,T=Math.hypot(b,S)||1;if(!this.#e&&Math.abs(T-w)<=Dl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=r,h.touch1X=o,h.touch1Y=c,!this.#e){this.#e=!0;return}const E=[(s+o)/2,(r+c)/2];this.#n?.(E,T,w)}#g(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#r?.()),this.#l&&(me(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class xt{#t=null;#e=null;#s=null;#i=null;#a=null;#n=!1;#r=null;#o="";#c=null;#l=null;#d=null;#u=null;#f=null;#m="";#g=!1;#h=null;#p=!1;#y=!1;#b=!1;#v=null;#A=0;#w=0;#_=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#C=xt._zIndex++;static _borderLineWidth=-1;static _colorManager=new $g;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=xt.prototype._resizeWithKeyboard,e=on.TRANSLATE_SMALL,i=on.TRANSLATE_BIG;return Nt(this,"_resizerKeyboardManager",new El([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],xt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Nt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new rC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(xt._l10n??=t,xt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),xt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);xt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ae("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(t){this.#x=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#N(),this.#u?.remove(),this.#u=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/r,this.y=(e+s)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s),this._onTranslated()}#O([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#h||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#h||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[s,r]}=this;if(this.x+=t/s,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[h,f]=this.getBaseTranslation();o+=h,c+=f;const{style:g}=i;g.left=`${(100*o).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}get _hasBeenResized(){return!!this.#h&&(this.#h[2]!==this.width||this.#h[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=xt,s=i/t,r=i/e;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,s]}=this;let{x:r,y:o,width:c,height:h}=this;if(c*=i,h*=s,r*=i,o*=s,this._mustFixPosition)switch(t){case 0:r=Qe(r,0,i-c),o=Qe(o,0,s-h);break;case 90:r=Qe(r,0,i-h),o=Qe(o,c,s);break;case 180:r=Qe(r,c,i),o=Qe(o,h,s);break;case 270:r=Qe(r,h,i),o=Qe(o,0,s-c);break}this.x=r/=i,this.y=o/=s;const[f,g]=this.getBaseTranslation();r+=f,o+=g,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#D(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return xt.#D(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return xt.#D(t,e,360-this.parentRotation)}#M(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#F(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#R.bind(this,i),{signal:e}),s.addEventListener("contextmenu",Bi,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#c)}#R(t,e){e.preventDefault();const{isMac:i}=Ie.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#s?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",me,{passive:!1,signal:o}),window.addEventListener("contextmenu",Bi,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#j()};window.addEventListener("pointerup",f,{signal:o}),window.addEventListener("blur",f,{signal:o})}#P(t,e,i,s){this.width=i,this.height=s,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#j(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=this.#d;this.#d=null;const r=this.x,o=this.y,c=this.width,h=this.height;r===t&&o===e&&c===i&&h===s||this.addCommands({cmd:this.#P.bind(this,r,o,c,h),undo:this.#P.bind(this,t,e,i,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,e){const[i,s]=this.parentDimensions,r=this.x,o=this.y,c=this.width,h=this.height,f=xt.MIN_SIZE/i,g=xt.MIN_SIZE/s,p=this.#M(this.rotation),v=(L,I)=>[p[0]*L+p[2]*I,p[1]*L+p[3]*I],b=this.#M(360-this.rotation),S=(L,I)=>[b[0]*L+b[2]*I,b[1]*L+b[3]*I];let _,C,w=!1,T=!1;switch(t){case"topLeft":w=!0,_=(L,I)=>[0,0],C=(L,I)=>[L,I];break;case"topMiddle":_=(L,I)=>[L/2,0],C=(L,I)=>[L/2,I];break;case"topRight":w=!0,_=(L,I)=>[L,0],C=(L,I)=>[0,I];break;case"middleRight":T=!0,_=(L,I)=>[L,I/2],C=(L,I)=>[0,I/2];break;case"bottomRight":w=!0,_=(L,I)=>[L,I],C=(L,I)=>[0,0];break;case"bottomMiddle":_=(L,I)=>[L/2,I],C=(L,I)=>[L/2,0];break;case"bottomLeft":w=!0,_=(L,I)=>[0,I],C=(L,I)=>[L,0];break;case"middleLeft":T=!0,_=(L,I)=>[0,I/2],C=(L,I)=>[L,I/2];break}const E=_(c,h),D=C(c,h);let M=v(...D);const O=xt._round(r+M[0]),R=xt._round(o+M[1]);let j=1,G=1,Q,J;if(e.fromKeyboard)({deltaX:Q,deltaY:J}=e);else{const{screenX:L,screenY:I}=e,[K,dt]=this.#l;[Q,J]=this.screenToPageTranslation(L-K,I-dt),this.#l[0]=L,this.#l[1]=I}if([Q,J]=S(Q/i,J/s),w){const L=Math.hypot(c,h);j=G=Math.max(Math.min(Math.hypot(D[0]-E[0]-Q,D[1]-E[1]-J)/L,1/c,1/h),f/c,g/h)}else T?j=Qe(Math.abs(D[0]-E[0]-Q),f,1)/c:G=Qe(Math.abs(D[1]-E[1]-J),g,1)/h;const st=xt._round(c*j),rt=xt._round(h*G);M=v(...C(st,rt));const it=O-M[0],lt=R-M[1];this.#h||=[this.x,this.y,this.width,this.height],this.width=st,this.height=rt,this.x=it,this.y=lt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new al(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#s?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(Cs.initialize(xt._l10n),this.#s=new Cs(this),this.#t&&(this.#s.data=this.#t,this.#t=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new Jc(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:s}}=this.#i;return{text:e,richText:t,date:i,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Jc(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#i||=new Jc(this),this.#i.setInitialText(t,i),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Jc(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[r]=this.pageDimensions,[o]=this.pageTranslation,c=o+r+1,h=s-100,f=c+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#n?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),C_(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new Dl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let r=.7*(i/e)+1-.7;if(r===1)return;const o=this.#M(this.rotation),c=(O,R)=>[o[0]*O+o[2]*R,o[1]*O+o[3]*R],[h,f]=this.parentDimensions,g=this.x,p=this.y,v=this.width,b=this.height,S=xt.MIN_SIZE/h,_=xt.MIN_SIZE/f;r=Math.max(Math.min(r,1/v,1/b),S/v,_/b);const C=xt._round(v*r),w=xt._round(b*r);if(C===v&&w===b)return;this.#h||=[g,p,v,b];const T=c(v/2,b/2),E=xt._round(g+T[0]),D=xt._round(p+T[1]),M=c(C/2,w/2);this.x=E-M[0],this.y=D-M[1],this.width=C,this.height=w,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#j()}pointerdown(t){const{isMac:e}=Ie.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#z(t);return}this.#L(t)}#L(t){const{isMac:e}=Ie.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#z(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:r},c=f=>{s.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#L(f),i&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#w=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:p,pointerId:v}=f;if(v!==this.#r){me(f);return}const[b,S]=this.screenToPageTranslation(g-this.#A,p-this.#w);this.#A=g,this.#w=p,this._uiManager.dragSelectedEditors(b,S)},o),window.addEventListener("touchmove",me,o),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#E||f.isPrimary)&&c(f),me(f)},o));const h=f=>{if(!this.#r||this.#r===f.pointerId){c(f);return}me(f)};window.addEventListener("pointerup",h,{signal:r}),window.addEventListener("blur",h,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[c,h]=this.pageTranslation,f=t/s,g=e/s,p=this.x*r,v=this.y*o,b=this.width*r,S=this.height*o;switch(i){case 0:return[p+f+c,o-v-g-S+h,p+f+b+c,o-v-g+h];case 90:return[p+g+c,o-v+f+h,p+g+S+c,o-v+f+b+h];case 180:return[p-f-b+c,o-v+g+h,p-f+c,o-v+g+S+h];case 270:return[p-g-S+c,o-v-f-b+h,p-g+c,o-v-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,r,o]=t,c=r-i,h=o-s;switch(this.rotation){case 0:return[i,e-o,c,h];case 90:return[i,e-s,h,c];case 180:return[r,e-s,c,h];case 270:return[r,e-o,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&xt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:s,deleted:r,richText:o},uid:c,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:o,contentsObj:{str:t},creationDate:f,modificationDate:i||g,popupRef:!r,color:e,opacity:s}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return e<o&&s>0&&t<r&&i>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[r,o]=s.pageDimensions,[c,h,f,g]=s.getRectInCurrentCoords(t.rect,o);return s.x=c/r,s.y=h/o,s.width=f/r,s.height=g/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#N(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#E?.destroy(),this.#E=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,s,r,o]=this.getPDFRect();return[xt._round(i+(r-i)*t),xt._round(s+(o-s)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const o=this.#q.bind(this),c=this.#Y.bind(this),h=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",o,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#W.bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",xt._l10nResizer[g])}}const i=this.#e[0];let s=0;for(const o of e){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==s){if(r<s)for(let c=0;c<s-r;c++)this.#c.append(this.#c.firstChild);else if(r>s)for(let c=0;c<r-s;c++)this.#c.firstChild.before(this.#c.lastChild);let o=0;for(const c of e){const f=this.#e[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",xt._l10nResizer[f])}}this.#U(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#q(t){xt._resizerKeyboardManager.exec(this,t)}#Y(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#N()}#W(t){this.#m=this.#b?t:""}#U(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#B(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#N(){this.#b=!1,this.#U(-1),this.#j()}_stopResizingWithKeyboard(){this.#N(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#_||=new Map;const{action:i}=t;let s=this.#_.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(i),this.#_.size===0&&(this.#_=null)},xt._telemetryTimeout),this.#_.set(i,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}updateFakeAnnotationElement(t){if(!this.#u&&!this.deleted){this.#u=t.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class rC extends xt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Xv=3285377520,Yi=4294901760,xs=65535;class A_{constructor(t){this.h1=t?t&4294967295:Xv,this.h2=t?t&4294967295:Xv}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let _=0,C=t.length;_<C;_++){const w=t.charCodeAt(_);w<=255?e[i++]=w:(e[i++]=w>>>8,e[i++]=w&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(e.buffer,0,s);let c=0,h=0,f=this.h1,g=this.h2;const p=3432918353,v=461845907,b=p&xs,S=v&xs;for(let _=0;_<s;_++)_&1?(c=o[_],c=c*p&Yi|c*b&xs,c=c<<15|c>>>17,c=c*v&Yi|c*S&xs,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=o[_],h=h*p&Yi|h*b&xs,h=h<<15|h>>>17,h=h*v&Yi|h*S&xs,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,r){case 3:c^=e[s*4+2]<<16;case 2:c^=e[s*4+1]<<8;case 1:c^=e[s*4],c=c*p&Yi|c*b&xs,c=c<<15|c>>>17,c=c*v&Yi|c*S&xs,s&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Yi|t*36045&xs,e=e*4283543511&Yi|((e<<16|t>>>16)*2950163797&Yi)>>>16,t^=e>>>1,t=t*444984403&Yi|t*60499&xs,e=e*3301882366&Yi|((e<<16|t>>>16)*3120437893&Yi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const bg=Object.freeze({map:null,hash:"",transfer:void 0});class Qg{#t=!1;#e=null;#s=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof xt&&this.#s.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#i.values())if(i instanceof xt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(e))i[r]!==o&&(s=!0,i[r]=o);else s=!0,this.#i.set(t,e);s&&this.#a(),e instanceof xt&&((this.#s||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new T_(this)}get serializable(){if(this.#i.size===0)return bg;const t=new Map,e=new A_,i=[],s=Object.create(null);let r=!1;for(const[o,c]of this.#i){const h=c instanceof xt?c.serialize(!1,s):c;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),r||=!!h.bitmap)}if(r)for(const o of t.values())o.bitmap&&i.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:bg}get editorStats(){let t=null;const e=new Map;let i=0,s=0;for(const r of this.#i.values()){if(!(r instanceof xt)){r.popup&&(r.popup.deleted?s+=1:i+=1);continue}r.isCommentDeleted?s+=1:r.hasEditedComment&&(i+=1);const o=r.telemetryFinalData;if(!o)continue;const{type:c}=o;e.has(c)||e.set(c,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const h=t[c]||=new Map;for(const[f,g]of Object.entries(o)){if(f==="type")continue;let p=h.get(f);p||(p=new Map,h.set(f,p));const v=p.get(g)??0;p.set(g,v+1)}}if((s>0||i>0)&&(t||=Object.create(null),t.comments={deleted:s,edited:i}),!t)return null;for(const[r,o]of e)t[r]=o.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#s?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#s?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#s)for(const e of this.#s.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class T_ extends Qg{#t;constructor(t){super();const{map:e,hash:i,transfer:s}=t.serializable,r=structuredClone(e,s?{transfer:s}:null);this.#t={map:r,hash:i,transfer:s}}get print(){ae("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Nt(this,"modifiedIds",{ids:new Set,hash:""})}}class aC{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Vt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:o}=t,c=new FontFace(s,r,o);this.addNativeFontFace(c);try{await c.load(),this.#t.add(s),i?.(t)}catch{Rt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}ae("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw Rt(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Nt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Nt(this,"isSyncFontLoadingSupported",ii||Ie.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Vt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Nt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(D,M){return D.charCodeAt(M)<<24|D.charCodeAt(M+1)<<16|D.charCodeAt(M+2)<<8|D.charCodeAt(M+3)&255}function s(D,M,O,R){const j=D.substring(0,M),G=D.substring(M+O);return j+R+G}let r,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(D,M){if(++f>30){Rt("Load test font never loaded."),M();return}if(h.font="30px "+D,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(g.bind(null,D,M))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,p.length,p);const S=16,_=1482184792;let C=i(v,S);for(r=0,o=p.length-3;r<o;r+=4)C=C-_+i(p,r)|0;r<p.length&&(C=C-_+i(p+"XXX",r)|0),v=s(v,S,4,q1(C));const w=`url(data:font/opentype;base64,${btoa(v)});`,T=`@font-face {font-family:"${p}";src:${w}}`;this.insertRule(T);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const D of[t.loadedName,p]){const M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=D,E.append(M)}this._document.body.append(E),g(p,()=>{E.remove(),e.complete()})}}class oC{#t;constructor(t,e=null,i,s){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${y_(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let s;try{s=t.get(i)}catch(o){Rt(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=r}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function lC(u){if(u instanceof URL)return u.href;if(typeof u=="string"){if(ii)return u;const t=URL.parse(u,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function cC(u){if(ii&&typeof Buffer<"u"&&u instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return Cl(u);if(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="object"&&!isNaN(u?.length))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function th(u){if(typeof u!="string")return null;if(u.endsWith("/"))return u;throw new Error(`Invalid factory url: "${u}" must include trailing slash.`)}const _g=u=>typeof u=="object"&&Number.isInteger(u?.num)&&u.num>=0&&Number.isInteger(u?.gen)&&u.gen>=0,hC=u=>typeof u=="object"&&typeof u?.name=="string",E_=Q1.bind(null,_g,hC);class uC{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if(i?.signal instanceof AbortSignal){const{signal:r}=i;if(r.aborted){Rt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const eh={DATA:1,ERROR:2},Oe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Yv(){}function pi(u){if(u instanceof an||u instanceof Ih||u instanceof jv||u instanceof dl||u instanceof Kf)return u;switch(u instanceof Error||typeof u=="object"&&u!==null||ae('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new an(u.message);case"InvalidPDFException":return new Ih(u.message);case"PasswordException":return new jv(u.message,u.code);case"ResponseException":return new dl(u.message,u.status,u.missing);case"UnknownErrorException":return new Kf(u.message,u.details)}return new Kf(u.message,u.toString())}class il{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===eh.DATA)s.resolve(t.data);else if(t.callback===eh.ERROR)s.reject(pi(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:eh.DATA,callbackId:t.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:eh.ERROR,callbackId:t.callbackId,reason:pi(o)})});return}if(t.streamId){this.#s(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(t,e,i,s){const r=this.streamId++,o=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[r]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:c,action:t,streamId:r,data:e,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[r].pullCall=g,h.postMessage({sourceName:o,targetName:c,stream:Oe.PULL,streamId:r,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Vt(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[r].cancelCall=g,this.streamControllers[r].isClosed=!0,h.postMessage({sourceName:o,targetName:c,stream:Oe.CANCEL,streamId:r,reason:pi(f)}),g.promise}},i)}#s(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,o=this,c=this.actionHandler[t.action],h={enqueue(f,g=1,p){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=g,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Oe.ENQUEUE,streamId:e,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Oe.CLOSE,streamId:e}),delete o.streamSinks[e])},error(f){Vt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Oe.ERROR,streamId:e,reason:pi(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Oe.START_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:i,targetName:s,stream:Oe.START_COMPLETE,streamId:e,reason:pi(f)})})}#i(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,r=this.comObj,o=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case Oe.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(pi(t.reason));break;case Oe.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(pi(t.reason));break;case Oe.PULL:if(!c){r.postMessage({sourceName:i,targetName:s,stream:Oe.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||Yv).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Oe.PULL_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:i,targetName:s,stream:Oe.PULL_COMPLETE,streamId:e,reason:pi(f)})});break;case Oe.ENQUEUE:if(Vt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Oe.CLOSE:if(Vt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,e);break;case Oe.ERROR:Vt(o,"error should have stream controller"),o.controller.error(pi(t.reason)),this.#a(o,e);break;case Oe.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(pi(t.reason)),this.#a(o,e);break;case Oe.CANCEL:if(!c)break;const h=pi(t.reason);Promise.try(c.onCancel||Yv,h).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Oe.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){r.postMessage({sourceName:i,targetName:s,stream:Oe.CANCEL_COMPLETE,streamId:e,reason:pi(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class D_{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ae("Abstract method `_createCanvas` called.")}}class dC extends D_{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class M_{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class qv extends M_{async _fetch(t){const e=await Ua(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Cl(e)}}class O_{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,r){return"none"}destroy(t=!1){}}class fC extends O_{#t;#e;#s;#i;#a;#n;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#n||=new Map}get#l(){if(!this.#s){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#a.createElementNS(Zs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#s=this.#a.createElementNS(Zs,"defs"),t.append(i),i.append(this.#s),this.#a.body.append(t)}return this.#s}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let p=0;p<256;p++)f[p]=h[p]/255;const g=f.join(",");return[g,g,g]}const[e,i,s]=t,r=new Array(256),o=new Array(256),c=new Array(256);for(let h=0;h<256;h++)r[h]=e[h]/255,o[h]=i[h]/255,c[h]=s[h]/255;return[r.join(","),o.join(","),c.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Tl(e)?Rt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Vg(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,s,r]=this.#d(t),o=t.length===1?i:`${i}${s}${r}`;if(e=this.#o.get(o),e)return this.#o.set(t,e),e;const c=`g_${this.#i}_transfer_map_${this.#r++}`,h=this.#u(c);this.#o.set(t,h),this.#o.set(o,h);const f=this.#g(c);return this.#p(i,s,r,f),h}addHCMFilter(t,e){const i=`${t}-${e}`,s="base";let r=this.#c.get(s);if(r?.key===i||(r?(r.filter?.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},this.#c.set(s,r)),!t||!e))return r.url;const o=this.#b(t);t=ut.makeHexColor(...o);const c=this.#b(e);if(e=ut.makeHexColor(...c),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const h=new Array(256);for(let b=0;b<=255;b++){const S=b/255;h[b]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const f=h.join(","),g=`g_${this.#i}_hcm_filter`,p=r.filter=this.#g(g);this.#p(f,f,f,p),this.#m(p);const v=(b,S)=>{const _=o[b]/255,C=c[b]/255,w=new Array(S+1);for(let T=0;T<=S;T++)w[T]=_+T/S*(C-_);return w.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),p),r.url=this.#u(g),r.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),s=`alpha_${i}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_alpha_map_${this.#r++}`,o=this.#u(r);this.#o.set(t,o),this.#o.set(s,o);const c=this.#g(r);return this.#y(i,c),o}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,s;if(t?([i]=this.#d([t]),s=`luminosity_${i}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_luminosity_map_${this.#r++}`,o=this.#u(r);this.#o.set(t,o),this.#o.set(s,o);const c=this.#g(r);return this.#f(c),t&&this.#y(i,c),o}addHighlightHCMFilter(t,e,i,s,r){const o=`${e}-${i}-${s}-${r}`;let c=this.#c.get(t);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#c.set(t,c)),!e||!i))return c.url;const[h,f]=[e,i].map(this.#b.bind(this));let g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,b]=[s,r].map(this.#b.bind(this));p<g&&([g,p,v,b]=[p,g,b,v]),this.#l.style.color="";const S=(w,T,E)=>{const D=new Array(256),M=(p-g)/E,O=w/255,R=(T-w)/(255*E);let j=0;for(let G=0;G<=E;G++){const Q=Math.round(g+G*M),J=O+G*R;for(let st=j;st<=Q;st++)D[st]=J;j=Q+1}for(let G=j;G<256;G++)D[G]=D[j-1];return D.join(",")},_=`g_${this.#i}_hcm_${t}_filter`,C=c.filter=this.#g(_);return this.#m(C),this.#p(S(v[0],b[0],5),S(v[1],b[1],5),S(v[2],b[2],5),C),c.url=this.#u(_),c.url}destroy(t=!1){t&&this.#n?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#n?.clear(),this.#n=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(Zs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(Zs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(Zs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#h(t,e,i){const s=this.#a.createElementNS(Zs,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)}#p(t,e,i,s){const r=this.#a.createElementNS(Zs,"feComponentTransfer");s.append(r),this.#h(r,"feFuncR",t),this.#h(r,"feFuncG",e),this.#h(r,"feFuncB",i)}#y(t,e){const i=this.#a.createElementNS(Zs,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#b(t){return this.#l.style.color=t,Ga(getComputedStyle(this.#l).getPropertyValue("color"))}}class k_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class Wv extends k_{async _fetch(t){const e=await Ua(t,"arraybuffer");return new Uint8Array(e)}}class R_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){ae("Abstract method `_fetch` called.")}}class Kv extends R_{async _fetch(t){const e=await Ua(t,"arraybuffer");return new Uint8Array(e)}}ii&&Rt("Please use the `legacy` build in Node.js environments.");async function Zg(u){const e=await process.getBuiltinModule("fs").promises.readFile(u);return new Uint8Array(e)}class gC extends O_{}class pC extends D_{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class mC extends M_{async _fetch(t){return Zg(t)}}class yC extends k_{async _fetch(t){return Zg(t)}}class vC extends R_{async _fetch(t){return Zg(t)}}const va="__forcedDependency",{floor:$v,ceil:Qv}=Math;function ih(u,t,e,i,s,r){u[t*4+0]=Math.min(u[t*4+0],e),u[t*4+1]=Math.min(u[t*4+1],i),u[t*4+2]=Math.max(u[t*4+2],s),u[t*4+3]=Math.max(u[t*4+3],r)}const Sg=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class bC{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Sg}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const sh=(u,t)=>{if(!u)return;let e=u.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},u.set(t,e)),e};class _C{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[va]:[]};#s=new Map;#i=[];#a=[];#n=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#u=new Map;#f;#m;#g;#h;#p;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#h.length&&this.#y(t,this.#h)}#y(t,e){const i=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(i),this.#h=new Uint32Array(i),e&&e.length>0?(this.#h.set(e),this.#h.fill(Sg,e.length)):this.#h.fill(Sg)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[va]:{__proto__:this.#e[va]}},this.#r={__proto__:this.#r},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const i=this.#i.pop();return i!==void 0&&(sh(this.#p,t)?.dependencies.add(i),this.#h[t]=this.#h[i]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(sh(this.#p,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(sh(this.#p,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}pushBaseTransform(t){return this.#n.push(ut.multiplyByDOMMatrix(this.#n.at(-1),t.getTransform())),this}popBaseTransform(){return this.#n.length>1&&this.#n.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#s.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#s.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(va,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(va,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,s,r,o){const c=ut.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];ut.axialAlignedBoundingBox([i,r,s,o],c,h);const f=ut.intersect(this.#r,h);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,i,s,r,o){const c=this.#r;if(c[0]===1/0)return this;const h=ut.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform());if(c[0]===-1/0)return ut.axialAlignedBoundingBox([i,r,s,o],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return ut.axialAlignedBoundingBox([i,r,s,o],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(t,e,i,s=1,r=0,o=0,c){const h=i.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(i),f!==!1&&(g=[0,0,0,0],ut.axialAlignedBoundingBox(h,i.fontMatrix,g),(s!==1||r!==0||o!==0)&&ut.scaleMinMax([s,0,0,-s,r,o],g),f)))return this.recordBBox(t,e,g[0],g[2],g[1],g[3]);if(!c)return this.recordFullPageBBox(t);const p=c();return h&&g&&f===void 0&&(f=g[0]<=r-p.actualBoundingBoxLeft&&g[2]>=r+p.actualBoundingBoxRight&&g[1]<=o-p.actualBoundingBoxAscent&&g[3]>=o+p.actualBoundingBoxDescent,this.#u.set(i,f),f)?this.recordBBox(t,e,g[0],g[2],g[1],g[3]):this.recordBBox(t,e,r-p.actualBoundingBoxLeft,r+p.actualBoundingBoxRight,o-p.actualBoundingBoxAscent,o+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,s=this.#t,r=this.#e;for(const o of e)o in this.#t?i.add(s[o]):o in r&&r[o].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#s.has(e)&&this.#l.add(this.#s.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[va]),this.#p){const i=sh(this.#p,t),{dependencies:s}=i;this.#l.forEach(s.add,s),this.#i.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=$v(this.#o[0]*256/this.#f),s=$v(this.#o[1]*256/this.#m),r=Qv(this.#o[2]*256/this.#f),o=Qv(this.#o[3]*256/this.#m);ih(this.#g,t,i,s,r,o);for(const c of this.#l)c!==t&&ih(this.#g,c,i,s,r,o);for(const c of this.#i)c!==t&&ih(this.#g,c,i,s,r,o);for(const c of this.#a)c!==t&&ih(this.#g,c,i,s,r,o);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const s of i)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#u.clear(),new bC(this.#h,this.#g)}takeDebugMetadata(){return this.#p}}class Gh{#t;#e;#s;#i=0;#a=0;constructor(t,e,i){if(t instanceof Gh&&t.#s===!!i)return t;this.#t=t,this.#e=e,this.#s=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#s||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,s,r,o){return this.#s||this.#t.recordClipBox(this.#e,e,i,s,r,o),this}recordBBox(t,e,i,s,r,o){return this.#s||this.#t.recordBBox(this.#e,e,i,s,r,o),this}recordCharacterBBox(t,e,i,s,r,o,c){return this.#s||this.#t.recordCharacterBBox(this.#e,e,i,s,r,o,c),this}recordFullPageBBox(t){return this.#s||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#s||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const qi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},We={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xg(u,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),u.clip(s)}class Jg{isModifyingCurrentTransform(){return!1}getPattern(){ae("Abstract method `getPattern` called.")}}class SC extends Jg{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let r;if(s===We.STROKE||s===We.FILL){const o=e.current.getClippedPathBoundingBox(s,ge(t))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,f=e.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-o[0],-o[1]),i=ut.transform(i,[1,0,0,1,o[0],o[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),xg(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),r=t.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(i);r.setTransform(p)}else xg(t,this._bbox),r=this._createGradient(t);return r}}function Zf(u,t,e,i,s,r,o,c){const h=t.coords,f=t.colors,g=u.data,p=u.width*4;let v;h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=r,r=o,o=v),h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=c,c=v),h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=r,r=o,o=v);const b=(h[e]+t.offsetX)*t.scaleX,S=(h[e+1]+t.offsetY)*t.scaleY,_=(h[i]+t.offsetX)*t.scaleX,C=(h[i+1]+t.offsetY)*t.scaleY,w=(h[s]+t.offsetX)*t.scaleX,T=(h[s+1]+t.offsetY)*t.scaleY;if(S>=T)return;const E=f[r],D=f[r+1],M=f[r+2],O=f[o],R=f[o+1],j=f[o+2],G=f[c],Q=f[c+1],J=f[c+2],st=Math.round(S),rt=Math.round(T);let it,lt,L,I,K,dt,_t,P;for(let Y=st;Y<=rt;Y++){if(Y<C){const pt=Y<S?0:(S-Y)/(S-C);it=b-(b-_)*pt,lt=E-(E-O)*pt,L=D-(D-R)*pt,I=M-(M-j)*pt}else{let pt;Y>T?pt=1:C===T?pt=0:pt=(C-Y)/(C-T),it=_-(_-w)*pt,lt=O-(O-G)*pt,L=R-(R-Q)*pt,I=j-(j-J)*pt}let et;Y<S?et=0:Y>T?et=1:et=(S-Y)/(S-T),K=b-(b-w)*et,dt=E-(E-G)*et,_t=D-(D-Q)*et,P=M-(M-J)*et;const nt=Math.round(Math.min(it,K)),ft=Math.round(Math.max(it,K));let gt=p*Y+nt*4;for(let pt=nt;pt<=ft;pt++)et=(it-pt)/(it-K),et<0?et=0:et>1&&(et=1),g[gt++]=lt-(lt-dt)*et|0,g[gt++]=L-(L-_t)*et|0,g[gt++]=I-(I-P)*et|0,g[gt++]=255}}function xC(u,t,e){const i=t.coords,s=t.colors;let r,o;switch(t.type){case"lattice":const c=t.verticesPerRow,h=Math.floor(i.length/c)-1,f=c-1;for(r=0;r<h;r++){let g=r*c;for(let p=0;p<f;p++,g++)Zf(u,e,i[g],i[g+1],i[g+c],s[g],s[g+1],s[g+c]),Zf(u,e,i[g+c+1],i[g+1],i[g+c],s[g+c+1],s[g+1],s[g+c])}break;case"triangles":for(r=0,o=i.length;r<o;r+=3)Zf(u,e,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class wC extends Jg{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,p=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),b=f/p,S=g/v,_={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/b,scaleY:1/S},C=p+4,w=v+4,T=i.getCanvas("mesh",C,w),E=T.context,D=E.createImageData(p,v);if(e){const O=D.data;for(let R=0,j=O.length;R<j;R+=4)O[R]=e[0],O[R+1]=e[1],O[R+2]=e[2],O[R+3]=255}for(const O of this._figures)xC(D,O,_);return E.putImageData(D,2,2),{canvas:T.canvas,offsetX:c-2*b,offsetY:h-2*S,scaleX:b,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,s){xg(t,this._bbox);const r=new Float32Array(2);if(s===We.SHADING)ut.singularValueDecompose2dScale(ge(t),r);else if(this.matrix){ut.singularValueDecompose2dScale(this.matrix,r);const[c,h]=r;ut.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=c,r[1]*=h}else ut.singularValueDecompose2dScale(e.baseTransform,r);const o=this._createMeshCanvas(r,s===We.SHADING?null:this._background,e.cachedCanvases);return s!==We.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class CC extends Jg{getPattern(){return"hotpink"}}function AC(u){switch(u[0]){case"RadialAxial":return new SC(u);case"Mesh":return new wC(u);case"Dummy":return new CC}throw new Error(`Unknown IR type: ${u[0]}`)}const Zv={COLORED:1,UNCOLORED:2};class tp{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t,e){const{bbox:i,operatorList:s,paintType:r,tilingType:o,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),ru("TilingType: "+o);const p=i[0],v=i[1],b=i[2],S=i[3],_=b-p,C=S-v,w=new Float32Array(2);ut.singularValueDecompose2dScale(this.matrix,w);const[T,E]=w;ut.singularValueDecompose2dScale(this.baseTransform,w);const D=T*w[0],M=E*w[1];let O=_,R=C,j=!1,G=!1;const Q=Math.ceil(f*D),J=Math.ceil(g*M),st=Math.ceil(_*D),rt=Math.ceil(C*M);Q>=st?O=f:j=!0,J>=rt?R=g:G=!0;const it=this.getSizeAndScale(O,this.ctx.canvas.width,D),lt=this.getSizeAndScale(R,this.ctx.canvas.height,M),L=t.cachedCanvases.getCanvas("pattern",it.size,lt.size),I=L.context,K=h.createCanvasGraphics(I,e);if(K.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(K,r,c),I.translate(-it.scale*p,-lt.scale*v),K.transform(0,it.scale,0,0,lt.scale,0,0),I.save(),K.dependencyTracker?.save(),this.clipBbox(K,p,v,b,S),K.baseTransform=ge(K.ctx),K.executeOperatorList(s),K.endDrawing(),K.dependencyTracker?.restore(),I.restore(),j||G){const dt=L.canvas;j&&(O=f),G&&(R=g);const _t=this.getSizeAndScale(O,this.ctx.canvas.width,D),P=this.getSizeAndScale(R,this.ctx.canvas.height,M),Y=_t.size,et=P.size,nt=t.cachedCanvases.getCanvas("pattern-workaround",Y,et),ft=nt.context,gt=j?Math.floor(_/f):0,pt=G?Math.floor(C/g):0;for(let Wt=0;Wt<=gt;Wt++)for(let Mt=0;Mt<=pt;Mt++)ft.drawImage(dt,Y*Wt,et*Mt,Y,et,0,0,Y,et);return{canvas:nt.canvas,scaleX:_t.scale,scaleY:P.scale,offsetX:p,offsetY:v}}return{canvas:L.canvas,scaleX:it.scale,scaleY:lt.scale,offsetX:p,offsetY:v}}getSizeAndScale(t,e,i){const s=Math.max(tp.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=s?r=s:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,s,r){const o=s-e,c=r-i;t.ctx.rect(e,i,o,c),ut.axialAlignedBoundingBox([e,i,s,r],ge(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,r=t.current;switch(e){case Zv.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;s.fillStyle=r.fillColor=o,s.strokeStyle=r.strokeColor=c;break;case Zv.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new Y1(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,s,r){let o=i;s!==We.SHADING&&(o=ut.transform(o,e.baseTransform),this.matrix&&(o=ut.transform(o,this.matrix)));const c=this.createPatternCanvas(e,r);let h=new DOMMatrix(o);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=t.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function TC({src:u,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const c=Ie.isLittleEndian?4278190080:255,[h,f]=o?[r,c]:[c,r],g=i>>3,p=i&7,v=u.length;e=new Uint32Array(e.buffer);let b=0;for(let S=0;S<s;S++){for(const C=t+g;t<C;t++){const w=t<v?u[t]:255;e[b++]=w&128?f:h,e[b++]=w&64?f:h,e[b++]=w&32?f:h,e[b++]=w&16?f:h,e[b++]=w&8?f:h,e[b++]=w&4?f:h,e[b++]=w&2?f:h,e[b++]=w&1?f:h}if(p===0)continue;const _=t<v?u[t++]:255;for(let C=0;C<p;C++)e[b++]=_&1<<7-C?f:h}return{srcPos:t,destPos:b}}const Jv=16,tb=100,EC=15,eb=10,mi=16,Jf=new DOMMatrix,Pi=new Float32Array(2),Ca=new Float32Array([1/0,1/0,-1/0,-1/0]);function DC(u,t){if(u._removeMirroring)throw new Error("Context is already forwarding operations.");u.__originalSave=u.save,u.__originalRestore=u.restore,u.__originalRotate=u.rotate,u.__originalScale=u.scale,u.__originalTranslate=u.translate,u.__originalTransform=u.transform,u.__originalSetTransform=u.setTransform,u.__originalResetTransform=u.resetTransform,u.__originalClip=u.clip,u.__originalMoveTo=u.moveTo,u.__originalLineTo=u.lineTo,u.__originalBezierCurveTo=u.bezierCurveTo,u.__originalRect=u.rect,u.__originalClosePath=u.closePath,u.__originalBeginPath=u.beginPath,u._removeMirroring=()=>{u.save=u.__originalSave,u.restore=u.__originalRestore,u.rotate=u.__originalRotate,u.scale=u.__originalScale,u.translate=u.__originalTranslate,u.transform=u.__originalTransform,u.setTransform=u.__originalSetTransform,u.resetTransform=u.__originalResetTransform,u.clip=u.__originalClip,u.moveTo=u.__originalMoveTo,u.lineTo=u.__originalLineTo,u.bezierCurveTo=u.__originalBezierCurveTo,u.rect=u.__originalRect,u.closePath=u.__originalClosePath,u.beginPath=u.__originalBeginPath,delete u._removeMirroring},u.save=function(){t.save(),this.__originalSave()},u.restore=function(){t.restore(),this.__originalRestore()},u.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},u.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},u.transform=function(e,i,s,r,o,c){t.transform(e,i,s,r,o,c),this.__originalTransform(e,i,s,r,o,c)},u.setTransform=function(e,i,s,r,o,c){t.setTransform(e,i,s,r,o,c),this.__originalSetTransform(e,i,s,r,o,c)},u.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},u.rotate=function(e){t.rotate(e),this.__originalRotate(e)},u.clip=function(e){t.clip(e),this.__originalClip(e)},u.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},u.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},u.bezierCurveTo=function(e,i,s,r,o,c){t.bezierCurveTo(e,i,s,r,o,c),this.__originalBezierCurveTo(e,i,s,r,o,c)},u.rect=function(e,i,s,r){t.rect(e,i,s,r),this.__originalRect(e,i,s,r)},u.closePath=function(){t.closePath(),this.__originalClosePath()},u.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class MC{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function nh(u,t,e,i,s,r,o,c,h,f){const[g,p,v,b,S,_]=ge(u);if(p===0&&v===0){const T=o*g+S,E=Math.round(T),D=c*b+_,M=Math.round(D),O=(o+h)*g+S,R=Math.abs(Math.round(O)-E)||1,j=(c+f)*b+_,G=Math.abs(Math.round(j)-M)||1;return u.setTransform(Math.sign(g),0,0,Math.sign(b),E,M),u.drawImage(t,e,i,s,r,0,0,R,G),u.setTransform(g,p,v,b,S,_),[R,G]}if(g===0&&b===0){const T=c*v+S,E=Math.round(T),D=o*p+_,M=Math.round(D),O=(c+f)*v+S,R=Math.abs(Math.round(O)-E)||1,j=(o+h)*p+_,G=Math.abs(Math.round(j)-M)||1;return u.setTransform(0,Math.sign(p),Math.sign(v),0,E,M),u.drawImage(t,e,i,s,r,0,0,G,R),u.setTransform(g,p,v,b,S,_),[G,R]}u.drawImage(t,e,i,s,r,o,c,h,f);const C=Math.hypot(g,p),w=Math.hypot(v,b);return[C*h,w*f]}class ib{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=yg;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ye.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Ca.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=We.FILL,e=null){const i=this.minMax.slice();if(t===We.STROKE){e||ae("Stroke bounding box must include transform."),ut.singularValueDecompose2dScale(e,Pi);const s=Pi[0]*this.lineWidth/2,r=Pi[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const t=ut.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Ca,0)}getClippedPathBoundingBox(t=We.FILL,e=null){return ut.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function sb(u,t){if(t instanceof ImageData){u.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%mi,r=(e-s)/mi,o=s===0?r:r+1,c=u.createImageData(i,mi);let h=0,f;const g=t.data,p=c.data;let v,b,S,_;if(t.kind===rl.GRAYSCALE_1BPP){const C=g.byteLength,w=new Uint32Array(p.buffer,0,p.byteLength>>2),T=w.length,E=i+7>>3,D=4294967295,M=Ie.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(S=v<r?mi:s,f=0,b=0;b<S;b++){const O=C-h;let R=0;const j=O>E?i:O*8-7,G=j&-8;let Q=0,J=0;for(;R<G;R+=8)J=g[h++],w[f++]=J&128?D:M,w[f++]=J&64?D:M,w[f++]=J&32?D:M,w[f++]=J&16?D:M,w[f++]=J&8?D:M,w[f++]=J&4?D:M,w[f++]=J&2?D:M,w[f++]=J&1?D:M;for(;R<j;R++)Q===0&&(J=g[h++],Q=128),w[f++]=J&Q?D:M,Q>>=1}for(;f<T;)w[f++]=0;u.putImageData(c,0,v*mi)}}else if(t.kind===rl.RGBA_32BPP){for(b=0,_=i*mi*4,v=0;v<r;v++)p.set(g.subarray(h,h+_)),h+=_,u.putImageData(c,0,b),b+=mi;v<o&&(_=i*s*4,p.set(g.subarray(h,h+_)),u.putImageData(c,0,b))}else if(t.kind===rl.RGB_24BPP)for(S=mi,_=i*S,v=0;v<o;v++){for(v>=r&&(S=s,_=i*S),f=0,b=_;b--;)p[f++]=g[h++],p[f++]=g[h++],p[f++]=g[h++],p[f++]=255;u.putImageData(c,0,v*mi)}else throw new Error(`bad image kind: ${t.kind}`)}function nb(u,t){if(t.bitmap){u.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%mi,r=(e-s)/mi,o=s===0?r:r+1,c=u.createImageData(i,mi);let h=0;const f=t.data,g=c.data;for(let p=0;p<o;p++){const v=p<r?mi:s;({srcPos:h}=TC({src:f,srcPos:h,dest:g,width:i,height:v,nonBlackColor:0})),u.putImageData(c,0,p*mi)}}function Wo(u,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)u[i]!==void 0&&(t[i]=u[i]);u.setLineDash!==void 0&&(t.setLineDash(u.getLineDash()),t.lineDashOffset=u.lineDashOffset)}function rh(u){u.strokeStyle=u.fillStyle="#000000",u.fillRule="nonzero",u.globalAlpha=1,u.lineWidth=1,u.lineCap="butt",u.lineJoin="miter",u.miterLimit=10,u.globalCompositeOperation="source-over",u.font="10px sans-serif",u.setLineDash!==void 0&&(u.setLineDash([]),u.lineDashOffset=0);const{filter:t}=u;t!=="none"&&t!==""&&(u.filter="none")}function rb(u,t){if(t)return!0;ut.singularValueDecompose2dScale(u,Pi);const e=Math.fround(fs.pixelRatio*Tr.PDF_TO_CSS_UNITS);return Pi[0]<=e&&Pi[1]<=e}const OC=["butt","round","square"],kC=["miter","round","bevel"],RC={},ab={};class Ma{constructor(t,e,i,s,r,{optionalContentConfig:o,markedContentStack:c=null},h,f,g){this.ctx=t,this.current=new ib(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new MC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=c,i){const h=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ge(this.compositeCtx))}this.ctx.save(),rh(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ge(this.ctx)}executeOperatorList(t,e,i,s,r){const o=t.argsArray,c=t.fnArray;let h=e||0;const f=o.length;if(f===h)return h;const g=f-h>eb&&typeof i=="function",p=g?Date.now()+EC:0;let v=0;const b=this.commonObjs,S=this.objs;let _,C;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,i),h;if(!r||r(h))if(_=c[h],C=o[h]??null,_!==ja.dependency)C===null?this[_](h):this[_](h,...C);else for(const w of C){this.dependencyTracker?.recordNamedData(w,h);const T=w.startsWith("g_")?b:S;if(!T.has(w))return T.get(w,i),h}if(h++,h===f)return h;if(g&&++v>eb){if(Date.now()>p)return i(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),c=i,h=s,f="prescale1",g,p;for(;r>2&&c>1||o>2&&h>1;){let v=c,b=h;r>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),r/=c/v),o>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/b),g=this.cachedCanvases.getCanvas(f,v,b),p=g.context,p.clearRect(0,0,v,b),p.drawImage(t,0,0,c,h,0,0,v,b),t=g.canvas,c=v,h=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t,e){const i=this.ctx,{width:s,height:r}=e,o=this.current.fillColor,c=this.current.patternFill,h=ge(i);let f,g,p,v;if((e.bitmap||e.data)&&e.count>1){const Q=e.bitmap||e.data.buffer;g=JSON.stringify(c?h:[h.slice(0,4),o]),f=this._cachedBitmapsMap.get(Q),f||(f=new Map,this._cachedBitmapsMap.set(Q,f));const J=f.get(g);if(J&&!c){const st=Math.round(Math.min(h[0],h[2])+h[4]),rt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,qi.transformAndFill),{canvas:J,offsetX:st,offsetY:rt}}p=J}p||(v=this.cachedCanvases.getCanvas("maskCanvas",s,r),nb(v.context,e));let b=ut.transform(h,[1/s,0,0,-1/r,0,0]);b=ut.transform(b,[1,0,0,1,0,-r]);const S=Ca.slice();ut.axialAlignedBoundingBox([0,0,s,r],b,S);const[_,C,w,T]=S,E=Math.round(w-_)||1,D=Math.round(T-C)||1,M=this.cachedCanvases.getCanvas("fillCanvas",E,D),O=M.context,R=_,j=C;O.translate(-R,-j),O.transform(...b),p||(p=this._scaleImage(v.canvas,Ss(O)),p=p.img,f&&c&&f.set(g,p)),O.imageSmoothingEnabled=rb(ge(O),e.interpolate),nh(O,p,0,0,p.width,p.height,0,0,s,r),O.globalCompositeOperation="source-in";const G=ut.transform(Ss(O),[1,0,0,1,-R,-j]);return O.fillStyle=c?o.getPattern(i,this,G,We.FILL,t):o,O.fillRect(0,0,s,r),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,M.canvas)),this.dependencyTracker?.recordDependencies(t,qi.transformAndFill),{canvas:M.canvas,offsetX:Math.round(R),offsetY:Math.round(j)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=OC[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=kC[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,s]of e)switch(i){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,e,i);this.suspendedCtx=this.ctx;const o=this.ctx=r.context;o.setTransform(this.suspendedCtx.getTransform()),Wo(this.suspendedCtx,o),DC(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Wo(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const r=s[0],o=s[1],c=s[2]-r,h=s[3]-o;c===0||h===0||(this.genericComposeSMask(e.context,i,c,h,e.subtype,e.backdrop,e.transferMap,r,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,r,o,c,h,f,g,p){let v=t.canvas,b=h-g,S=f-p;if(o)if(b<0||S<0||b+i>v.width||S+s>v.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,s),w=C.context;w.drawImage(v,-b,-S),w.globalCompositeOperation="destination-atop",w.fillStyle=o,w.fillRect(0,0,i,s),w.globalCompositeOperation="source-over",v=C.canvas,b=S=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(b,S,i,s),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(b,S,i,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const _=new Path2D;_.rect(h,f,i,s),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(v,b,S,i,s,h,f,i,s),e.restore()}save(t){this.inSMaskMode&&Wo(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Wo(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,s,r,o,c){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,s,r,o,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,s){let[r]=i;if(!s){r||=i[0]=new Path2D,this[e](t,r);return}if(this.dependencyTracker!==null){const o=e===ja.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(t,["transform"])}if(!(r instanceof Path2D)){const o=i[0]=new Path2D;for(let c=0,h=r.length;c<h;)switch(r[c++]){case Zc.moveTo:o.moveTo(r[c++],r[c++]);break;case Zc.lineTo:o.lineTo(r[c++],r[c++]);break;case Zc.curveTo:o.bezierCurveTo(r[c++],r[c++],r[c++],r[c++],r[c++],r[c++]);break;case Zc.closePath:o.closePath();break;default:Rt(`Unrecognized drawing path operator: ${r[c-1]}`);break}r=o}ut.axialAlignedBoundingBox(s,ge(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const o=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,Ss(s),We.STROKE,t),o){const c=new Path2D;c.addPath(e,s.getTransform().invertSelf().multiplySelf(o)),e=c}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,qi.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(We.STROKE,ge(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const s=this.ctx,r=this.current.fillColor,o=this.current.patternFill;let c=!1;if(o){const f=r.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=r.getPattern(s,this,Ss(s),We.FILL,t),f){const g=new Path2D;g.addPath(e,s.getTransform().invertSelf().multiplySelf(f)),e=g}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,qi.fill),c&&(s.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,qi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=RC}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ab}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,r=i.getTransform().invertSelf();for(const{transform:o,x:c,y:h,fontSize:f,path:g}of e)g&&s.addPath(g,new DOMMatrix(o).preMultiplySelf(r).translate(c,h).scale(f,-f));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const s=this.commonObjs.get(e),r=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=s.fontMatrix||yg,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Rt("Invalid font matrix for font "+e),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const o=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let g=i;i<Jv?g=Jv:i>tb&&(g=tb),this.current.fontSizeScale=i/g,this.ctx.font=`${f} ${h} ${g}px ${c}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#s(t,e,i){const s=new Path2D;return s.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),s}paintChar(t,e,i,s,r,o){const c=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,p=h.fontSize/h.fontSizeScale,v=g&Ye.FILL_STROKE_MASK,b=!!(g&Ye.ADD_TO_PATH_FLAG),S=h.patternFill&&!f.missingFile,_=h.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||b||S||_)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,e)),C&&(f.disableFontFace||S||_)){c.save(),c.translate(i,s),c.scale(p,-p),this.dependencyTracker?.recordCharacterBBox(t,c,f);let w;if(v===Ye.FILL||v===Ye.FILL_STROKE)if(r){w=c.getTransform(),c.setTransform(...r);const T=this.#s(C,w,r);c.fill(T)}else c.fill(C);if(v===Ye.STROKE||v===Ye.FILL_STROKE)if(o){w||=c.getTransform(),c.setTransform(...o);const{a:T,b:E,c:D,d:M}=w,O=ut.inverseTransform(o),R=ut.transform([T,E,D,M,0,0],O);ut.singularValueDecompose2dScale(R,Pi),c.lineWidth*=Math.max(Pi[0],Pi[1])/p,c.stroke(this.#s(C,w,o))}else c.lineWidth/=p,c.stroke(C);c.restore()}else(v===Ye.FILL||v===Ye.FILL_STROKE)&&(c.fillText(e,i,s),this.dependencyTracker?.recordCharacterBBox(t,c,f,p,i,s,()=>c.measureText(e))),(v===Ye.STROKE||v===Ye.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,c,f,p,i,s,()=>c.measureText(e)).recordDependencies(t,qi.stroke),c.strokeText(e,i,s));b&&((this.pendingTextPaths||=[]).push({transform:ge(c),x:i,y:s,fontSize:p,path:C}),this.dependencyTracker?.recordCharacterBBox(t,c,f,p,i,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return Nt(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,qi.showText).resetBBox(t),this.current.textRenderingMode&Ye.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const r=i.fontSize;if(r===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,c=i.fontSizeScale,h=i.charSpacing,f=i.wordSpacing,g=i.fontDirection,p=i.textHScale*g,v=e.length,b=s.vertical,S=b?1:-1,_=s.defaultVMetrics,C=r*i.fontMatrix[0],w=i.textRenderingMode===Ye.FILL&&!s.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),g>0?o.scale(p,-1):o.scale(p,1);let T,E;if(i.patternFill){o.save();const j=i.fillColor.getPattern(o,this,Ss(o),We.FILL,t);T=ge(o),o.restore(),o.fillStyle=j}if(i.patternStroke){o.save();const j=i.strokeColor.getPattern(o,this,Ss(o),We.STROKE,t);E=ge(o),o.restore(),o.strokeStyle=j}let D=i.lineWidth;const M=i.textMatrixScale;if(M===0||D===0){const j=i.textRenderingMode&Ye.FILL_STROKE_MASK;(j===Ye.STROKE||j===Ye.FILL_STROKE)&&(D=this.getSinglePixelWidth())}else D/=M;if(c!==1&&(o.scale(c,c),D/=c),o.lineWidth=D,s.isInvalidPDFjsFont){const j=[];let G=0;for(const J of e)j.push(J.unicode),G+=J.width;const Q=j.join("");if(o.fillText(Q,0,0),this.dependencyTracker!==null){const J=o.measureText(Q);this.dependencyTracker.recordBBox(t,this.ctx,-J.actualBoundingBoxLeft,J.actualBoundingBoxRight,-J.actualBoundingBoxAscent,J.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=G*C*p,o.restore(),this.compose();return}let O=0,R;for(R=0;R<v;++R){const j=e[R];if(typeof j=="number"){O+=S*j*r/1e3;continue}let G=!1;const Q=(j.isSpace?f:0)+h,J=j.fontChar,st=j.accent;let rt,it,lt=j.width;if(b){const K=j.vmetric||_,dt=-(j.vmetric?K[1]:lt*.5)*C,_t=K[2]*C;lt=K?-K[0]:lt,rt=dt/c,it=(O+_t)/c}else rt=O/c,it=0;let L;if(s.remeasure&&lt>0){L=o.measureText(J);const K=L.width*1e3/r*c;if(lt<K&&this.isFontSubpixelAAEnabled){const dt=lt/K;G=!0,o.save(),o.scale(dt,1),rt/=dt}else lt!==K&&(rt+=(lt-K)/2e3*r/c)}if(this.contentVisible&&(j.isInFont||s.missingFile)){if(w&&!st)o.fillText(J,rt,it),this.dependencyTracker?.recordCharacterBBox(t,o,L?{bbox:null}:s,r/c,rt,it,()=>L??o.measureText(J));else if(this.paintChar(t,J,rt,it,T,E),st){const K=rt+r*st.offset.x/c,dt=it-r*st.offset.y/c;this.paintChar(t,st.fontChar,K,dt,T,E)}}const I=b?lt*C-Q*g:lt*C+Q*g;O+=I,G&&o.restore()}b?i.y-=O:i.x+=O*p,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,s=this.current,r=s.font,o=s.fontSize,c=s.fontDirection,h=r.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,p=s.textHScale*c,v=s.fontMatrix||yg,b=e.length,S=s.textRenderingMode===Ye.INVISIBLE;let _,C,w,T;if(S||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(p,c);const E=this.dependencyTracker;for(this.dependencyTracker=E?new Gh(E,t):null,_=0;_<b;++_){if(C=e[_],typeof C=="number"){T=h*C*o/1e3,this.ctx.translate(T,0),s.x+=T*p;continue}const D=(C.isSpace?g:0)+f,M=r.charProcOperatorList[C.operatorListId];M?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...v),this.executeOperatorList(M),this.restore()):Rt(`Type3 character "${C.operatorListId}" is not available.`);const O=[C.width,0];ut.applyTransform(O,v),w=O[0]*o+D,i.translate(w,0),s.x+=w*p}i.restore(),E&&(this.dependencyTracker=E)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,s,r,o,c){const h=new Path2D;h.rect(s,r,o-s,c-r),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,s,o,r,c).recordClipBox(t,this.ctx,s,o,r,c),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const s=this.baseTransform||ge(this.ctx),r={createCanvasGraphics:(o,c)=>new Ma(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Gh(this.dependencyTracker,c,!0):null)};i=new tp(e,this.ctx,r,s)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=AC(this.getObject(t,e)),this.cachedPatterns.set(e,s)),i&&(s.matrix=i),s}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const s=this._getPattern(t,e);i.fillStyle=s.getPattern(i,this,Ss(i),We.SHADING,t);const r=Ss(i);if(r){const{width:o,height:c}=i.canvas,h=Ca.slice();ut.axialAlignedBoundingBox([0,0,o,c],r,h);const[f,g,p,v]=h;this.ctx.fillRect(f,g,p-f,v-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,qi.transform).recordDependencies(t,qi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){ae("Should not call beginInlineImage")}beginImageData(){ae("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ge(this.ctx),i)){ut.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[s,r,o,c]=i,h=new Path2D;h.rect(s,r,o-s,c-r),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,s,o,r,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||ru("TODO: Support non-isolated groups."),e.knockout&&Rt("Knockout groups not supported.");const s=ge(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=Ca.slice();ut.axialAlignedBoundingBox(e.bbox,ge(i),r);const o=[0,0,i.canvas.width,i.canvas.height];r=ut.intersect(r,o)||[0,0,0,0];const c=Math.floor(r[0]),h=Math.floor(r[1]),f=Math.max(Math.ceil(r[2])-c,1),g=Math.max(Math.ceil(r[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,f,g),b=v.context;b.translate(-c,-h),b.transform(...s);let S=new Path2D;const[_,C,w,T]=e.bbox;if(S.rect(_,C,w-_,T-C),e.matrix){const E=new Path2D;E.addPath(S,new DOMMatrix(e.matrix)),S=E}b.clip(S),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:c,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(c,h),i.save()),Wo(i,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=ge(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...r);const o=Ca.slice();ut.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],r,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,s,r,o){if(this.#t(),rh(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const c=i[2]-i[0],h=i[3]-i[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=c,i[3]=h,ut.singularValueDecompose2dScale(ge(this.ctx),Pi);const{viewportScale:f}=this,g=Math.ceil(c*this.outputScaleX*f),p=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,p);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(Pi[0],0,0,-Pi[1],0,h*Pi[1]),rh(this.ctx)}else{rh(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],c,h),this.ctx.clip(f)}}this.current=new ib(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const s=this.ctx,r=this._createMaskCanvas(t,e),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+o.width,r.offsetY,r.offsetY+o.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,s=0,r=0,o,c){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const f=ge(h);h.transform(i,s,r,o,0,0);const g=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let p=0,v=c.length;p<v;p+=2){const b=ut.transform(f,[i,s,r,o,c[p],c[p+1]]);h.drawImage(g.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+g.canvas.width,b[5],b[5]+g.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,qi.transformAndFill);for(const o of e){const{data:c,width:h,height:f,transform:g}=o,p=this.cachedCanvases.getCanvas("maskCanvas",h,f),v=p.context;v.save();const b=this.getObject(t,c,o);nb(v,b),v.globalCompositeOperation="source-in",v.fillStyle=r?s.getPattern(v,this,Ss(i),We.FILL,t):s,v.fillRect(0,0,h,f),v.restore(),i.save(),i.transform(...g),i.scale(1,-1),nh(i,p.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,h,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){Rt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,s,r){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){Rt("Dependent image isn't ready yet");return}const c=o.width,h=o.height,f=[];for(let g=0,p=r.length;g<p;g+=2)f.push({transform:[i,0,0,s,r[g],r[g+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(t,o,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",r.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,s=e.height,r=this.ctx;this.save(t);const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none"),r.scale(1/i,-1/s);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const g=this.cachedCanvases.getCanvas("inlineImage",i,s).context;sb(g,e),c=this.applyTransferMapsToCanvas(g)}const h=this._scaleImage(c,Ss(r));r.imageSmoothingEnabled=rb(ge(r),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,r,0,i,-s,0).recordDependencies(t,qi.imageXObject).recordOperation(t),nh(r,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,i,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const s=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const o=e.width,c=e.height,f=this.cachedCanvases.getCanvas("inlineImage",o,c).context;sb(f,e),r=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const o of i)s.save(),s.transform(...o.transform),s.scale(1,-1),nh(s,r,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,qi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(s||(this.pendingClip===ab?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ge(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:r}=this.ctx.getTransform();let o,c;if(i===0&&s===0){const h=Math.abs(e),f=Math.abs(r);if(h===f)if(t===0)o=c=1/h;else{const g=h*t;o=c=g<1?1/g:1}else if(t===0)o=1/h,c=1/f;else{const g=h*t,p=f*t;o=g<1?1/g:1,c=p<1?1/p:1}}else{const h=Math.abs(e*r-i*s),f=Math.hypot(e,i),g=Math.hypot(s,r);if(t===0)o=g/h,c=f/h;else{const p=t*h;o=g>p?g/p:1,c=f>p?f/p:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:s}}=this,[r,o]=this.getScaleForStroking();if(r===o){i.lineWidth=(s||1)*r,i.stroke(t);return}const c=i.getLineDash();e&&i.save(),i.scale(r,o),Jf.a=1/r,Jf.d=1/o;const h=new Path2D;if(h.addPath(t,Jf),c.length>0){const f=Math.max(r,o);i.setLineDash(c.map(g=>g/f)),i.lineDashOffset/=f}i.lineWidth=s||1,i.stroke(h),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const u in ja)Ma.prototype[u]!==void 0&&(Ma.prototype[ja[u]]=Ma.prototype[u]);class Oa{#t;#e;#s;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let s=0;for(const f of Oa.strings){const g=e.encode(t[f]);i[f]=g,s+=4+g.length}const r=new ArrayBuffer(s),o=new Uint8Array(r),c=new DataView(r);let h=0;for(const f of Oa.strings){const g=i[f],p=g.length;c.setUint32(h,p),o.set(g,h+4),h+=4+p}return Vt(h===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}#i(t){Vt(t<Oa.strings.length,"Invalid string index");let e=0;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ka{#t;#e;#s;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let s=0;for(const v of ka.strings){const b=e.encode(t[v]);i[v]=b,s+=4+b.length}s+=4;let r,o,c=1+s;t.style&&(r=e.encode(t.style.style),o=e.encode(t.style.weight),c+=4+r.length+4+o.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let p=0;g.setUint8(p++,t.guessFallback?1:0),g.setUint32(p,0),p+=4,s=0;for(const v of ka.strings){const b=i[v],S=b.length;s+=4+S,g.setUint32(p,S),f.set(b,p+4),p+=4+S}return g.setUint32(p-s-4,s),t.style&&(g.setUint32(p,r.length),f.set(r,p+4),p+=4+r.length,g.setUint32(p,o.length),f.set(o,p+4),p+=4+o.length),Vt(p<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(p)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#s=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Vt(t<ka.strings.length,"Invalid string index");let e=5;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#s.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#s.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const s=this.#e.getUint32(t),r=this.#s.decode(new Uint8Array(this.#t,t+4,s));return{style:i,weight:r}}}class se{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#s=this.#e+1+8;static#i=this.#s+1+48;static#a=this.#i+1+6;#n;#r;#o;constructor({data:t,extra:e}){this.#n=t,this.#r=new TextDecoder,this.#o=new DataView(this.#n),e&&Object.assign(this,e)}#c(t){Vt(t<se.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,s=this.#o.getUint8(e)>>i&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Vt(t<se.numbers.length,"Invalid number index"),this.#o.getFloat64(se.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=se.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<4;s++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=se.#s;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<6;s++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=se.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<3;s++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Vt(t<se.strings.length,"Invalid string index");let e=se.#a+4;for(let r=0;r<t;r++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),s=new Uint8Array(i);return s.set(new Uint8Array(this.#n,e+4,i)),this.#r.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=se.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);if(r!==0)return new Uint8Array(this.#n,t+4,r)}clearData(){let t=se.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const r=this.#o.getUint32(t);new Uint8Array(this.#n,t+4,r).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=se.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#n,t+4,s)),new Oa(r.buffer)}get systemFontInfo(){let t=se.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(this.#n,t+4,i)),new ka(s.buffer)}static write(t){const e=t.systemFontInfo?ka.write(t.systemFontInfo):null,i=t.cssFontInfo?Oa.write(t.cssFontInfo):null,s=new TextEncoder,r={};let o=0;for(const _ of se.strings)r[_]=s.encode(t[_]),o+=4+r[_].length;const c=se.#a+4+o+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let p=0;const v=se.bools.length;let b=0,S=0;for(let _=0;_<v;_++){const C=t[se.bools[_]];b|=(C===void 0?0:C?2:1)<<S,S+=2,(S===8||_===v-1)&&(g.setUint8(p++,b),b=0,S=0)}Vt(p===se.#t,"FontInfo.write: Boolean properties offset mismatch");for(const _ of se.numbers)g.setFloat64(p,t[_]),p+=8;if(Vt(p===se.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(p++,4);for(const _ of t.bbox)g.setInt16(p,_,!0),p+=2}else g.setUint8(p++,0),p+=8;if(Vt(p===se.#s,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(p++,6);for(const _ of t.fontMatrix)g.setFloat64(p,_,!0),p+=8}else g.setUint8(p++,0),p+=48;if(Vt(p===se.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(p++,1);for(const _ of t.defaultVMetrics)g.setInt16(p,_,!0),p+=2}else g.setUint8(p++,0),p+=6;Vt(p===se.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(se.#a,0),p+=4;for(const _ of se.strings){const C=r[_],w=C.length;g.setUint32(p,w),f.set(C,p+4),p+=4+w}if(g.setUint32(se.#a,p-se.#a-4),!e)g.setUint32(p,0),p+=4;else{const _=e.byteLength;g.setUint32(p,_),Vt(p+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),p+4),p+=4+_}if(!i)g.setUint32(p,0),p+=4;else{const _=i.byteLength;g.setUint32(p,_),Vt(p+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),p+4),p+=4+_}return t.data===void 0?(g.setUint32(p,0),p+=4):(g.setUint32(p,t.data.length),f.set(t.data,p+4),p+=4+t.data.length),Vt(p<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(p)}}class Vn{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class LC{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const xa=Symbol("INTERNAL");class PC{#t=!1;#e=!1;#s=!1;#i=!0;constructor(t,{name:e,intent:i,usage:s,rbGroups:r}){this.#t=!!(t&Ri.DISPLAY),this.#e=!!(t&Ri.PRINT),this.name=e,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(this.#s)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==xa&&ae("Internal method `_setVisible` called."),this.#s=i,this.#i=e}}class BC{#t=null;#e=new Map;#s=null;#i=null;constructor(t,e=Ri.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new PC(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(xa,!1);for(const i of t.on)this.#e.get(i)._setVisible(xa,!0);for(const i of t.off)this.#e.get(i)._setVisible(xa,!1);this.#s=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const r=t[s];let o;if(Array.isArray(r))o=this.#a(r);else if(this.#e.has(r))o=this.#e.get(r).visible;else return Rt(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ru("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Rt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Rt(`Unknown optional content policy ${t.policy}.`),!0}return Rt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const s=this.#e.get(t);if(!s){Rt(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const r of s.rbGroups)for(const o of r)o!==t&&this.#e.get(o)?._setVisible(xa,!1,!0);s._setVisible(xa,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=this.#e.get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new A_;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class NC{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Vt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,r?.length>0){const h=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(i),!0)});Vt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Vt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new FC(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new jC(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class FC{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=ou(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class jC{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function zC(u){let t=!0,e=i("filename\\*","i").exec(u);if(e){e=e[1];let g=c(e);return g=unescape(g),g=h(g),g=f(g),r(g)}if(e=o(u),e){const g=f(e);return r(g)}if(e=i("filename","i").exec(u),e){e=e[1];let g=c(e);return g=f(g),r(g)}function i(g,p){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function s(g,p){if(g){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const v=new TextDecoder(g,{fatal:!0}),b=Cl(p);p=v.decode(b),t=!1}catch{}}return p}function r(g){return t&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),t&&(g=s("iso-8859-1",g))),g}function o(g){const p=[];let v;const b=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(g))!==null;){let[,_,C,w]=v;if(_=parseInt(_,10),_ in p){if(_===0)break;continue}p[_]=[C,w]}const S=[];for(let _=0;_<p.length&&_ in p;++_){let[C,w]=p[_];w=c(w),C&&(w=unescape(w),_===0&&(w=h(w))),S.push(w)}return S.join("")}function c(g){if(g.startsWith('"')){const p=g.slice(1).split('\\"');for(let v=0;v<p.length;++v){const b=p[v].indexOf('"');b!==-1&&(p[v]=p[v].slice(0,b),p.length=v+1),p[v]=p[v].replaceAll(/\\(.)/g,"$1")}g=p.join('"')}return g}function h(g){const p=g.indexOf("'");if(p===-1)return g;const v=g.slice(0,p),S=g.slice(p+1).replace(/^[^']*'/,"");return s(v,S)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,v,b,S){if(b==="q"||b==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,C){return String.fromCharCode(parseInt(C,16))}),s(v,S);try{S=atob(S)}catch{}return s(v,S)})}return""}function L_(u,t){const e=new Headers;if(!u||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function lu(u){return URL.parse(u)?.origin??null}function P_({responseHeaders:u,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(u.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*e)||i||!t||u.get("Accept-Ranges")!=="bytes"||(u.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function B_(u){const t=u.get("Content-Disposition");if(t){let e=zC(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(ou(e))return e}return null}function Ml(u,t){return new dl(`Unexpected server response (${u}) while retrieving PDF "${t}".`,u,u===404||u===0&&t.startsWith("file:"))}function N_(u){return u===200||u===206}function F_(u,t,e){return{method:"GET",headers:u,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function j_(u){return u instanceof Uint8Array?u.buffer:u instanceof ArrayBuffer?u:(Rt(`getArrayBuffer - unexpected data format: ${u}`),new Uint8Array(u).buffer)}class IC{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=L_(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new HC(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new UC(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class HC{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,F_(i,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=lu(r.url),!N_(r.status))throw Ml(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:c,suggestedLength:h}=P_({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=B_(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new an("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:j_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class UC{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${i-1}`);const o=s.url;fetch(o,F_(r,this._withCredentials,this._abortController)).then(c=>{const h=lu(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!N_(c.status))throw Ml(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:j_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const tg=200,eg=206;function GC(u){const t=u.response;return typeof t!="string"?t:Cl(t).buffer}class VC{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=L_(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,o]of this.headers)e.setRequestHeader(r,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=eg):s.expectedStatus=tg,e.responseType="arraybuffer",Vt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||tg;if(!(r===tg&&i.expectedStatus===eg)&&r!==i.expectedStatus){i.onError(s.status);return}const c=GC(s);if(r===eg){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?i.onDone({begin:parseInt(f[1],10),chunk:c}):(Rt('Missing or invalid "Content-Range" header.'),i.onError(0))}else c?i.onDone({begin:0,chunk:c}):i.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class XC{constructor(t){this._source=t,this._manager=new VC(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Vt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new YC(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new qC(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class YC{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=lu(e.responseURL);const i=e.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=P_({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=B_(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Ml(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class qC{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=lu(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Ml(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const WC=/^[a-z][a-z0-9\-+.]+:/i;function KC(u){if(WC.test(u))return new URL(u);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(u))}class $C{constructor(t){this.source=t,this.url=KC(t.url),Vt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new QC(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ZC(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class QC{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Ml(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new an("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ZC{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Ko=Symbol("INITIAL_DATA");class z_{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Ko}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const i=this.#t[t];if(!i||i.data===Ko)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Ko}delete(t){const e=this.#t[t];return!e||e.data===Ko?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Ko&&(yield[t,e])}}}const JC=1e5,ob=30;let gl=class Ki{#t=Promise.withResolvers();#e=null;#s=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#n=null;#r=0;#o=0;#c=null;#l=null;#d=0;#u=0;#f=Object.create(null);#m=[];#g=null;#h=[];#p=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#A=new WeakMap;static#w=null;static#_=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#u=i.scale*fs.pixelRatio,this.#d=i.rotation,this.#n={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:r,pageX:o,pageY:c}=i.rawDims;this.#y=[1,0,0,-1,-o,c+r],this.#o=s,this.#r=r,Ki.#M(),Xn(e,i),this.#t.promise.finally(()=>{Ki.#_.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ie.platform;return Nt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#E(e.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),Ki.#_.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*fs.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,Xn(this.#l,{rotation:s})),i!==this.#u){e?.(),this.#u=i;const r={div:null,properties:null,ctx:Ki.#O(this.#a)};for(const o of this.#h)r.properties=this.#p.get(o),r.div=o,this.#C(r)}}cancel(){const t=new an("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#m}#E(t){if(this.#s)return;this.#n.ctx??=Ki.#O(this.#a);const e=this.#h,i=this.#m;for(const s of t){if(e.length>JC){Rt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),r.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(s.str),this.#x(s)}}#x(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const s=ut.transform(this.#y,t.transform);let r=Math.atan2(s[1],s[0]);const o=this.#f[t.fontName];o.vertical&&(r+=Math.PI/2);let c=this.#i&&o.fontSubstitution||o.fontFamily;c=Ki.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*Ki.#F(c,o,this.#a);let g,p;r===0?(g=s[4],p=s[5]-f):(g=s[4]+f*Math.sin(r),p=s[5]-f*Math.cos(r));const v="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#l?(b.left=`${(100*g/this.#o).toFixed(2)}%`,b.top=`${(100*p/this.#r).toFixed(2)}%`):(b.left=`${v}${g.toFixed(2)}px)`,b.top=`${v}${p.toFixed(2)}px)`),b.fontSize=`${v}${(Ki.#w*h).toFixed(2)}px)`,b.fontFamily=c,i.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),r!==0&&(i.angle=r*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),C=Math.abs(t.transform[3]);_!==C&&Math.max(_,C)/Math.min(_,C)>1.5&&(S=!0)}if(S&&(i.canvasWidth=o.vertical?t.height:t.width),this.#p.set(e,i),this.#n.div=e,this.#n.properties=i,this.#C(this.#n),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#C(t){const{div:e,properties:i,ctx:s}=t,{style:r}=e;let o="";if(Ki.#w>1&&(o=`scale(${1/Ki.#w})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=r,{canvasWidth:h,fontSize:f}=i;Ki.#D(s,f*this.#u,c);const{width:g}=s.measureText(e.textContent);g>0&&(o=`scaleX(${h*this.#u/g}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(r.transform=o)}static cleanup(){if(!(this.#_.size>0)){this.#b.clear();for(const{canvas:t}of this.#v.values())t.remove();this.#v.clear()}}static#O(t=null){let e=this.#v.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(t,e),this.#A.set(e,{size:0,family:""})}return e}static#D(t,e,i){const s=this.#A.get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)}static#M(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#F(t,e,i){const s=this.#b.get(t);if(s)return s;const r=this.#O(i);r.canvas.width=r.canvas.height=ob,this.#D(r,ob,t);const o=r.measureText(""),c=o.fontBoundingBoxAscent,h=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let f=.8;return c?f=c/(c+h):(Ie.platform.isFirefox&&Rt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#b.set(t,f),f}};const tA=100;function ep(u={}){typeof u=="string"||u instanceof URL?u={url:u}:(u instanceof ArrayBuffer||ArrayBuffer.isView(u))&&(u={data:u});const t=new ip,{docId:e}=t,i=u.url?lC(u.url):null,s=u.data?cC(u.data):null,r=u.httpHeaders||null,o=u.withCredentials===!0,c=u.password??null,h=u.range instanceof sp?u.range:null,f=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:2**16;let g=u.worker instanceof za?u.worker:null;const p=u.verbosity,v=typeof u.docBaseUrl=="string"&&!Tl(u.docBaseUrl)?u.docBaseUrl:null,b=th(u.cMapUrl),S=u.cMapPacked!==!1,_=u.CMapReaderFactory||(ii?mC:qv),C=th(u.iccUrl),w=th(u.standardFontDataUrl),T=u.StandardFontDataFactory||(ii?yC:Wv),E=th(u.wasmUrl),D=u.WasmFactory||(ii?vC:Kv),M=u.stopAtErrors!==!0,O=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,R=u.isEvalSupported!==!1,j=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!ii,G=typeof u.isImageDecoderSupported=="boolean"?u.isImageDecoderSupported:!ii&&(Ie.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(u.canvasMaxAreaInBytes)?u.canvasMaxAreaInBytes:-1,J=typeof u.disableFontFace=="boolean"?u.disableFontFace:ii,st=u.fontExtraProperties===!0,rt=u.enableXfa===!0,it=u.ownerDocument||globalThis.document,lt=u.disableRange===!0,L=u.disableStream===!0,I=u.disableAutoFetch===!0,K=u.pdfBug===!0,dt=u.CanvasFactory||(ii?pC:dC),_t=u.FilterFactory||(ii?gC:fC),P=u.enableHWA===!0,Y=u.useWasm!==!1,et=h?h.length:u.length??NaN,nt=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!ii&&!J,ft=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:!!(_===qv&&T===Wv&&D===Kv&&b&&w&&E&&el(b,document.baseURI)&&el(w,document.baseURI)&&el(E,document.baseURI)),gt=null;G1(p);const pt={canvasFactory:new dt({ownerDocument:it,enableHWA:P}),filterFactory:new _t({docId:e,ownerDocument:it}),cMapReaderFactory:ft?null:new _({baseUrl:b,isCompressed:S}),standardFontDataFactory:ft?null:new T({baseUrl:w}),wasmFactory:ft?null:new D({baseUrl:E})};g||(g=za.create({verbosity:p,port:Vn.workerPort}),t._worker=g);const Wt={docId:e,apiVersion:"5.4.296",data:s,password:c,disableAutoFetch:I,rangeChunkSize:f,length:et,docBaseUrl:v,enableXfa:rt,evaluatorOptions:{maxImageSize:O,disableFontFace:J,ignoreErrors:M,isEvalSupported:R,isOffscreenCanvasSupported:j,isImageDecoderSupported:G,canvasMaxAreaInBytes:Q,fontExtraProperties:st,useSystemFonts:nt,useWasm:Y,useWorkerFetch:ft,cMapUrl:b,iccUrl:C,standardFontDataUrl:w,wasmUrl:E}},Mt={ownerDocument:it,pdfBug:K,styleElement:gt,loadingParams:{disableAutoFetch:I,enableXfa:rt}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Pt=g.messageHandler.sendWithPromise("GetDocRequest",Wt,s?[s.buffer]:null);let yt;if(h)yt=new NC(h,{disableRange:lt,disableStream:L});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const ot=el(i)?IC:ii?$C:XC;yt=new ot({url:i,length:et,httpHeaders:r,withCredentials:o,rangeChunkSize:f,disableRange:lt,disableStream:L})}return Pt.then(ot=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Tt=new il(e,ot,g.port),Et=new sA(Tt,t,yt,Mt,pt,P);t._transport=Et,Tt.send("Ready",null)})}).catch(t._capability.reject),t}class ip{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${ip.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let sp=class{#t=Promise.withResolvers();#e=[];#s=[];#i=[];#a=[];constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#s.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#a)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#s)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){ae("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class eA{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Nt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class iA{#t=!1;constructor(t,e,i,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Iv:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new z_,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new Al({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Nt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:s="display",annotationMode:r=Es.ENABLE,transform:o=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:p=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:S=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(s,r,p,v),{renderingIntent:C,cacheKey:w}=_;this.#t=!1,h||=this._transport.getOptionalContentConfig(C);let T=this._intentStates.get(w);T||(T=Object.create(null),this._intentStates.set(w,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const E=!!(C&Ri.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const D=!!(this._pdfBug&&globalThis.StepperManager?.enabled),M=!this.recordedBBoxes&&(b||D),O=G=>{if(T.renderTasks.delete(R),M){const Q=R.gfx?.dependencyTracker.take();Q&&(R.stepper&&R.stepper.setOperatorBBoxes(Q,R.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=Q))}E&&(this.#t=!0),this.#e(),G?(R.capability.reject(G),this._abortOperatorList({intentState:T,reason:G instanceof Error?G:new Error(G)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new Aa({callback:O,params:{canvas:e,canvasContext:t,dependencyTracker:M?new _C(e,T.operatorList.length,D):null,viewport:i,transform:o,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:S});(T.renderTasks||=new Set).add(R);const j=R.task;return Promise.all([T.displayReadyCapability.promise,h]).then(([G,Q])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(Q.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:G,optionalContentConfig:Q}),R.operatorListChanged()}).catch(O),j}getOperatorList({intent:t="display",annotationMode:e=Es.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,i,s,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>fl.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function r(){o.read().then(function({value:h,done:f}){if(f){i(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),r()},s)}const o=e.getReader(),c={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Iv),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:s},o).getReader(),f=this._intentStates.get(e);f.streamReader=h;const g=()=>{h.read().then(({value:p,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),g())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};g()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof au){let s=tA;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new an(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Gn,os,sn,xr,su,wr,Cr,ri,Lh,I_,H_,sl,Fa,Ph;const fe=class fe{constructor({name:t=null,port:e=null,verbosity:i=V1()}={}){bs(this,ri);bs(this,Gn,Promise.withResolvers());bs(this,os,null);bs(this,sn,null);bs(this,xr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(de(fe,Cr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");de(fe,Cr).set(e,this),_s(this,ri,I_).call(this,e)}else _s(this,ri,H_).call(this)}get promise(){return de(this,Gn).promise}get port(){return de(this,sn)}get messageHandler(){return de(this,os)}destroy(){this.destroyed=!0,de(this,xr)?.terminate(),gi(this,xr,null),de(fe,Cr).delete(de(this,sn)),gi(this,sn,null),de(this,os)?.destroy(),gi(this,os,null)}static create(t){const e=de(this,Cr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new fe(t)}static get workerSrc(){if(Vn.workerSrc)return Vn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Nt(this,"_setupFakeWorkerGlobal",(async()=>de(this,Fa,Ph)?de(this,Fa,Ph):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gn=new WeakMap,os=new WeakMap,sn=new WeakMap,xr=new WeakMap,su=new WeakMap,wr=new WeakMap,Cr=new WeakMap,ri=new WeakSet,Lh=function(){de(this,Gn).resolve(),de(this,os).send("configure",{verbosity:this.verbosity})},I_=function(t){gi(this,sn,t),gi(this,os,new il("main","worker",t)),de(this,os).on("ready",()=>{}),_s(this,ri,Lh).call(this)},H_=function(){if(de(fe,wr)||de(fe,Fa,Ph)){_s(this,ri,sl).call(this);return}let{workerSrc:t}=fe;try{fe._isSameOrigin(window.location,t)||(t=fe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new il("main","worker",e),s=()=>{r.abort(),i.destroy(),e.terminate(),this.destroyed?de(this,Gn).reject(new Error("Worker was destroyed")):_s(this,ri,sl).call(this)},r=new AbortController;e.addEventListener("error",()=>{de(this,xr)||s()},{signal:r.signal}),i.on("test",c=>{if(r.abort(),this.destroyed||!c){s();return}gi(this,os,i),gi(this,sn,e),gi(this,xr,e),_s(this,ri,Lh).call(this)}),i.on("ready",c=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{_s(this,ri,sl).call(this)}});const o=()=>{const c=new Uint8Array;i.send("test",c,[c.buffer])};o();return}catch{ru("The worker has been disabled.")}_s(this,ri,sl).call(this)},sl=function(){de(fe,wr)||(Rt("Setting up fake worker."),gi(fe,wr,!0)),fe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){de(this,Gn).reject(new Error("Worker was destroyed"));return}const e=new uC;gi(this,sn,e);const i=`fake${Ev(fe,su)._++}`,s=new il(i+"_worker",i,e);t.setup(s,e),gi(this,os,new il(i,i+"_worker",e)),_s(this,ri,Lh).call(this)}).catch(t=>{de(this,Gn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Fa=new WeakSet,Ph=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},bs(fe,Fa),bs(fe,su,0),bs(fe,wr,!1),bs(fe,Cr,new WeakMap),ii&&(gi(fe,wr,!0),Vn.workerSrc||="./pdf.worker.mjs"),fe._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const s=new URL(e,i);return i.origin===s.origin},fe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},fe.fromPort=t=>{if(J1("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return fe.create(t)};let za=fe;class sA{#t=new Map;#e=new Map;#s=new Map;#i=new Map;#a=null;constructor(t,e,i,s,r,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new z_,this.fontLoader=new aC({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#n(t,e=null){const i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Nt(this,"annotationStorage",new Qg)}getRenderingIntent(t,e=Es.ENABLE,i=null,s=!1,r=!1){let o=Ri.DISPLAY,c=bg;switch(t){case"any":o=Ri.ANY;break;case"display":break;case"print":o=Ri.PRINT;break;default:Rt(`getRenderingIntent - invalid intent: ${t}`)}const h=o&Ri.PRINT&&i instanceof T_?i:this.annotationStorage;switch(e){case Es.DISABLE:o+=Ri.ANNOTATIONS_DISABLE;break;case Es.ENABLE:break;case Es.ENABLE_FORMS:o+=Ri.ANNOTATIONS_FORMS;break;case Es.ENABLE_STORAGE:o+=Ri.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Rt(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(o+=Ri.IS_EDITING),r&&(o+=Ri.OPLIST);const{ids:f,hash:g}=h.modifiedIds,p=[o,c.hash,g];return{renderingIntent:o,cacheKey:p.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#s.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),gl.cleanup(),this._networkStream?.cancelAllRequests(new an("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{Vt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){s.close();return}Vt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this._fullReader;return(!s||!r)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),t.on("GetRangeReader",(i,s)=>{Vt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:c}){if(c){s.close();return}Vt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new eA(i,this))}),t.on("DocException",i=>{e._capability.reject(pi(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw pi(i);const s=r=>{r instanceof Error?this.#a.reject(r):this.#a.resolve({password:r})};e.onPassword(s,i.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,r])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const g=r.error;Rt(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const o=new se(r),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,p)=>globalThis.FontInspector.fontAdded(g,p):null,h=new oC(o,c,r.extra,r.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:f}=r;Vt(f,"The imageRef must be defined.");for(const g of this.#e.values())for(const[,p]of g.objs)if(p?.ref===f)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,r,o])=>{if(this.destroyed)return;const c=this.#e.get(s);if(!c.objs.has(i)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(r){case"Image":case"Pattern":c.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Rt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#s.get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,t);const o=new iA(e,r,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#s.set(e,s),s}getPageIndex(t){return _g(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#n("GetOptionalContentConfig").then(e=>new BC(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new LC(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),gl.cleanup()}}cachedPageNumber(t){if(!_g(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class nA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Aa{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:p=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:S=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=p,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new nA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Aa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Aa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:r,dependencyTracker:o}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ma(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Aa.#e.delete(this._canvas),t||=new au(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Aa.#e.delete(this._canvas),this.callback())))}}const np="5.4.296",U_="f56dc8601";class Li{#t=null;#e=null;#s;#i=null;#a=!1;#n=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Nt(this,"_keyboardManager",new El([[["Escape","mac+Escape"],Li.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Li.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Li.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Li.prototype._moveToPrevious],[["Home","mac+Home"],Li.prototype._moveToBeginning],[["End","mac+End"],Li.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#n=!1,this.#r=t):this.#n=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#s=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Li.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#s,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Bi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,s]of this.#l.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",Li.#d[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.ariaSelected=s===this.#s,r.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ut.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastChild?.focus()}#m(t){Li._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const i of this.#i.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class pl{#t=null;#e=null;#s=null;static#i=null;constructor(t){this.#e=t,this.#s=t._uiManager,pl.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",pl.#i[t]),s.addEventListener("input",()=>{this.#s.updateParams(e,s.value)},{signal:this.#s._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function lb(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function $o(u){return Math.max(0,Math.min(255,255*u))}class cb{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=$o(t),[t,t,t]}static G_HTML([t]){const e=lb(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map($o)}static RGB_HTML(t){return`#${t.map(lb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[$o(1-Math.min(1,t+s)),$o(1-Math.min(1,i+s)),$o(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,r=1-e,o=1-i,c=Math.min(s,r,o);return["CMYK",s,r,o,c]}}class rA{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ae("Abstract method `_createSVG` called.")}}class ml extends rA{_createSVG(t){return document.createElementNS(Zs,t)}}const aA=9,Er=new WeakSet,oA=new Date().getTimezoneOffset()*60*1e3;class hb{static create(t){switch(t.data.annotationType){case xe.LINK:return new rp(t);case xe.TEXT:return new cA(t);case xe.WIDGET:switch(t.data.fieldType){case"Tx":return new hA(t);case"Btn":return t.data.radioButton?new G_(t):t.data.checkBox?new dA(t):new fA(t);case"Ch":return new gA(t);case"Sig":return new uA(t)}return new kr(t);case xe.POPUP:return new wg(t);case xe.FREETEXT:return new V_(t);case xe.LINE:return new mA(t);case xe.SQUARE:return new yA(t);case xe.CIRCLE:return new vA(t);case xe.POLYLINE:return new X_(t);case xe.CARET:return new _A(t);case xe.INK:return new ap(t);case xe.POLYGON:return new bA(t);case xe.HIGHLIGHT:return new Y_(t);case xe.UNDERLINE:return new SA(t);case xe.SQUIGGLY:return new xA(t);case xe.STRIKEOUT:return new wA(t);case xe.STAMP:return new q_(t);case xe.FILEATTACHMENT:return new CA(t);default:return new ye(t)}}}class ye{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ye._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:s}=this.data;let r=-1/0,o=-1/0;if(e?.length>=8){for(let c=0;c<e.length;c+=8)e[c+1]>o?(o=e[c+1],r=e[c+2]):e[c+1]===o&&(r=Math.max(r,e[c+2]));return[r,o]}if(i?.length>=1){for(const c of i)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>o?(o=c[h+1],r=c[h]):c[h+1]===o&&(r=Math.max(r,c[h]));if(r!==1/0)return[r,o]}return s?[s[2],s[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/i,t[1]=100*(t[1]-o)/s,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${ul}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${ul}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#s?.popup||this.popup)?.remove(),this.#s=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#i(e);let s=this.#s?.popup||this.popup;!s&&i?.text&&(this._createPopup(i),s=this.#s.popup),s&&(s.updateEdited(t),i?.deleted&&(s.remove(),this.#s=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:c,pageY:h}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-c)/r}%`,e.top=`${100*(o-t[3]+h)/o}%`,s===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof kr)&&!(this instanceof rp)&&(r.tabIndex=0);const{style:o}=r;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof wg){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,r),r}const{width:c,height:h}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(_>0||C>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;o.borderRadius=T}else if(this instanceof G_){const T=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;o.borderRadius=T}switch(e.borderStyle.style){case Sa.SOLID:o.borderStyle="solid";break;case Sa.DASHED:o.borderStyle="dashed";break;case Sa.BEVELED:Rt("Unimplemented border style: beveled");break;case Sa.INSET:Rt("Unimplemented border style: inset");break;case Sa.UNDERLINE:o.borderBottomStyle="solid";break}const w=e.borderColor||null;w?(this.#e=!0,o.borderColor=ut.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):o.borderWidth=0}const f=ut.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:g,pageHeight:p,pageX:v,pageY:b}=s.rawDims;o.left=`${100*(f[0]-v)/g}%`,o.top=`${100*(f[1]-b)/p}%`;const{rotation:S}=e;return e.hasOwnCanvas||S===0?(o.width=`${100*c/g}%`,o.height=`${100*h/p}%`):this.setRotation(S,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:o}=this;t%180!==0&&([r,o]=[o,r]),e.style.width=`${100*r/i}%`,e.style.height=`${100*o/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const r=s.detail[e],o=r[0],c=r.slice(1);s.target.style[i]=cb[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[i]:cb[`${o}_rgb`](c)})};return Nt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||i[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,r]of Object.entries(e)){const o=i[s];if(o){const c={detail:{[s]:r},target:t};o(c),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,r]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,C,w,T]=t.subarray(2,6);if(s===_&&r===C&&e===w&&i===T)return}const{style:o}=this.container;let c;if(this.#e){const{borderColor:_,borderWidth:C}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=s-e,f=r-i,{svgFactory:g}=this,p=g.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const v=g.createElement("defs");p.append(v);const b=g.createElement("clipPath"),S=`clippath_${this.data.id}`;b.setAttribute("id",S),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let _=2,C=t.length;_<C;_+=8){const w=t[_],T=t[_+1],E=t[_+2],D=t[_+3],M=g.createElement("rect"),O=(E-e)/h,R=(r-T)/f,j=(w-E)/h,G=(T-D)/f;M.setAttribute("x",O),M.setAttribute("y",R),M.setAttribute("width",j),M.setAttribute("height",G),b.append(M),c?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${R}" width="${j}" height="${G}"/>`)}this.#e&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(p),this.container.style.clipPath=`url(#${S})`}_createPopup(t=null){const{data:e}=this;let i,s;t?(i={str:t.text},s=t.date):(i=e.contentsObj,s=e.modificationDate);const r=this.#s=new wg({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(r.render())}get hasPopupElement(){return!!(this.#s||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#s}render(){ae("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:r,id:o,exportValues:c}of s){if(r===-1||o===e)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${o}"]`);if(f&&!Er.has(f)){Rt(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:h,domElement:f})}return i}for(const s of document.getElementsByName(t)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==e&&Er.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class lA extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class rp extends ye{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#s(i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#s(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const r=i.get(s);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Rt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:s,refs:r,include:o}=e,c=[];if(s.length!==0||r.length!==0){const g=new Set(r);for(const p of s){const v=this._fieldObjects[p]||[];for(const{id:b}of v)g.add(b)}for(const p of Object.values(this._fieldObjects))for(const v of p)g.has(v.id)===o&&c.push(v)}else for(const g of Object.values(this._fieldObjects))c.push(...g);const h=this.annotationStorage,f=[];for(const g of c){const{id:p}=g;switch(f.push(p),g.type){case"text":{const b=g.defaultValue||"";h.setValue(p,{value:b});break}case"checkbox":case"radiobutton":{const b=g.defaultValue===g.exportValues;h.setValue(p,{value:b});break}case"combobox":case"listbox":{const b=g.defaultValue||"";h.setValue(p,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${p}"]`);if(v){if(!Er.has(v)){Rt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class cA extends ye{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class kr extends ye{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ie.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,r){i.includes("mouse")?t.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(i,o=>{if(i==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}})})}_setEventListeners(t,e,i,s){for(const[r,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ut.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||aA,r=t.style;let o;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(Wf*s))||1,p=f/g;o=Math.min(s,h(p/Wf))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(s,h(f/Wf))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=ut.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class hA extends kr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=i),r.setValue(o.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let r=s.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&r.length>o&&(r=r.slice(0,o));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:r,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Er.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:p}=this.data,v=!!g&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(i,"value",S.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",S=>{const _=this.data.defaultFieldValue??"";i.value=h.userValue=_,h.formattedValue=null});let b=S=>{const{formattedValue:_}=h;_!=null&&(S.target.value=_),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",_=>{if(h.focused)return;const{target:C}=_;if(v&&(C.type=g,p&&(C.step=p)),h.userValue){const w=h.userValue;if(v)if(g==="time"){const T=new Date(w),E=[T.getHours(),T.getMinutes(),T.getSeconds()];C.value=E.map(D=>D.toString().padStart(2,"0")).join(":")}else C.value=new Date(w-oA).toISOString().split(g==="date"?"T":".",1)[0];else C.value=w}h.lastCommittedValue=C.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const C={value(w){h.userValue=w.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:T}=w.detail;h.formattedValue=T,T!=null&&w.target!==document.activeElement&&(w.target.value=T);const E={formattedValue:T};v&&(E.value=T),t.setValue(e,E)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:T}=w.detail,{target:E}=w;if(T===0){E.removeAttribute("maxLength");return}E.setAttribute("maxLength",T);let D=h.userValue;!D||D.length<=T||(D=D.slice(0,T),E.value=h.userValue=D,t.setValue(e,{value:D}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:E.selectionStart,selEnd:E.selectionEnd}}))}};this._dispatchEventFromSandbox(C,_)}),i.addEventListener("keydown",_=>{h.commitKey=1;let C=-1;if(_.key==="Escape"?C=0:_.key==="Enter"&&!this.data.multiLine?C=2:_.key==="Tab"&&(h.commitKey=3),C===-1)return;const{value:w}=_.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,willCommit:!0,commitKey:C,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const S=b;b=null,i.addEventListener("blur",_=>{if(!h.focused||!_.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:C}=_;let{value:w}=C;if(v){if(w&&g==="time"){const T=w.split(":").map(E=>parseInt(E,10));w=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),C.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();C.type="text"}h.userValue=w,h.lastCommittedValue!==w&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,willCommit:!0,commitKey:h.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),S(_)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",_=>{h.lastCommittedValue=null;const{data:C,target:w}=_,{value:T,selectionStart:E,selectionEnd:D}=w;let M=E,O=D;switch(_.inputType){case"deleteWordBackward":{const R=T.substring(0,E).match(/\w*[^\w]*$/);R&&(M-=R[0].length);break}case"deleteWordForward":{const R=T.substring(E).match(/^[^\w]*\w*/);R&&(O+=R[0].length);break}case"deleteContentBackward":E===D&&(M-=1);break;case"deleteContentForward":E===D&&(O+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,change:C||"",willCommit:!1,selStart:M,selEnd:O}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(b&&i.addEventListener("blur",b),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class uA extends kr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class dA extends kr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Er.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const f of this._getElementsByName(c,i)){const g=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(i,{value:h})}),r.addEventListener("resetform",o=>{const c=e.defaultFieldValue||"Off";o.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class G_ extends kr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const o of this._getElementsByName(e.fieldName,i))t.setValue(o.id,{value:!1});const r=document.createElement("input");if(Er.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",o=>{const{name:c,checked:h}=o.target;for(const f of this._getElementsByName(c,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:h})}),r.addEventListener("resetform",o=>{const c=e.defaultFieldValue;o.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;r.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=o===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const v=g&&p.id===i;p.domElement&&(p.domElement.checked=v),t.setValue(p.id,{value:v})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class fA extends rp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class gA extends kr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Er.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const p=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===p});for(const g of this.data.options){const p=document.createElement("option");p.textContent=g.displayValue,p.value=g.exportValue,i.value.includes(g.exportValue)&&(p.setAttribute("selected",!0),r=!1),s.append(p)}let o=null;if(r){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),o=()=>{g.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const c=g=>{const p=g?"value":"textContent",{options:v,multiple:b}=s;return b?Array.prototype.filter.call(v,S=>S.selected).map(S=>S[p]):v.selectedIndex===-1?null:v[v.selectedIndex][p]};let h=c(!1);const f=g=>{const p=g.target.options;return Array.prototype.map.call(p,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const p={value(v){o?.();const b=v.detail.value,S=new Set(Array.isArray(b)?b:[b]);for(const _ of s.options)_.selected=S.has(_.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(v){s.multiple=!0},remove(v){const b=s.options,S=v.detail.remove;b[S].selected=!1,s.remove(S),b.length>0&&Array.prototype.findIndex.call(b,C=>C.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},clear(v){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(v){const{index:b,displayValue:S,exportValue:_}=v.detail.insert,C=s.children[b],w=document.createElement("option");w.textContent=S,w.value=_,C?C.before(w):s.append(w),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},items(v){const{items:b}=v.detail;for(;s.length!==0;)s.remove(0);for(const S of b){const{displayValue:_,exportValue:C}=S,w=document.createElement("option");w.textContent=_,w.value=C,s.append(w)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},indices(v){const b=new Set(v.detail.indices);for(const S of v.target.options)S.selected=b.has(S.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(p,g)}),s.addEventListener("input",g=>{const p=c(!0),v=c(!1);t.setValue(e,{value:p}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class wg extends ye{constructor(t){const{data:e,elements:i,parent:s}=t,r=!!s._commentManager;if(super(t,{isRenderable:!r&&ye._hasPopupData(e)}),this.elements=i,r&&ye._hasPopupData(e)){const o=this.popup=this.#t();for(const c of i)c.popup=o}else this.popup=null}#t(){return new pA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Yg}${s}`).join(",")),this.container}}class pA{#t=null;#e=this.#V.bind(this);#s=this.#z.bind(this);#i=this.#L.bind(this);#a=this.#S.bind(this);#n=null;#r=null;#o=null;#c=null;#l=null;#d=null;#u=null;#f=!1;#m=null;#g=null;#h=null;#p=null;#y=null;#b=null;#v=null;#A=null;#w=null;#_=null;#E=!1;#x=null;#C=null;constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:c,parent:h,rect:f,parentRect:g,open:p,commentManager:v=null}){this.#r=t,this.#w=s,this.#o=o,this.#A=c,this.#d=h,this.#n=e,this.#v=f,this.#u=g,this.#l=i,this.#t=v,this.#x=i[0],this.#c=Hh.toDateObject(r),this.trigger=i.flatMap(b=>b.getElementsToTriggerPopup()),v?this.renderCommentButton():(this.#O(),this.#r.hidden=!0,p&&this.#S())}#O(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#s,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#D(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p||(this.#y||this.#D(),!this.#y))return;const{signal:t}=this.#g=new AbortController,e=!!this.#x.extraPopupElement,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},s=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#x.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",r,{signal:t}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const c=this.#x.container;o.style.zIndex=c.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#F(),this.#M(),o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",r,{signal:t}),c.after(o)}}#M(){if(this.#x.extraPopupElement&&!this.#x.editor)return;this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#F(){this.#x.extraPopupElement||(this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#x.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:s,modificationDate:r}=this.#x.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:s,modificationDate:r}}get elementBeforePopup(){return this.#p}get comment(){return this.#C||=this.#x.commentText,this.#C}set comment(t){t!==this.comment&&(this.#x.commentText=this.#C=t)}get parentBoundingClientRect(){return this.#x.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:s,y:r,width:o,height:c}=this.#x.layer.getBoundingClientRect();return[(t-s)/o,(e+i-r)/c]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#b||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:r,y:o,width:c,height:h}=s;this.#t.showDialog(null,this,r+e*c,o+i*h,{...t,parentDimensions:s})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#n){const i=t.style.outlineColor=ut.makeHexColor(...this.#n);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#w?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#w}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}Wg({html:this.#R||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#R(){const t=this.#A,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#A.html||null}get#P(){return this.#R?.attributes?.style?.fontSize||0}get#j(){return this.#R?.attributes?.style?.color||null}#B(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#j,fontSize:this.#P?`calc(${this.#P}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:s});return i}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#C=null):e&&(e.deleted?this.remove():(this.#F(),this.#C=e.text)),t&&(this.#y=null,this.#D(),this.#M());return}if(i||e?.deleted){this.remove();return}this.#O(),this.#_||={contentsObj:this.#o,richText:this.#A},t&&(this.#h=null),e&&e.text&&(this.#A=this.#B(e.text),this.#c=Hh.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#_&&({contentsObj:this.#o,richText:this.#A}=this.#_,this.#_=null,this.#m?.remove(),this.#m=null,this.#h=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#E=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:r}}}=this.#d;let o=!!this.#u,c=o?this.#u:this.#v;for(const S of this.#l)if(!c||ut.intersect(S.data.rect,c)!==null){c=S.data.rect,o=!0;break}const h=ut.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),g=o?c[2]-c[0]+5:0,p=h[0]+g,v=h[1];this.#h=[100*(p-s)/e,100*(v-r)/i];const{style:b}=this.#r;b.left=`${this.#h[0]}%`,b.top=`${this.#h[1]}%`}#S(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#z(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#T(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#z(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#E=this.isVisible,this.#E&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#O(),this.#E&&(this.#m||this.#L(),this.#E=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class V_ extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=kt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class mA extends ye{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),s.append(r),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class yA extends ye{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",e-r),o.setAttribute("height",i-r),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class vA extends ye{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-r/2),o.setAttribute("ry",i/2-r/2),o.setAttribute("stroke-width",r||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class X_ extends ye{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:s},width:r,height:o}=this;if(!e)return this.container;const c=this.svgFactory.create(r,o,!0);let h=[];for(let g=0,p=e.length;g<p;g+=2){const v=e[g]-t[0],b=t[3]-e[g+1];h.push(`${v},${b}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class bA extends X_{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _A extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ap extends ye{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?kt.HIGHLIGHT:kt.INK}#s(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:s,popupRef:r}}=this,{transform:o,width:c,height:h}=this.#s(e,t),f=this.svgFactory.create(c,h,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",o);for(let p=0,v=i.length;p<v;p++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",i[p].join(",")),g.append(b)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:s}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),i)for(let o=0,c=this.#e.length;o<c;o++)this.#e[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:c,height:h}=this.#s(this.data.rotation,s);r.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),r.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Y_ extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=kt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class SA extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class xA extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class wA extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class q_ extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=kt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class CA extends ye{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:s}=Ie.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(s?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let op=class W_{#t=null;#e=null;#s=null;#i=new Map;#a=null;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:g}){this.div=t,this.#t=e,this.#e=i,this.#a=c||null,this.#n=f||null,this.#s=g||new Qg,this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async#r(t,e,i){const s=t.firstChild||t,r=s.id=`${Yg}${e}`,o=await this.#a?.getAriaAttributes(r);if(o)for(const[c,h]of o)s.setAttribute(c,h);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1))}async render(t){const{annotations:e}=t,i=this.div;Xn(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:this.#n,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ml,annotationStorage:this.#s,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const c=o.annotationType===xe.POPUP;if(c){const g=s.get(o.id);if(!g)continue;r.elements=g}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;r.data=o;const h=hb.create(r);if(!h.isRenderable)continue;if(!c&&o.popupRef){const g=s.get(o.popupRef);g?g.push(h):s.set(o.popupRef,[h])}const f=h.render();o.hidden&&(f.style.visibility="hidden"),await this.#r(f,o.id,r.elements),h.extraPopupElement?.popup?.renderCommentButton(),h._isEditable&&(this.#i.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#n,svgFactory:new ml,parent:this};for(const i of t){i.borderStyle||=W_._defaultBorderStyle,e.data=i;const s=hb.create(e);if(!s.isRenderable)continue;const r=s.render();await this.#r(r,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,Xn(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i);const o=this.#i.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:s}=t,r=new lA({data:{id:i,rect:t.getPDFRect(),rotation:s},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#n,annotationStorage:this.#s}),o=r.render();return e.append(o),this.#t?.moveElementInDOM(e,o,o,!1),r.createOrUpdatePopup(),r}static get _defaultBorderStyle(){return Nt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Sa.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const ah=/\r\n?|\n/g;class je extends xt{#t="";#e=`${this.id}-editor`;#s=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=je.prototype,e=r=>r.isEmpty(),i=on.TRANSLATE_SMALL,s=on.TRANSLATE_BIG;return Nt(this,"_keyboardManager",new El([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=kt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||je._defaultColor||xt._defaultLineColor,this.#i=t.fontSize||je._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){xt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Ut.FREETEXT_SIZE:je._defaultFontSize=e;break;case Ut.FREETEXT_COLOR:je._defaultColor=e;break}}updateParams(t,e){switch(t){case Ut.FREETEXT_SIZE:this.#a(e);break;case Ut.FREETEXT_COLOR:this.#n(e);break}}static get defaultPropertiesToUpdate(){return[[Ut.FREETEXT_SIZE,je._defaultFontSize],[Ut.FREETEXT_COLOR,je._defaultColor||xt._defaultLineColor]]}get propertiesToUpdate(){return[[Ut.FREETEXT_SIZE,this.#i],[Ut.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new pl(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ut.FREETEXT_COLOR}#a(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#i)*this.parentScale),this.#i=s,this.#o()},i=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#n(t){const e=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-je._internalPadding*t,-(je._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const t=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(je.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:r}=this,o=r.style.display,c=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",s.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=o,r.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const i=s=>{if(this.#t=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){je._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,r]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,g]=this.pageDimensions,[p,v]=this.pageTranslation;let b,S;switch(this.rotation){case 0:b=t+(o[0]-p)/f,S=e+this.height-(o[1]-v)/g;break;case 90:b=t+(o[0]-p)/f,S=e-(o[1]-v)/g,[c,h]=[h,-c];break;case 180:b=t-this.width+(o[0]-p)/f,S=e-(o[1]-v)/g,[c,h]=[-c,-h];break;case 270:b=t+(o[0]-p-this.height*g)/f,S=e+(o[1]-v-this.width*f)/g,[c,h]=[-h,c];break}this.setAt(b*s,S*r,c,h)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ah,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=je.#u(e.getData("text")||"").replaceAll(ah,`
`);if(!s)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const o=r.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:c,startOffset:h}=o,f=[],g=[];if(c.nodeType===Node.TEXT_NODE){const b=c.parentElement;if(g.push(c.nodeValue.slice(h).replaceAll(ah,"")),b!==this.editorDiv){let S=f;for(const _ of this.editorDiv.childNodes){if(_===b){S=g;continue}S.push(je.#c(_))}}f.push(c.nodeValue.slice(0,h).replaceAll(ah,""))}else if(c===this.editorDiv){let b=f,S=0;for(const _ of this.editorDiv.childNodes)S++===h&&(b=g),b.push(je.#c(_))}this.#t=`${f.join(`
`)}${s}${g.join(`
`)}`,this.#l();const p=new Range;let v=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const S=b.nodeValue.length;if(v<=S){p.setStart(b,v),p.setEnd(b,v);break}v-=S}r.removeAllRanges(),r.addRange(p)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#u(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=je._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let s=null;if(t instanceof V_){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:h,rotation:f,id:g,popupRef:p,richText:v,contentsObj:b,creationDate:S,modificationDate:_},textContent:C,textPosition:w,parent:{page:{pageNumber:T}}}=t;if(!C||C.length===0)return null;s=t={annotationType:kt.FREETEXT,color:Array.from(c),fontSize:o,value:C.join(`
`),position:w,pageIndex:T-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:p,comment:b?.str||null,richText:v,creationDate:S,modificationDate:_}}const r=await super.deserialize(t,e,i);return r.#i=t.fontSize,r.color=ut.makeHexColor(...t.color),r.#t=je.#u(t.value),r._initialData=s,t.comment&&r.setCommentData(t),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=xt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((o,c)=>o!==s[c])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const s of this.#t.split(`
`)){const r=document.createElement("div");r.append(s?document.createTextNode(s):document.createElement("br")),e.append(r)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class ht{static PRECISION=1e-4;toSVGPath(){ae("Abstract method `toSVGPath` must be implemented.")}get box(){ae("Abstract getter `box` must be implemented.")}serialize(t,e){ae("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,s,r,o){o||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)o[c]=e+t[c]*s,o[c+1]=i+t[c+1]*r;return o}static _rescaleAndSwap(t,e,i,s,r,o){o||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)o[c]=e+t[c+1]*s,o[c+1]=i+t[c]*r;return o}static _translate(t,e,i,s){s||=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r+=2)s[r]=e+t[r],s[r+1]=i+t[r+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,s,r){switch(r){case 90:return[1-e/i,t/s];case 180:return[1-t/i,1-e/s];case 270:return[e/i,1-t/s];default:return[t/i,e/s]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,s,r,o){return[(t+5*i)/6,(e+5*s)/6,(5*i+r)/6,(5*s+o)/6,(i+r)/2,(s+o)/2]}}class vr{#t;#e=[];#s;#i;#a=[];#n=new Float32Array(18);#r;#o;#c;#l;#d;#u;#f=[];static#m=8;static#g=2;static#h=vr.#m+vr.#g;constructor({x:t,y:e},i,s,r,o,c=0){this.#t=i,this.#u=r*s,this.#i=o,this.#n.set([NaN,NaN,NaN,NaN,t,e],6),this.#s=c,this.#l=vr.#m*s,this.#c=vr.#h*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#n[8])}#p(){const t=this.#n.subarray(4,6),e=this.#n.subarray(16,18),[i,s,r,o]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/r,(this.#o+(t[1]-e[1])/2-s)/o,(this.#r+(e[0]-t[0])/2-i)/r,(this.#o+(e[1]-t[1])/2-s)/o]}add({x:t,y:e}){this.#r=t,this.#o=e;const[i,s,r,o]=this.#t;let[c,h,f,g]=this.#n.subarray(8,12);const p=t-f,v=e-g,b=Math.hypot(p,v);if(b<this.#c)return!1;const S=b-this.#l,_=S/b,C=_*p,w=_*v;let T=c,E=h;c=f,h=g,f+=C,g+=w,this.#f?.push(t,e);const D=-w/S,M=C/S,O=D*this.#u,R=M*this.#u;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([f+O,g+R],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([f-O,g-R],16),isNaN(this.#n[6])?(this.#a.length===0&&(this.#n.set([c+O,h+R],2),this.#a.push(NaN,NaN,NaN,NaN,(c+O-i)/r,(h+R-s)/o),this.#n.set([c-O,h-R],14),this.#e.push(NaN,NaN,NaN,NaN,(c-O-i)/r,(h-R-s)/o)),this.#n.set([T,E,c,h,f,g],6),!this.isEmpty()):(this.#n.set([T,E,c,h,f,g],6),Math.abs(Math.atan2(E-h,T-c)-Math.atan2(w,C))<Math.PI/2?([c,h,f,g]=this.#n.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+f)/2-i)/r,((h+g)/2-s)/o),[c,h,T,E]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((T+c)/2-i)/r,((E+h)/2-s)/o),!0):([T,E,c,h,f,g]=this.#n.subarray(0,6),this.#a.push(((T+5*c)/6-i)/r,((E+5*h)/6-s)/o,((5*c+f)/6-i)/r,((5*h+g)/6-s)/o,((c+f)/2-i)/r,((h+g)/2-s)/o),[f,g,c,h,T,E]=this.#n.subarray(12,18),this.#e.push(((T+5*c)/6-i)/r,((E+5*h)/6-s)/o,((5*c+f)/6-i)/r,((5*h+g)/6-s)/o,((c+f)/2-i)/r,((h+g)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#v(i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#b(i),i.join(" ")}#y(){const[t,e,i,s]=this.#t,[r,o,c,h]=this.#p();return`M${(this.#n[2]-t)/i} ${(this.#n[3]-e)/s} L${(this.#n[4]-t)/i} ${(this.#n[5]-e)/s} L${r} ${o} L${c} ${h} L${(this.#n[16]-t)/i} ${(this.#n[17]-e)/s} L${(this.#n[14]-t)/i} ${(this.#n[15]-e)/s} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#v(t){const[e,i,s,r]=this.#t,o=this.#n.subarray(4,6),c=this.#n.subarray(16,18),[h,f,g,p]=this.#p();t.push(`L${(o[0]-e)/s} ${(o[1]-i)/r} L${h} ${f} L${g} ${p} L${(c[0]-e)/s} ${(c[1]-i)/r}`)}newFreeDrawOutline(t,e,i,s,r,o){return new K_(t,e,i,s,r,o)}getOutlines(){const t=this.#a,e=this.#e,i=this.#n,[s,r,o,c]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let p=0,v=h.length-2;p<v;p+=2)h[p]=(this.#f[p]-s)/o,h[p+1]=(this.#f[p+1]-r)/c;if(h[h.length-2]=(this.#r-s)/o,h[h.length-1]=(this.#o-r)/c,isNaN(i[6])&&!this.isEmpty())return this.#A(h);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let p=0;p<g;p+=2){if(isNaN(t[p])){f[p]=f[p+1]=NaN;continue}f[p]=t[p],f[p+1]=t[p+1]}g=this.#_(f,g);for(let p=e.length-6;p>=6;p-=6)for(let v=0;v<6;v+=2){if(isNaN(e[p+v])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[p+v],f[g+1]=e[p+v+1],g+=2}return this.#w(f,g),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#s,this.#i)}#A(t){const e=this.#n,[i,s,r,o]=this.#t,[c,h,f,g]=this.#p(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/r,(e[3]-s)/o,NaN,NaN,NaN,NaN,(e[4]-i)/r,(e[5]-s)/o,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-i)/r,(e[17]-s)/o,NaN,NaN,NaN,NaN,(e[14]-i)/r,(e[15]-s)/o],0),this.newFreeDrawOutline(p,t,this.#t,this.#d,this.#s,this.#i)}#w(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#_(t,e){const i=this.#n.subarray(4,6),s=this.#n.subarray(16,18),[r,o,c,h]=this.#t,[f,g,p,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-r)/c,(i[1]-o)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,p,v,NaN,NaN,NaN,NaN,(s[0]-r)/c,(s[1]-o)/h],e),e+=24}}class K_ extends ht{#t;#e=new Float32Array(4);#s;#i;#a;#n;#r;constructor(t,e,i,s,r,o){super(),this.#r=t,this.#a=e,this.#t=i,this.#n=s,this.#s=r,this.#i=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[c,h,f,g]=this.#e;for(let p=0,v=t.length;p<v;p+=2)t[p]=(t[p]-c)/f,t[p+1]=(t[p+1]-h)/g;for(let p=0,v=e.length;p<v;p+=2)e[p]=(e[p]-c)/f,e[p+1]=(e[p+1]-h)/g}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,s],r){const o=i-t,c=s-e;let h,f;switch(r){case 0:h=ht._rescale(this.#r,t,s,o,-c),f=ht._rescale(this.#a,t,s,o,-c);break;case 90:h=ht._rescaleAndSwap(this.#r,t,e,o,c),f=ht._rescaleAndSwap(this.#a,t,e,o,c);break;case 180:h=ht._rescale(this.#r,i,e,-o,c),f=ht._rescale(this.#a,i,e,-o,c);break;case 270:h=ht._rescaleAndSwap(this.#r,i,s,-o,-c),f=ht._rescaleAndSwap(this.#a,i,s,-o,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#r;let i=e[4],s=e[5];const r=[i,s,i,s];let o=i,c=s,h=i,f=s;const g=t?Math.max:Math.min,p=new Float32Array(4);for(let b=6,S=e.length;b<S;b+=6){const _=e[b+4],C=e[b+5];isNaN(e[b])?(ut.pointBoundingBox(_,C,r),c>C?(o=_,c=C):c===C&&(o=g(o,_)),f<C?(h=_,f=C):f===C&&(h=g(h,_))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,ut.bezierBoundingBox(i,s,...e.slice(b,b+6),p),ut.rectBoundingBox(p[0],p[1],p[2],p[3],r),c>p[1]?(o=p[0],c=p[1]):c===p[1]&&(o=g(o,p[0])),f<p[3]?(h=p[2],f=p[3]):f===p[3]&&(h=g(h,p[2]))),i=_,s=C}const v=this.#e;v[0]=r[0]-this.#s,v[1]=r[1]-this.#s,v[2]=r[2]-r[0]+2*this.#s,v[3]=r[3]-r[1]+2*this.#s,this.firstPoint=[o,c],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,e,i,s,r,o=0){return new vr(t,e,i,s,r,o)}getNewOutline(t,e){const[i,s,r,o]=this.#e,[c,h,f,g]=this.#t,p=r*f,v=o*g,b=i*f+c,S=s*g+h,_=this.newOutliner({x:this.#a[0]*p+b,y:this.#a[1]*v+S},this.#t,this.#n,t,this.#i,e??this.#s);for(let C=2;C<this.#a.length;C+=2)_.add({x:this.#a[C]*p+b,y:this.#a[C+1]*v+S});return _.getOutlines()}}class Cg{#t;#e;#s;#i=[];#a=[];constructor(t,e=0,i=0,s=!0){const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:C,width:w,height:T}of t){const E=Math.floor((_-e)/o)*o,D=Math.ceil((_+w+e)/o)*o,M=Math.floor((C-e)/o)*o,O=Math.ceil((C+T+e)/o)*o,R=[E,M,O,!0],j=[D,M,O,!1];this.#i.push(R,j),ut.rectBoundingBox(E,M,D,O,r)}const c=r[2]-r[0]+2*i,h=r[3]-r[1]+2*i,f=r[0]-i,g=r[1]-i;let p=s?-1/0:1/0,v=1/0;const b=this.#i.at(s?-1:-2),S=[b[0],b[2]];for(const _ of this.#i){const[C,w,T,E]=_;!E&&s?w<v?(v=w,p=C):w===v&&(p=Math.max(p,C)):E&&!s&&(w<v?(v=w,p=C):w===v&&(p=Math.min(p,C))),_[0]=(C-f)/c,_[1]=(w-g)/h,_[2]=(T-g)/h}this.#t=new Float32Array([f,g,c,h]),this.#e=[p,v],this.#s=S}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#n(t)}#n(t){const e=[],i=new Set;for(const o of t){const[c,h,f]=o;e.push([c,h,o],[c,f,o])}e.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=e.length;o<c;o+=2){const h=e[o][2],f=e[o+1][2];h.push(f),f.push(h),i.add(h),i.add(f)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[c,h,f,g,p]=o;i.delete(o);let v=c,b=h;for(r=[c,f],s.push(r);;){let S;if(i.has(g))S=g;else if(i.has(p))S=p;else break;i.delete(S),[c,h,f,g,p]=S,v!==c&&(r.push(v,b,c,b===h?h:f),v=c),b=b===h?f:h}r.push(v,b)}return new AA(s,this.#t,this.#e,this.#s)}#r(t){const e=this.#a;let i=0,s=e.length-1;for(;i<=s;){const r=i+s>>1,o=e[r][0];if(o===t)return r;o<t?i=r+1:s=r-1}return s+1}#o([,t,e]){const i=this.#r(t);this.#a.splice(i,0,[t,e])}#c([,t,e]){const i=this.#r(t);for(let s=i;s<this.#a.length;s++){const[r,o]=this.#a[s];if(r!==t)break;if(r===t&&o===e){this.#a.splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=this.#a[s];if(r!==t)break;if(r===t&&o===e){this.#a.splice(s,1);return}}}#l(t){const[e,i,s]=t,r=[[e,i,s]],o=this.#r(s);for(let c=0;c<o;c++){const[h,f]=this.#a[c];for(let g=0,p=r.length;g<p;g++){const[,v,b]=r[g];if(!(f<=v||b<=h)){if(v>=h){if(b>f)r[g][1]=f;else{if(p===1)return[];r.splice(g,1),g--,p--}continue}r[g][2]=h,b>f&&r.push([e,f,b])}}}return r}}class AA extends ht{#t;#e;constructor(t,e,i,s){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[i,s]=e;t.push(`M${i} ${s}`);for(let r=2;r<e.length;r+=2){const o=e[r],c=e[r+1];o===i?(t.push(`V${c}`),s=c):c===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,e,i,s],r){const o=[],c=i-t,h=s-e;for(const f of this.#e){const g=new Array(f.length);for(let p=0;p<f.length;p+=2)g[p]=t+f[p]*c,g[p+1]=s-f[p+1]*h;o.push(g)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Ag extends vr{newFreeDrawOutline(t,e,i,s,r,o){return new TA(t,e,i,s,r,o)}}class TA extends K_{newOutliner(t,e,i,s,r,o=0){return new Ag(t,e,i,s,r,o)}}class we extends xt{#t=null;#e=0;#s;#i=null;#a=null;#n=null;#r=null;#o=0;#c=null;#l=null;#d=null;#u=!1;#f=null;#m=null;#g=null;#h="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=kt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=we.prototype;return Nt(this,"_keyboardManager",new El([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||we._defaultColor,this.#p=t.thickness||we._defaultThickness,this.opacity=t.opacity||we._defaultOpacity,this.#s=t.boxes||null,this.#y=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#v(t),this.#x()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#x(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Cg(this.#s,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Cg(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#n=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:s}=this.#n;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const s=1.5;if(this.#n=t.getNewOutline(this.#p/2+s,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:we.#C(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:we.#C(this.#n.box,p),path:{d:this.#n.toSVGPath()}})}const[r,o,c,h]=t.box;switch(this.rotation){case 0:this.x=r,this.y=o,this.width=c,this.height=h;break;case 90:{const[p,v]=this.parentDimensions;this.x=o,this.y=1-r,this.width=c*v/p,this.height=h*p/v;break}case 180:this.x=1-r,this.y=1-o,this.width=c,this.height=h;break;case 270:{const[p,v]=this.parentDimensions;this.x=1-o,this.y=r,this.width=c*v/p,this.height=h*p/v;break}}const{firstPoint:f}=t;this.#f=[(f[0]-r)/c,(f[1]-o)/h];const{lastPoint:g}=this.#n;this.#m=[(g[0]-r)/c,(g[1]-o)/h]}static initialize(t,e){xt.initialize(t,e),we._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Ut.HIGHLIGHT_COLOR:we._defaultColor=e;break;case Ut.HIGHLIGHT_THICKNESS:we._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Ut.HIGHLIGHT_COLOR:this.#A(e);break;case Ut.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Ut.HIGHLIGHT_COLOR,we._defaultColor],[Ut.HIGHLIGHT_THICKNESS,we._defaultThickness]]}get propertiesToUpdate(){return[[Ut.HIGHLIGHT_COLOR,this.color||we._defaultColor],[Ut.HIGHLIGHT_THICKNESS,this.#p||we._defaultThickness],[Ut.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#A(t){const e=(r,o)=>{this.color=r,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:e.bind(this,t,we._defaultOpacity),undo:e.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const e=this.#p,i=s=>{this.#p=s,this.#_(s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ut.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Li({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#E(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#x(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#E():t&&(this.#x(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#_(t){this.#u&&(this.#v({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#E(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#x(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#i))}static#C([t,e,i,s],r){switch(r){case 90:return[1-e-s,t,s,i];case 180:return[1-t-i,1-e-s,i,s];case 270:return[e,1-t-i,s,i]}return[t,e,i,s]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=we.#C(this.#l.box,t)):i=we.#C([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#g,{bbox:we.#C(this.#n.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#O.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(this.width,this.height),C_(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#O(t){we._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#D(!0);break;case 1:case 3:this.#D(!1);break}}#D(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#u||this.#D(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#M(){return this.#u?this.rotation:0}#F(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,s]=this.pageTranslation,r=this.#s,o=new Float32Array(r.length*8);let c=0;for(const{x:h,y:f,width:g,height:p}of r){const v=h*t+i,b=(1-f)*e+s;o[c]=o[c+4]=v,o[c+1]=o[c+3]=b,o[c+2]=o[c+6]=v+g*t,o[c+5]=o[c+7]=b-p*e,c+=8}return o}#R(t){return this.#l.serialize(t,this.#M())}static startHighlighting(t,e,{target:i,x:s,y:r}){const{x:o,y:c,width:h,height:f}=i.getBoundingClientRect(),g=new AbortController,p=t.combinedSignal(g),v=b=>{g.abort(),this.#j(t,b)};window.addEventListener("blur",v,{signal:p}),window.addEventListener("pointerup",v,{signal:p}),window.addEventListener("pointerdown",me,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Bi,{signal:p}),i.addEventListener("pointermove",this.#P.bind(this,t),{signal:p}),this._freeHighlight=new Ag({x:s,y:r},[o,c,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#P(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let s=null;if(t instanceof Y_){const{data:{quadPoints:S,rect:_,rotation:C,id:w,color:T,opacity:E,popupRef:D,richText:M,contentsObj:O,creationDate:R,modificationDate:j},parent:{page:{pageNumber:G}}}=t;s=t={annotationType:kt.HIGHLIGHT,color:Array.from(T),opacity:E,quadPoints:S,boxes:null,pageIndex:G-1,rect:_.slice(0),rotation:C,annotationElementId:w,id:w,deleted:!1,popupRef:D,richText:M,comment:O?.str||null,creationDate:R,modificationDate:j}}else if(t instanceof ap){const{data:{inkLists:S,rect:_,rotation:C,id:w,color:T,borderStyle:{rawWidth:E},popupRef:D,richText:M,contentsObj:O,creationDate:R,modificationDate:j},parent:{page:{pageNumber:G}}}=t;s=t={annotationType:kt.HIGHLIGHT,color:Array.from(T),thickness:E,inkLists:S,boxes:null,pageIndex:G-1,rect:_.slice(0),rotation:C,annotationElementId:w,id:w,deleted:!1,popupRef:D,richText:M,comment:O?.str||null,creationDate:R,modificationDate:j}}const{color:r,quadPoints:o,inkLists:c,opacity:h}=t,f=await super.deserialize(t,e,i);f.color=ut.makeHexColor(...r),f.opacity=h||1,c&&(f.#p=t.thickness),f._initialData=s,t.comment&&f.setCommentData(t);const[g,p]=f.pageDimensions,[v,b]=f.pageTranslation;if(o){const S=f.#s=[];for(let _=0;_<o.length;_+=8)S.push({x:(o[_]-v)/g,y:1-(o[_+1]-b)/p,width:(o[_+2]-o[_])/g,height:(o[_+1]-o[_+5])/p});f.#b(),f.#x(),f.rotate(f.rotation)}else if(c){f.#u=!0;const S=c[0],_={x:S[0]-v,y:p-(S[1]-b)},C=new Ag(_,[0,0,g,p],1,f.#p/2,!0,.001);for(let E=0,D=S.length;E<D;E+=2)_.x=S[E]-v,_.y=p-(S[E+1]-b),C.add(_);const{id:w,clipPathId:T}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#v({highlightOutlines:C.getOutlines(),highlightId:w,clipPathId:T}),f.#x(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=xt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#F(),outlines:this.#R(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#B(i)?null:(i.id=this.annotationElementId,i)}#B(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==e[s])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class $_{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){ae("Not implemented")}}class At extends xt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#i=null;static#a=null;static#n=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:i}=e.drawLayer.draw(At._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[s,r]of Object.entries(e))i.has(s)?Object.assign(t[s],r):t[s]=r;return t}static getDefaultDrawingOptions(t){ae("Not implemented")}static get typesMap(){ae("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(At.#s.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,e[s]]);return t}_updateProperty(t,e,i){const s=this._drawingOptions,r=s[e],o=c=>{s.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#g()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#g()),{bbox:this.#p()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#g(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,i,s]){const{parentDimensions:[r,o],rotation:c}=this;switch(c){case 90:return[e,1-t,i*(o/r),s*(r/o)];case 180:return[1-t,1-e,i,s];case 270:return[1-e,t,i*(o/r),s*(r/o)];default:return[t,e,i,s]}}#g(){const{x:t,y:e,width:i,height:s,parentDimensions:[r,o],rotation:c}=this;switch(c){case 90:return[1-e,t,i*(r/o),s*(o/r)];case 180:return[1-t,1-e,i,s];case 270:return[e,1-t,i*(r/o),s*(o/r)];default:return[t,e,i,s]}}#h(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#p(){const{x:t,y:e,width:i,height:s,rotation:r,parentRotation:o,parentDimensions:[c,h]}=this;switch((r*4+o)/90){case 1:return[1-e-s,t,s,i];case 2:return[1-t-i,1-e-s,i,s];case 3:return[e,1-t-i,s,i];case 4:return[t,e-i*(c/h),s*(h/c),i*(c/h)];case 5:return[1-e,t,i*(c/h),s*(h/c)];case 6:return[1-t-s*(h/c),1-e,s*(h/c),i*(c/h)];case 7:return[e-i*(c/h),1-t-s*(h/c),i*(c/h),s*(h/c)];case 8:return[t-i,e-s,i,s];case 9:return[1-e,t-i,s,i];case 10:return[1-t,1-e,i,s];case 11:return[e-s,1-t,s,i];case 12:return[t-s*(h/c),e,s*(h/c),i*(c/h)];case 13:return[1-e-i*(c/h),t-s*(h/c),i*(c/h),s*(h/c)];case 14:return[1-t,1-e-i*(c/h),s*(h/c),i*(c/h)];case 15:return[e,1-t,i*(c/h),s*(h/c)];default:return[t,e,i,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties({bbox:this.#p()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,s,r){ae("Not implemented")}static startDrawing(t,e,i,s){const{target:r,offsetX:o,offsetY:c,pointerId:h,pointerType:f}=s;if(At.#r&&At.#r!==f)return;const{viewport:{rotation:g}}=t,{width:p,height:v}=r.getBoundingClientRect(),b=At.#i=new AbortController,S=t.combinedSignal(b);if(At.#n||=h,At.#r??=f,window.addEventListener("pointerup",_=>{At.#n===_.pointerId?this._endDraw(_):At.#o?.delete(_.pointerId)},{signal:S}),window.addEventListener("pointercancel",_=>{At.#n===_.pointerId?this._currentParent.endDrawingSession():At.#o?.delete(_.pointerId)},{signal:S}),window.addEventListener("pointerdown",_=>{At.#r===_.pointerType&&((At.#o||=new Set).add(_.pointerId),At.#s.isCancellable()&&(At.#s.removeLastElement(),At.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",Bi,{signal:S}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),r.addEventListener("touchmove",_=>{_.timeStamp===At.#c&&me(_)},{signal:S}),t.toggleDrawing(),e._editorUndoBar?.hide(),At.#s){t.drawLayer.updateProperties(this._currentDrawId,At.#s.startNew(o,c,p,v,g));return}e.updateUIForDefaultProperties(this),At.#s=this.createDrawerInstance(o,c,p,v,g),At.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(At.#a.toSVGProperties(),At.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(At.#c=-1,!At.#s)return;const{offsetX:e,offsetY:i,pointerId:s}=t;if(At.#n===s){if(At.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,At.#s.add(e,i)),At.#c=t.timeStamp,me(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,At.#s=null,At.#a=null,At.#r=null,At.#c=NaN),At.#i&&(At.#i.abort(),At.#i=null,At.#n=NaN,At.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,At.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=At.#s,s=this._currentDrawId,r=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,i.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:Ut.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Ut.DRAW_STEP),!At.#s.isEmpty()){const{pageDimensions:[i,s],scale:r}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:At.#s.getOutlines(i*r,s*r,r,this._INNER_MARGIN),drawingOptions:At.#a,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,s,r,o){ae("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:c}}=e.viewport,h=this.deserializeDraw(o,c,s,r,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#l({drawOutlines:h}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[s,r]=this.pageDimensions;return this.#t.serialize([e,i,s,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class EA{#t=new Float64Array(6);#e;#s;#i;#a;#n;#r="";#o=0;#c=new Ol;#l;#d;constructor(t,e,i,s,r,o){this.#l=i,this.#d=s,this.#i=r,this.#a=o,[t,e]=this.#u(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e],this.#s=[{line:c,points:this.#n}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#u(t,e){return ht._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#n.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,s,r,o]=this.#t.subarray(2,6),c=t-r,h=e-o;return Math.hypot(this.#l*c,this.#d*h)<=2?null:(this.#n.push(t,e),isNaN(i)?(this.#t.set([r,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,s,r,o,t,e],0),this.#e.push(...ht.createBezierPoints(i,s,r,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,s,r){this.#l=i,this.#d=s,this.#i=r,[t,e]=this.#u(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#n=[t,e];const c=this.#s.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#s.push({line:o,points:this.#n}),this.#t.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#n=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#c.removeLastElement();this.#s.pop(),this.#r="";for(let t=0,e=this.#s.length;t<e;t++){const{line:i,points:s}=this.#s[t];this.#e=i,this.#n=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=ht.svgRound(this.#e[4]),e=ht.svgRound(this.#e[5]);if(this.#n.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#n.length<=6){const s=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#n.length===4){const s=ht.svgRound(this.#e[10]),r=ht.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${s} ${r}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,r=this.#e.length;s<r;s+=6){const[o,c,h,f,g,p]=this.#e.slice(s,s+6).map(ht.svgRound);i.push(`C${o} ${c} ${h} ${f} ${g} ${p}`)}return this.#r+=i.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,i,s){const r=this.#s.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#c.build(this.#s,t,e,i,this.#i,this.#a,s),this.#t=null,this.#e=null,this.#s=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Ol extends ht{#t;#e=0;#s;#i;#a;#n;#r;#o;#c;build(t,e,i,s,r,o,c){this.#a=e,this.#n=i,this.#r=s,this.#o=r,this.#c=o,this.#s=c??0,this.#i=t,this.#u()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${ht.svgRound(e[4])} ${ht.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${ht.svgRound(e[10])} ${ht.svgRound(e[11])}`);continue}for(let i=6,s=e.length;i<s;i+=6){const[r,o,c,h,f,g]=e.subarray(i,i+6).map(ht.svgRound);t.push(`C${r} ${o} ${c} ${h} ${f} ${g}`)}}return t.join("")}serialize([t,e,i,s],r){const o=[],c=[],[h,f,g,p]=this.#d();let v,b,S,_,C,w,T,E,D;switch(this.#o){case 0:D=ht._rescale,v=t,b=e+s,S=i,_=-s,C=t+h*i,w=e+(1-f-p)*s,T=t+(h+g)*i,E=e+(1-f)*s;break;case 90:D=ht._rescaleAndSwap,v=t,b=e,S=i,_=s,C=t+f*i,w=e+h*s,T=t+(f+p)*i,E=e+(h+g)*s;break;case 180:D=ht._rescale,v=t+i,b=e,S=-i,_=s,C=t+(1-h-g)*i,w=e+f*s,T=t+(1-h)*i,E=e+(f+p)*s;break;case 270:D=ht._rescaleAndSwap,v=t+i,b=e+s,S=-i,_=-s,C=t+(1-f-p)*i,w=e+(1-h-g)*s,T=t+(1-f)*i,E=e+(1-h)*s;break}for(const{line:M,points:O}of this.#i)o.push(D(M,v,b,S,_,r?new Array(M.length):null)),c.push(D(O,v,b,S,_,r?new Array(O.length):null));return{lines:o,points:c,rect:[C,w,T,E]}}static deserialize(t,e,i,s,r,{paths:{lines:o,points:c},rotation:h,thickness:f}){const g=[];let p,v,b,S,_;switch(h){case 0:_=ht._rescale,p=-t/i,v=e/s+1,b=1/i,S=-1/s;break;case 90:_=ht._rescaleAndSwap,p=-e/s,v=-t/i,b=1/s,S=1/i;break;case 180:_=ht._rescale,p=t/i+1,v=-e/s,b=-1/i,S=1/s;break;case 270:_=ht._rescaleAndSwap,p=e/s+1,v=t/i+1,b=-1/s,S=-1/i;break}if(!o){o=[];for(const w of c){const T=w.length;if(T===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(T===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(T-2));o.push(E);let[D,M,O,R]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,D,M],0);for(let j=4;j<T;j+=2){const G=w[j],Q=w[j+1];E.set(ht.createBezierPoints(D,M,O,R,G,Q),(j-2)*3),[D,M,O,R]=[O,R,G,Q]}}}for(let w=0,T=o.length;w<T;w++)g.push({line:_(o[w].map(E=>E??NaN),p,v,b,S),points:_(c[w].map(E=>E??NaN),p,v,b,S)});const C=new this.prototype.constructor;return C.build(g,i,s,1,h,f,r),C}#l(t=this.#c){const e=this.#s+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#n]:[e/this.#n,e/this.#a]}#d(){const[t,e,i,s]=this.#t,[r,o]=this.#l(0);return[t+r,e+o,i-2*r,s-2*o]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#i){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)ut.pointBoundingBox(s[c],s[c+1],t);continue}let r=s[4],o=s[5];for(let c=6,h=s.length;c<h;c+=6){const[f,g,p,v,b,S]=s.subarray(c,c+6);ut.bezierBoundingBox(r,o,f,g,p,v,b,S,t),r=b,o=S}}const[e,i]=this.#l();t[0]=Qe(t[0]-e,0,1),t[1]=Qe(t[1]-i,0,1),t[2]=Qe(t[2]+e,0,1),t[3]=Qe(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[s,r]=this.#l(),[o,c]=[s-e,r-i],h=this.#t;return h[0]-=o,h[1]-=c,h[2]+=2*o,h[3]+=2*c,h}updateParentDimensions([t,e],i){const[s,r]=this.#l();this.#a=t,this.#n=e,this.#r=i;const[o,c]=this.#l(),h=o-s,f=c-r,g=this.#t;return g[0]-=h,g[1]-=f,g[2]+=2*h,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(ht.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ht.svgRound(t)} ${ht.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,s=0,r=0,o=0,c=0,h=0;switch(this.#e){case 90:s=e/t,r=-t/e,c=t;break;case 180:i=-1,o=-1,c=t,h=e;break;case 270:s=-e/t,r=t/e,h=e;break;default:return""}return`matrix(${i} ${s} ${r} ${o} ${ht.svgRound(c)} ${ht.svgRound(h)})`}getPathResizingSVGProperties([t,e,i,s]){const[r,o]=this.#l(),[c,h,f,g]=this.#t;if(Math.abs(f-r)<=ht.PRECISION||Math.abs(g-o)<=ht.PRECISION){const _=t+i/2-(c+f/2),C=e+s/2-(h+g/2);return{path:{"transform-origin":`${ht.svgRound(t)} ${ht.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${C})`}}}const p=(i-2*r)/(f-2*r),v=(s-2*o)/(g-2*o),b=f/i,S=g/s;return{path:{"transform-origin":`${ht.svgRound(c)} ${ht.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${S}) translate(${ht.svgRound(r)} ${ht.svgRound(o)}) scale(${p} ${v}) translate(${ht.svgRound(-r)} ${ht.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,i,s]){const[r,o]=this.#l(),c=this.#t,[h,f,g,p]=c;if(c[0]=t,c[1]=e,c[2]=i,c[3]=s,Math.abs(g-r)<=ht.PRECISION||Math.abs(p-o)<=ht.PRECISION){const C=t+i/2-(h+g/2),w=e+s/2-(f+p/2);for(const{line:T,points:E}of this.#i)ht._translate(T,C,w,T),ht._translate(E,C,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ht.svgRound(t)} ${ht.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*r)/(g-2*r),b=(s-2*o)/(p-2*o),S=-v*(h+r)+t+r,_=-b*(f+o)+e+o;if(v!==1||b!==1||S!==0||_!==0)for(const{line:C,points:w}of this.#i)ht._rescale(C,S,_,v,b,C),ht._rescale(w,S,_,v,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ht.svgRound(t)} ${ht.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[s,r]=i,o=this.#t,c=t-o[0],h=e-o[1];if(this.#a===s&&this.#n===r)for(const{line:f,points:g}of this.#i)ht._translate(f,c,h,f),ht._translate(g,c,h,g);else{const f=this.#a/s,g=this.#n/r;this.#a=s,this.#n=r;for(const{line:p,points:v}of this.#i)ht._rescale(p,c,h,f,g,p),ht._rescale(v,c,h,f,g,v);o[2]*=f,o[3]*=g}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ht.svgRound(t)} ${ht.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ht.svgRound(t[0])} ${ht.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class cu extends $_{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:xt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new cu(this._viewParameters);return t.updateAll(this),t}}class lp extends At{static _type="ink";static _editorType=kt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){xt.initialize(t,e),this._defaultDrawingOptions=new cu(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Nt(this,"typesMap",new Map([[Ut.INK_THICKNESS,"stroke-width"],[Ut.INK_COLOR,"stroke"],[Ut.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,s,r){return new EA(t,e,i,s,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,s,r,o){return Ol.deserialize(t,e,i,s,r,o)}static async deserialize(t,e,i){let s=null;if(t instanceof ap){const{data:{inkLists:o,rect:c,rotation:h,id:f,color:g,opacity:p,borderStyle:{rawWidth:v},popupRef:b,richText:S,contentsObj:_,creationDate:C,modificationDate:w},parent:{page:{pageNumber:T}}}=t;s=t={annotationType:kt.INK,color:Array.from(g),thickness:v,opacity:p,paths:{points:o},boxes:null,pageIndex:T-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:b,richText:S,comment:_?.str||null,creationDate:C,modificationDate:w}}const r=await super.deserialize(t,e,i);return r._initialData=s,t.comment&&r.setCommentData(t),r}get toolbarButtons(){return this._colorPicker||=new pl(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ut.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=lp.getDefaultDrawingOptions({stroke:ut.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":r,"stroke-width":o}}=this,c=Object.assign(super.serialize(t),{color:xt._colorManager.convert(s),opacity:r,thickness:o,paths:{lines:e,points:i}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!this.#t(c)?null:(c.id=this.annotationElementId,c)}#t(t){const{color:e,thickness:i,opacity:s,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==e[c])||t.thickness!==i||t.opacity!==s||t.pageIndex!==r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Tg extends Ol{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const oh=8,Qo=3;class pr{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,s){return i-=t,s-=e,i===0?s>0?0:4:i===1?s+6:2-s}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,s,r,o,c){const h=this.#e(i,s,r,o);for(let f=0;f<8;f++){const g=(-f+h-c+16)%8,p=this.#s[2*g],v=this.#s[2*g+1];if(t[(i+p)*e+(s+v)]!==0)return g}return-1}static#a(t,e,i,s,r,o,c){const h=this.#e(i,s,r,o);for(let f=0;f<8;f++){const g=(f+h+c+16)%8,p=this.#s[2*g],v=this.#s[2*g+1];if(t[(i+p)*e+(s+v)]!==0)return g}return-1}static#n(t,e,i,s){const r=t.length,o=new Int32Array(r);for(let g=0;g<r;g++)o[g]=t[g]<=s?1:0;for(let g=1;g<i-1;g++)o[g*e]=o[g*e+e-1]=0;for(let g=0;g<e;g++)o[g]=o[e*i-1-g]=0;let c=1,h;const f=[];for(let g=1;g<i-1;g++){h=1;for(let p=1;p<e-1;p++){const v=g*e+p,b=o[v];if(b===0)continue;let S=g,_=p;if(b===1&&o[v-1]===0)c+=1,_-=1;else if(b>=1&&o[v+1]===0)c+=1,_+=1,b>1&&(h=b);else{b!==1&&(h=Math.abs(b));continue}const C=[p,g],w=_===p+1,T={isHole:w,points:C,id:c,parent:0};f.push(T);let E;for(const J of f)if(J.id===h){E=J;break}E?E.isHole?T.parent=w?E.parent:h:T.parent=w?h:E.parent:T.parent=w?h:0;const D=this.#i(o,e,g,p,S,_,0);if(D===-1){o[v]=-c,o[v]!==1&&(h=Math.abs(o[v]));continue}let M=this.#s[2*D],O=this.#s[2*D+1];const R=g+M,j=p+O;S=R,_=j;let G=g,Q=p;for(;;){const J=this.#a(o,e,G,Q,S,_,1);M=this.#s[2*J],O=this.#s[2*J+1];const st=G+M,rt=Q+O;C.push(rt,st);const it=G*e+Q;if(o[it+1]===0?o[it]=-c:o[it]===1&&(o[it]=c),st===g&&rt===p&&G===R&&Q===j){o[v]!==1&&(h=Math.abs(o[v]));break}else S=G,_=Q,G=st,Q=rt}}}return f}static#r(t,e,i,s){if(i-e<=4){for(let R=e;R<i-2;R+=2)s.push(t[R],t[R+1]);return}const r=t[e],o=t[e+1],c=t[i-4]-r,h=t[i-3]-o,f=Math.hypot(c,h),g=c/f,p=h/f,v=g*o-p*r,b=h/c,S=1/f,_=Math.atan(b),C=Math.cos(_),w=Math.sin(_),T=S*(Math.abs(C)+Math.abs(w)),E=S*(1-T+T**2),D=Math.max(Math.atan(Math.abs(w+C)*E),Math.atan(Math.abs(w-C)*E));let M=0,O=e;for(let R=e+2;R<i-2;R+=2){const j=Math.abs(v-g*t[R+1]+p*t[R]);j>M&&(O=R,M=j)}M>(f*D)**2?(this.#r(t,e,O+2,s),this.#r(t,O,i,s)):s.push(r,o)}static#o(t){const e=[],i=t.length;return this.#r(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,s,r,o){const c=new Float32Array(o**2),h=-2*s**2,f=o>>1;for(let _=0;_<o;_++){const C=(_-f)**2;for(let w=0;w<o;w++)c[_*o+w]=Math.exp((C+(w-f)**2)/h)}const g=new Float32Array(256),p=-2*r**2;for(let _=0;_<256;_++)g[_]=Math.exp(_**2/p);const v=t.length,b=new Uint8Array(v),S=new Uint32Array(256);for(let _=0;_<i;_++)for(let C=0;C<e;C++){const w=_*e+C,T=t[w];let E=0,D=0;for(let O=0;O<o;O++){const R=_+O-f;if(!(R<0||R>=i))for(let j=0;j<o;j++){const G=C+j-f;if(G<0||G>=e)continue;const Q=t[R*e+G],J=c[O*o+j]*g[Math.abs(Q-T)];E+=Q*J,D+=J}}const M=b[w]=Math.round(E/D);S[M]++}return[b,S]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let s=-1/0,r=1/0;for(let c=0,h=i.length;c<h;c++){const f=i[c]=t[c<<2];s=Math.max(s,f),r=Math.min(r,f)}const o=255/(s-r);for(let c=0,h=i.length;c<h;c++)i[c]=(i[c]-r)*o;return i}static#u(t){let e,i=-1/0,s=-1/0;const r=t.findIndex(h=>h!==0);let o=r,c=r;for(e=r;e<256;e++){const h=t[e];h>i&&(e-o>s&&(s=e-o,c=e-1),i=h,o=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:s}=t,{maxDim:r}=this.#t;let o=i,c=s;if(i>r||s>r){let v=i,b=s,S=Math.log2(Math.max(i,s)/r);const _=Math.floor(S);S=S===_?_-1:_;for(let w=0;w<S;w++){o=Math.ceil(v/2),c=Math.ceil(b/2);const T=new OffscreenCanvas(o,c);T.getContext("2d").drawImage(t,0,0,v,b,0,0,o,c),v=o,b=c,t!==e&&t.close(),t=T.transferToImageBitmap()}const C=Math.min(r/o,r/c);o=Math.round(o*C),c=Math.round(c*C)}const f=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,o,c),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,o,c);const g=f.getImageData(0,0,o,c).data;return[this.#d(g),o,c]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:s},r,o,c,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const p=200,v=g.font=`${i} ${s} ${p}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:S,actualBoundingBoxAscent:_,actualBoundingBoxDescent:C,fontBoundingBoxAscent:w,fontBoundingBoxDescent:T,width:E}=g.measureText(t),D=1.5,M=Math.ceil(Math.max(Math.abs(b)+Math.abs(S)||0,E)*D),O=Math.ceil(Math.max(Math.abs(_)+Math.abs(C)||p,Math.abs(w)+Math.abs(T)||p)*D);f=new OffscreenCanvas(M,O),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=v,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,M,O),g.fillStyle="black",g.fillText(t,M*(D-1)/2,O*(3-D)/2);const R=this.#d(g.getImageData(0,0,M,O).data),j=this.#l(R),G=this.#u(j),Q=this.#n(R,M,O,G);return this.processDrawnLines({lines:{curves:Q,width:M,height:O},pageWidth:r,pageHeight:o,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,i,s,r){const[o,c,h]=this.#f(t),[f,g]=this.#c(o,c,h,Math.hypot(c,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(g),v=this.#n(f,c,h,p);return this.processDrawnLines({lines:{curves:v,width:c,height:h},pageWidth:e,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:o,areContours:c}){s%180!==0&&([e,i]=[i,e]);const{curves:h,width:f,height:g}=t,p=t.thickness??0,v=[],b=Math.min(e/f,i/g),S=b/e,_=b/i,C=[];for(const{points:T}of h){const E=o?this.#o(T):T;if(!E)continue;C.push(E);const D=E.length,M=new Float32Array(D),O=new Float32Array(3*(D===2?2:D-2));if(v.push({line:O,points:M}),D===2){M[0]=E[0]*S,M[1]=E[1]*_,O.set([NaN,NaN,NaN,NaN,M[0],M[1]],0);continue}let[R,j,G,Q]=E;R*=S,j*=_,G*=S,Q*=_,M.set([R,j,G,Q],0),O.set([NaN,NaN,NaN,NaN,R,j],0);for(let J=4;J<D;J+=2){const st=M[J]=E[J]*S,rt=M[J+1]=E[J+1]*_;O.set(ht.createBezierPoints(R,j,G,Q,st,rt),(J-2)*3),[R,j,G,Q]=[G,Q,st,rt]}}if(v.length===0)return null;const w=c?new Tg:new Ol;return w.build(v,e,i,1,s,c?0:p,r),{outline:w,newCurves:C,areContours:c,thickness:p,width:f,height:g}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:s,height:r}){let o=1/0,c=-1/0,h=0;for(const E of t){h+=E.length;for(let D=2,M=E.length;D<M;D++){const O=E[D]-E[D-2];o=Math.min(o,O),c=Math.max(c,O)}}let f;o>=-128&&c<=127?f=Int8Array:o>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const g=t.length,p=oh+Qo*g,v=new Uint32Array(p);let b=0;v[b++]=p*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=s,v[b++]=r,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(i??0)),v[b++]=g,v[b++]=f.BYTES_PER_ELEMENT;for(const E of t)v[b++]=E.length-2,v[b++]=E[0],v[b++]=E[1];const S=new CompressionStream("deflate-raw"),_=S.writable.getWriter();await _.ready,_.write(v);const C=f.prototype.constructor;for(const E of t){const D=new C(E.length-2);for(let M=2,O=E.length;M<O;M++)D[M-2]=E[M]-E[M-2];_.write(D)}_.close();const w=await new Response(S.readable).arrayBuffer(),T=new Uint8Array(w);return y_(T)}static async decompressSignature(t){try{const e=Z1(t),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,c=0;for await(const E of i)o||=new Uint8Array(new Uint32Array(E.buffer,0,4)[0]),o.set(E,c),c+=E.length;const h=new Uint32Array(o.buffer,0,o.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],p=h[3],v=h[4]===0,b=h[5],S=h[6],_=h[7],C=[],w=(oh+Qo*S)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(o.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(o.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(o.buffer,w);break}c=0;for(let E=0;E<S;E++){const D=h[Qo*E+oh],M=new Float32Array(D+2);C.push(M);for(let O=0;O<Qo-1;O++)M[O]=h[Qo*E+oh+O+1];for(let O=0;O<D;O++)M[O+2]=M[O]+T[c++]}return{areContours:v,thickness:b,outlines:C,width:g,height:p}}catch(e){return Rt(`decompressSignature: ${e}`),null}}}class cp extends $_{constructor(){super(),super.updateProperties({fill:xt._defaultLineColor,"stroke-width":0})}clone(){const t=new cp;return t.updateAll(this),t}}class hp extends cu{constructor(t){super(t),super.updateProperties({stroke:xt._defaultLineColor,"stroke-width":1})}clone(){const t=new hp(this._viewParameters);return t.updateAll(this),t}}class ws extends At{#t=!1;#e=null;#s=null;#i=null;static _type="signature";static _editorType=kt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){xt.initialize(t,e),this._defaultDrawingOptions=new cp,this._defaultDrawnSignatureOptions=new hp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Nt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:s,mustSmooth:r,areContours:o,description:c,uuid:h,heightInPage:f}=this.#s,{rawDims:{pageWidth:g,pageHeight:p},rotation:v}=this.parent.viewport,b=pr.processDrawnLines({lines:s,pageWidth:g,pageHeight:p,rotation:v,innerMargin:ws._INNER_MARGIN,mustSmooth:r,areContours:o});this.addSignature(b,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:s,height:r}=this.#s,o=Math.max(s,r),c=pr.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:i,width:s,height:r},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,s){const{x:r,y:o}=this,{outline:c}=this.#s=t;this.#t=c instanceof Tg,this.description=i;let h;this.#t?h=ws.getDefaultDrawingOptions():(h=ws._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let g=e/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=r,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return pr.process(t,e,i,s,ws._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return pr.extractContoursFromText(t,e,i,s,r,ws._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return pr.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:ws._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=ws.getDefaultDrawingOptions():(this._drawingOptions=ws._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,r=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s});return this.addComment(r),t?(r.paths={lines:e,points:i},r.uuid=this.#i,r.isCopy=!0):r.lines=e,this.#e&&(r.accessibilityData={type:"Figure",alt:this.#e}),r}static deserializeDraw(t,e,i,s,r,o){return o.areContours?Tg.deserialize(t,e,i,s,r,o):Ol.deserialize(t,e,i,s,r,o)}static async deserialize(t,e,i){const s=await super.deserialize(t,e,i);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#i=t.uuid,s}}class DA extends xt{#t=null;#e=null;#s=null;#i=null;#a=null;#n="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=kt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){xt.initialize(t,e)}static isHandlingMimeForPasting(t){return Uh.includes(t)}static paste(t,e){e.pasteEditor({mode:kt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#n=t.file.name),this.#g()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:r,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:s,width:r,height:o,channels:s.length/(r*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#f());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#u(s)).finally(()=>this.#f());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(i).then(s=>this.#u(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Uh.join(",");const e=this._uiManager._signal;this.#s=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,s&&(this.#t=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:e,height:i}=this.#t;const[s,r]=this.pageDimensions,o=.75;if(this.width)e=this.width*s,i=this.height*r;else if(e>o*s||i>o*r){const h=Math.min(o*s/e,o*r/i);e*=h,i*=h}this._uiManager.enableWaiting(!1);const c=this.#r=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=e/s,this.height=i/r,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&this.div.setAttribute("aria-description",this.#n),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:s,height:r}=this.#t,o=new fs;let c=this.#t,h=s,f=r,g=null;if(e){if(s>e||r>e){const O=Math.min(e/s,e/r);h=Math.floor(s*O),f=Math.floor(r*O)}g=document.createElement("canvas");const v=g.width=Math.ceil(h*o.sx),b=g.height=Math.ceil(f*o.sy);this.#l||(c=this.#h(v,b));const S=g.getContext("2d");S.filter=this._uiManager.hcmFilter;let _="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":eC.isDarkMode&&(_="#8f8f9d",C="#42414d");const w=15,T=w*o.sx,E=w*o.sy,D=new OffscreenCanvas(T*2,E*2),M=D.getContext("2d");M.fillStyle=_,M.fillRect(0,0,T*2,E*2),M.fillStyle=C,M.fillRect(0,0,T,E),M.fillRect(T,E,T,E),S.fillStyle=S.createPattern(D,"repeat"),S.fillRect(0,0,v,b),S.drawImage(c,0,0,c.width,c.height,0,0,v,b)}let p=null;if(i){let v,b;if(o.symmetric&&c.width<t&&c.height<t)v=c.width,b=c.height;else if(c=this.#t,s>t||r>t){const C=Math.min(t/s,t/r);v=Math.floor(s*C),b=Math.floor(r*C),this.#l||(c=this.#h(v,b))}const _=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});_.drawImage(c,0,0,c.width,c.height,0,0,v,b),p={width:v,height:b,data:_.getImageData(0,0,v,b).data}}return{canvas:g,width:h,height:f,imageData:p}}#h(t,e){const{width:i,height:s}=this.#t;let r=i,o=s,c=this.#t;for(;r>2*t||o>2*e;){const h=r,f=o;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const g=new OffscreenCanvas(r,o);g.getContext("2d").drawImage(c,0,0,h,f,0,0,r,o),c=g.transferToImageBitmap()}return c}#p(){const[t,e]=this.parentDimensions,{width:i,height:s}=this,r=new fs,o=Math.ceil(i*t*r.sx),c=Math.ceil(s*e*r.sy),h=this.#r;if(!h||h.width===o&&h.height===c)return;h.width=o,h.height=c;const f=this.#l?this.#t:this.#h(o,c),g=h.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,o,c)}#y(t){if(t){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,s=Math.round(this.width*e*Tr.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*Tr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,r);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,r),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let s=null,r=!1;if(t instanceof q_){const{data:{rect:_,rotation:C,id:w,structParent:T,popupRef:E,richText:D,contentsObj:M,creationDate:O,modificationDate:R},container:j,parent:{page:{pageNumber:G}},canvas:Q}=t;let J,st;Q?(delete t.canvas,{id:J,bitmap:st}=i.imageManager.getFromCanvas(j.id,Q),Q.remove()):(r=!0,t._hasNoCanvas=!0);const rt=(await e._structTree.getAriaAttributes(`${Yg}${w}`))?.get("aria-label")||"";s=t={annotationType:kt.STAMP,bitmapId:J,bitmap:st,pageIndex:G-1,rect:_.slice(0),rotation:C,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:rt},isSvg:!1,structParent:T,popupRef:E,richText:D,comment:M?.str||null,creationDate:O,modificationDate:R}}const o=await super.deserialize(t,e,i),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:g,isSvg:p,accessibilityData:v}=t;r?(i.addMissingCanvas(t.id,o),o.#o=!0):g&&i.imageManager.isValidId(g)?(o.#e=g,h&&(o.#t=h)):o.#i=f,o.#l=p;const[b,S]=o.pageDimensions;return o.width=(c[2]-c[0])/b,o.height=(c[3]-c[1])/S,v&&(o.altTextData=v),o._initialData=s,t.comment&&o.setCommentData(t),o.#d=!!s,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:r}=this.serializeAltText(!1);if(!s&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const c=this.#b(i);return c.isSame?null:(c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const o=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const c=e.stamps.get(this.#e);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return i}#b(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&r,isSameAltText:r}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class As{#t;#e=!1;#s=null;#i=null;#a=null;#n=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#u=null;#f=null;#m=null;#g=-1;#h;static _initialized=!1;static#p=new Map([je,lp,DA,we,ws].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:c,textLayer:h,viewport:f,l10n:g}){const p=[...As.#p.values()];if(!As._initialized){As._initialized=!0;for(const v of p)v.initialize(g,t)}t.registerEditorTypes(p),this.#h=t,this.pageIndex=e,this.div=i,this.#t=r,this.#s=o,this.viewport=f,this.#u=h,this.drawLayer=c,this._structTree=s,this.#h.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===kt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#_(),t){case kt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case kt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case kt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===kt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of As.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.div.classList.toggle("disabled",!t)}get#y(){return this.#n.size!==0?this.#n.values():this.#h.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#s;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#h._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const i=this.#h.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",s=>{const{clientX:o,clientY:c,timeStamp:h}=s,f=this.#g;if(h-f>500){this.#g=h;return}this.#g=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const p=document.elementsFromPoint(o,c);if(g.toggle("getElements",!1),!this.div.contains(p[0]))return;let v;const b=new RegExp(`^${ul}[0-9]+$`);for(const _ of p)if(b.test(_.id)){v=_.id;break}if(!v)return;const S=this.#n.get(v);S?.annotationElementId===null&&(s.stopPropagation(),s.preventDefault(),S.dblclick(s))},{signal:i,capture:!0})}const t=this.#s;if(t){const i=new Map,s=new Map;for(const o of this.#y){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(t);continue}if(o.serialize()!==null){i.set(o.annotationElementId,o);continue}else s.set(o.annotationElementId,o);this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}const r=t.getEditableAnnotations();for(const o of r){const{id:c}=o.data;if(this.#h.isDeletedAnnotationElement(c)){o.updateEdited({deleted:!0});continue}let h=s.get(c);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=i.get(c),h&&(this.#h.addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const i of As.#p.values())e.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=Ie.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),we.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#n.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#n.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),xt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#n.values())if(e.uid===t)return e;return null}getNextId(){return this.#h.getId()}get#v(){return As.#p.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#A(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:s}=this.#w(),r=this.getNextId(),o=this.#A({parent:this,id:r,x:i,y:s,uiManager:this.#h,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await As.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),r=this.#A({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:e,width:i,height:s}=this.boundingClientRect,r=Math.max(0,t),o=Math.max(0,e),c=Math.min(window.innerWidth,t+i),h=Math.min(window.innerHeight,e+s),f=(r+c)/2-t,g=(o+h)/2-e,[p,v]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:p,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Ie.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===kt.STAMP||i===kt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===kt.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=Ie.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#h.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#h.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(t)):null}findNewParent(t,e,i){const s=this.#h.findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#n.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#n.clear(),this.#h.removeLayer(this)}#_(){for(const t of this.#n.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Xn(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#_();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Xn(this.div,{rotation:i}),e!==i)for(const s of this.#n.values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class ze{#t=null;#e=new Map;#s=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Nt(this,"_svgFactory",new ml)}static#a(t,[e,i,s,r]){const{style:o}=t;o.top=`${100*i}%`,o.left=`${100*e}%`,o.width=`${100*s}%`,o.height=`${100*r}%`}#n(){const t=ze._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const i=ze._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=ze._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),s}#o(t,e){for(const[i,s]of Object.entries(e))s===null?t.removeAttribute(i):t.setAttribute(i,s)}draw(t,e=!1,i=!1){const s=ze.#i++,r=this.#n(),o=ze._svgFactory.createElement("defs");r.append(o);const c=ze._svgFactory.createElement("path");o.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#s.set(s,c);const f=i?this.#r(o,h):null,g=ze._svgFactory.createElement("use");return r.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(r,t),this.#e.set(s,r),{id:s,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=ze.#i++,s=this.#n(),r=ze._svgFactory.createElement("defs");s.append(r);const o=ze._svgFactory.createElement("path");r.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const p=ze._svgFactory.createElement("mask");r.append(p),h=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",h),p.setAttribute("maskUnits","objectBoundingBox");const v=ze._svgFactory.createElement("rect");p.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=ze._svgFactory.createElement("use");p.append(b),b.setAttribute("href",`#${c}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=ze._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(i,s),i}finalizeDraw(t,e){this.#s.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:s,rootClass:r,path:o}=e,c=typeof t=="number"?this.#e.get(t):t;if(c){if(i&&this.#o(c,i),s&&ze.#a(c,s),r){const{classList:h}=c;for(const[f,g]of Object.entries(r))h.toggle(f,g)}if(o){const f=c.firstChild.firstChild;this.#o(f,o)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#s.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Cg};globalThis.pdfjsLib={AbortException:an,AnnotationEditorLayer:As,AnnotationEditorParamsType:Ut,AnnotationEditorType:kt,AnnotationEditorUIManager:on,AnnotationLayer:op,AnnotationMode:Es,AnnotationType:xe,applyOpacity:x_,build:U_,ColorPicker:Li,createValidAbsoluteUrl:Gg,CSSConstants:S_,DOMSVGFactory:ml,DrawLayer:ze,FeatureTest:Ie,fetchData:Ua,findContrastColor:w_,getDocument:ep,getFilenameFromUrl:v_,getPdfFilenameFromUrl:b_,getRGB:Ga,getUuid:Xg,getXfaPageViewport:__,GlobalWorkerOptions:Vn,ImageKind:rl,InvalidPDFException:Ih,isDataScheme:Tl,isPdfFile:ou,isValidExplicitDest:E_,MathClamp:Qe,noContextMenu:Bi,normalizeUnicode:m_,OPS:ja,OutputScale:fs,PasswordResponses:g_,PDFDataRangeTransport:sp,PDFDateString:Hh,PDFWorker:za,PermissionFlag:f_,PixelsPerInch:Tr,RenderingCancelledException:au,renderRichText:Wg,ResponseException:dl,setLayerDimensions:Xn,shadow:Nt,SignatureExtractor:pr,stopEvent:me,SupportedImageMimeTypes:Uh,TextLayer:gl,TouchManager:Dl,updateUrlHash:Vg,Util:ut,VerbosityLevel:wl,version:np,XfaLayer:qg};const MA=Object.freeze(Object.defineProperty({__proto__:null,AbortException:an,AnnotationEditorLayer:As,AnnotationEditorParamsType:Ut,AnnotationEditorType:kt,AnnotationEditorUIManager:on,AnnotationLayer:op,AnnotationMode:Es,AnnotationType:xe,CSSConstants:S_,ColorPicker:Li,DOMSVGFactory:ml,DrawLayer:ze,FeatureTest:Ie,GlobalWorkerOptions:Vn,ImageKind:rl,InvalidPDFException:Ih,MathClamp:Qe,OPS:ja,OutputScale:fs,PDFDataRangeTransport:sp,PDFDateString:Hh,PDFWorker:za,PasswordResponses:g_,PermissionFlag:f_,PixelsPerInch:Tr,RenderingCancelledException:au,ResponseException:dl,SignatureExtractor:pr,SupportedImageMimeTypes:Uh,TextLayer:gl,TouchManager:Dl,Util:ut,VerbosityLevel:wl,XfaLayer:qg,applyOpacity:x_,build:U_,createValidAbsoluteUrl:Gg,fetchData:Ua,findContrastColor:w_,getDocument:ep,getFilenameFromUrl:v_,getPdfFilenameFromUrl:b_,getRGB:Ga,getUuid:Xg,getXfaPageViewport:__,isDataScheme:Tl,isPdfFile:ou,isValidExplicitDest:E_,noContextMenu:Bi,normalizeUnicode:m_,renderRichText:Wg,setLayerDimensions:Xn,shadow:Nt,stopEvent:me,updateUrlHash:Vg,version:np},Symbol.toStringTag,{value:"Module"}));function Q_(u){var t,e,i="";if(typeof u=="string"||typeof u=="number")i+=u;else if(typeof u=="object")if(Array.isArray(u)){var s=u.length;for(t=0;t<s;t++)u[t]&&(e=Q_(u[t]))&&(i&&(i+=" "),i+=e)}else for(e in u)u[e]&&(i&&(i+=" "),i+=e);return i}function hu(){for(var u,t,e=0,i="",s=arguments.length;e<s;e++)(u=arguments[e])&&(t=Q_(u))&&(i&&(i+=" "),i+=t);return i}var ub=Object.prototype.hasOwnProperty;function db(u,t,e){for(e of u.keys())if(Ra(e,t))return e}function Ra(u,t){var e,i,s;if(u===t)return!0;if(u&&t&&(e=u.constructor)===t.constructor){if(e===Date)return u.getTime()===t.getTime();if(e===RegExp)return u.toString()===t.toString();if(e===Array){if((i=u.length)===t.length)for(;i--&&Ra(u[i],t[i]););return i===-1}if(e===Set){if(u.size!==t.size)return!1;for(i of u)if(s=i,s&&typeof s=="object"&&(s=db(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(u.size!==t.size)return!1;for(i of u)if(s=i[0],s&&typeof s=="object"&&(s=db(t,s),!s)||!Ra(i[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)u=new Uint8Array(u),t=new Uint8Array(t);else if(e===DataView){if((i=u.byteLength)===t.byteLength)for(;i--&&u.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(u)){if((i=u.byteLength)===t.byteLength)for(;i--&&u[i]===t[i];);return i===-1}if(!e||typeof u=="object"){i=0;for(e in u)if(ub.call(u,e)&&++i&&!ub.call(t,e)||!(e in t)||!Ra(u[e],t[e]))return!1;return Object.keys(t).length===i}}return u!==u&&t!==t}function kl(u){let t=!1;return{promise:new Promise((i,s)=>{u.then(r=>!t&&i(r)).catch(r=>!t&&s(r))}),cancel(){t=!0}}}const OA=["onCopy","onCut","onPaste"],kA=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],RA=["onFocus","onBlur"],LA=["onInput","onInvalid","onReset","onSubmit"],PA=["onLoad","onError"],BA=["onKeyDown","onKeyPress","onKeyUp"],NA=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],FA=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],jA=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],zA=["onSelect"],IA=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],HA=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],UA=["onScroll"],GA=["onWheel"],VA=["onAnimationStart","onAnimationEnd","onAnimationIteration"],XA=["onTransitionEnd"],YA=["onToggle"],qA=["onChange"],WA=[...OA,...kA,...RA,...LA,...PA,...BA,...NA,...FA,...jA,...zA,...IA,...HA,...UA,...GA,...VA,...XA,...qA,...YA];function Z_(u,t){const e={};for(const i of WA){const s=u[i];s&&(t?e[i]=(r=>s(r,t(i))):e[i]=s)}return e}var KA="Invariant failed";function re(u,t){if(!u)throw new Error(KA)}var ig,fb;function $A(){if(fb)return ig;fb=1;var u=function(){};return ig=u,ig}var QA=$A();const Ze=R1(QA),J_=at.createContext(null),ZA="noopener noreferrer nofollow";class JA{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return re(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){re(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||ZA,t.target=i?"_blank":this.externalLinkTarget||""}goToDestination(t){return new Promise(e=>{re(this.pdfDocument),re(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{re(Array.isArray(e));const i=e[0];new Promise(s=>{re(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(r=>{s(r)}).catch(()=>{re(!1)}):typeof i=="number"?s(i):re(!1)}).then(s=>{const r=s+1;re(this.pdfViewer),re(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:r})})})}goToPage(t){const e=t-1;re(this.pdfViewer),re(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(t){this.goToDestination(t)}}function La({children:u,type:t}){return tt.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:u})}const gb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function tT(u,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return u}}function Ia(){return at.useReducer(tT,{value:void 0,error:void 0})}const uu=typeof window<"u",tS=uu&&window.location.protocol==="file:";function eT(u){return typeof u<"u"}function gr(u){return eT(u)&&u!==null}function iT(u){return typeof u=="string"}function sT(u){return u instanceof ArrayBuffer}function nT(u){return re(uu),u instanceof Blob}function Eg(u){return iT(u)&&/^data:/.test(u)}function pb(u){re(Eg(u));const[t="",e=""]=u.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function rT(){return uu&&window.devicePixelRatio||1}const eS="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function mb(){Ze(!tS,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${eS}`)}function aT(){Ze(!tS,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${eS}`)}function Dr(u){u?.cancel&&u.cancel()}function Dg(u,t){return Object.defineProperty(u,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(u,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(u,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(u,"originalHeight",{get(){return this.view[3]},configurable:!0}),u}function oT(u){return u.name==="RenderingCancelledException"}function lT(u){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:r}=s.target;if(!r)return e(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(u)})}const{PDFDataRangeTransport:cT}=MA,hT=(u,t)=>{switch(t){case gb.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");u(e);break}case gb.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");u(e);break}}};function yb(u){return typeof u=="object"&&u!==null&&("data"in u||"range"in u||"url"in u)}const uT=at.forwardRef(function({children:t,className:e,error:i="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:r,file:o,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF",noData:g="No PDF file specified.",onItemClick:p,onLoadError:v,onLoadProgress:b,onLoadSuccess:S,onPassword:_=hT,onSourceError:C,onSourceSuccess:w,options:T,renderMode:E,rotate:D,scale:M,...O},R){const[j,G]=Ia(),{value:Q,error:J}=j,[st,rt]=Ia(),{value:it,error:lt}=st,L=at.useRef(new JA),I=at.useRef([]),K=at.useRef(void 0),dt=at.useRef(void 0);o&&o!==K.current&&yb(o)&&(Ze(!Ra(o,K.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),K.current=o),T&&T!==dt.current&&(Ze(!Ra(T,dt.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),dt.current=T);const _t=at.useRef({scrollPageIntoView:Tt=>{const{dest:Et,pageNumber:Dt,pageIndex:wt=Dt-1}=Tt;if(p){p({dest:Et,pageIndex:wt,pageNumber:Dt});return}const bt=I.current[wt];if(bt){bt.scrollIntoView();return}Ze(!1,`An internal link leading to page ${Dt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});at.useImperativeHandle(R,()=>({linkService:L,pages:I,viewer:_t}),[]);function P(){w&&w()}function Y(){J&&(Ze(!1,J.toString()),C&&C(J))}function et(){G({type:"RESET"})}at.useEffect(et,[o,G]);const nt=at.useCallback(async()=>{if(!o)return null;if(typeof o=="string")return Eg(o)?{data:pb(o)}:(mb(),{url:o});if(o instanceof cT)return{range:o};if(sT(o))return{data:o};if(uu&&nT(o))return{data:await lT(o)};if(re(typeof o=="object"),re(yb(o)),"url"in o&&typeof o.url=="string"){if(Eg(o.url)){const{url:Tt,...Et}=o;return{data:pb(Tt),...Et}}mb()}return o},[o]);at.useEffect(()=>{const Tt=kl(nt());return Tt.promise.then(Et=>{G({type:"RESOLVE",value:Et})}).catch(Et=>{G({type:"REJECT",error:Et})}),()=>{Dr(Tt)}},[nt,G]),at.useEffect(()=>{if(!(typeof Q>"u")){if(Q===!1){Y();return}P()}},[Q]);function ft(){it&&(S&&S(it),I.current=new Array(it.numPages),L.current.setDocument(it))}function gt(){lt&&(Ze(!1,lt.toString()),v&&v(lt))}at.useEffect(function(){rt({type:"RESET"})},[rt,Q]),at.useEffect(function(){if(!Q)return;const Et=T?{...Q,...T}:Q,Dt=ep(Et);b&&(Dt.onProgress=b),_&&(Dt.onPassword=_);const wt=Dt,bt=wt.promise.then(Be=>{rt({type:"RESOLVE",value:Be})}).catch(Be=>{wt.destroyed||rt({type:"REJECT",error:Be})});return()=>{bt.finally(()=>wt.destroy())}},[T,rt,Q]),at.useEffect(()=>{if(!(typeof it>"u")){if(it===!1){gt();return}ft()}},[it]),at.useEffect(function(){L.current.setViewer(_t.current),L.current.setExternalLinkRel(s),L.current.setExternalLinkTarget(r)},[s,r]);const pt=at.useCallback((Tt,Et)=>{I.current[Tt]=Et},[]),Wt=at.useCallback(Tt=>{delete I.current[Tt]},[]),Mt=at.useMemo(()=>({imageResourcesPath:h,linkService:L.current,onItemClick:p,pdf:it,registerPage:pt,renderMode:E,rotate:D,scale:M,unregisterPage:Wt}),[h,p,it,pt,E,D,M,Wt]),Pt=at.useMemo(()=>Z_(O,()=>it),[O,it]);function yt(){function Tt(Dt){return!!Dt?.pdf}if(!Tt(Mt))throw new Error("pdf is undefined");const Et=typeof t=="function"?t(Mt):t;return tt.jsx(J_.Provider,{value:Mt,children:Et})}function ot(){return o?it==null?tt.jsx(La,{type:"loading",children:typeof f=="function"?f():f}):it===!1?tt.jsx(La,{type:"error",children:typeof i=="function"?i():i}):yt():tt.jsx(La,{type:"no-data",children:typeof g=="function"?g():g})}return tt.jsx("div",{className:hu("react-pdf__Document",e),ref:c,...Pt,children:ot()})});function iS(){return at.useContext(J_)}function sS(){for(var u=[],t=0;t<arguments.length;t++)u[t]=arguments[t];var e=u.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(r){for(var o=0,c=e;o<c.length;o++){var h=c[o];typeof h=="function"?h(r):h&&(h.current=r)}}}const nS=at.createContext(null);function du(){return at.useContext(nS)}function dT(){const u=iS(),t=du();re(t);const e={...u,...t},{imageResourcesPath:i,linkService:s,onGetAnnotationsError:r,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:c,onRenderAnnotationLayerSuccess:h,page:f,pdf:g,renderForms:p,rotate:v,scale:b=1}=e;re(g),re(f),re(s);const[S,_]=Ia(),{value:C,error:w}=S,T=at.useRef(null);Ze(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function E(){C&&o&&o(C)}function D(){w&&(Ze(!1,w.toString()),r&&r(w))}at.useEffect(function(){_({type:"RESET"})},[_,f]),at.useEffect(function(){if(!f)return;const G=kl(f.getAnnotations()),Q=G;return G.promise.then(J=>{_({type:"RESOLVE",value:J})}).catch(J=>{_({type:"REJECT",error:J})}),()=>{Dr(Q)}},[_,f]),at.useEffect(()=>{if(C!==void 0){if(C===!1){D();return}E()}},[C]);function M(){h&&h()}function O(j){Ze(!1,`${j}`),c&&c(j)}const R=at.useMemo(()=>f.getViewport({scale:b,rotation:v}),[f,v,b]);return at.useEffect(function(){if(!g||!f||!s||!C)return;const{current:G}=T;if(!G)return;const Q=R.clone({dontFlip:!0}),J={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:g.annotationStorage,commentManager:null,div:G,l10n:null,linkService:s,page:f,structTreeLayer:null,viewport:Q},st={annotations:C,annotationStorage:g.annotationStorage,div:G,imageResourcesPath:i,linkService:s,page:f,renderForms:p,viewport:Q};G.innerHTML="";try{new op(J).render(st),M()}catch(rt){O(rt)}return()=>{}},[C,i,s,f,g,p,R]),tt.jsx("div",{className:hu("react-pdf__Page__annotations","annotationLayer"),ref:T})}const rS={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},fT=/^H(\d+)$/;function gT(u){return u in rS}function fu(u){return"children"in u}function aS(u){return fu(u)?u.children.length===1&&0 in u.children&&"id"in u.children[0]:!1}function pT(u){const t={};if(fu(u)){const{role:e}=u,i=e.match(fT);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(gT(e)){const s=rS[e];s&&(t.role=s)}}return t}function oS(u){const t={};if(fu(u)){if(u.alt!==void 0&&(t["aria-label"]=u.alt),u.lang!==void 0&&(t.lang=u.lang),aS(u)){const[e]=u.children;if(e){const i=oS(e);return{...t,...i}}}}else"id"in u&&(t["aria-owns"]=u.id);return t}function mT(u){return u?{...pT(u),...oS(u)}:null}function lS({className:u,node:t}){const e=at.useMemo(()=>mT(t),[t]),i=at.useMemo(()=>!fu(t)||aS(t)?null:t.children.map((s,r)=>tt.jsx(lS,{node:s},r)),[t]);return tt.jsx("span",{className:u,...e,children:i})}function yT(){const u=du();re(u);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=u,[i,s]=Ia(),{value:r,error:o}=i,{customTextRenderer:c,page:h}=u;function f(){r&&e&&e(r)}function g(){o&&(Ze(!1,o.toString()),t&&t(o))}return at.useEffect(function(){s({type:"RESET"})},[s,h]),at.useEffect(function(){if(c||!h)return;const v=kl(h.getStructTree()),b=v;return v.promise.then(S=>{s({type:"RESOLVE",value:S})}).catch(S=>{s({type:"REJECT",error:S})}),()=>Dr(b)},[c,h,s]),at.useEffect(()=>{if(r!==void 0){if(r===!1){g();return}f()}},[r]),r?tt.jsx(lS,{className:"react-pdf__Page__structTree structTree",node:r}):null}const vb=Es;function vT(u){const t=du();re(t);const e={...t,...u},{_className:i,canvasBackground:s,devicePixelRatio:r=rT(),onRenderError:o,onRenderSuccess:c,page:h,renderForms:f,renderTextLayer:g,rotate:p,scale:v}=e,{canvasRef:b}=u;re(h);const S=at.useRef(null);function _(){h&&c&&c(Dg(h,v))}function C(D){oT(D)||(Ze(!1,D.toString()),o&&o(D))}const w=at.useMemo(()=>h.getViewport({scale:v*r,rotation:p}),[r,h,p,v]),T=at.useMemo(()=>h.getViewport({scale:v,rotation:p}),[h,p,v]);at.useEffect(function(){if(!h)return;h.cleanup();const{current:M}=S;if(!M)return;M.width=w.width,M.height=w.height,M.style.width=`${Math.floor(T.width)}px`,M.style.height=`${Math.floor(T.height)}px`,M.style.visibility="hidden";const O={annotationMode:f?vb.ENABLE_FORMS:vb.ENABLE,canvas:M,canvasContext:M.getContext("2d",{alpha:!1}),viewport:w};s&&(O.background=s);const R=h.render(O),j=R;return R.promise.then(()=>{M.style.visibility="",_()}).catch(C),()=>Dr(j)},[s,h,f,w,T]);const E=at.useCallback(()=>{const{current:D}=S;D&&(D.width=0,D.height=0)},[]);return at.useEffect(()=>E,[E]),tt.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:sS(b,S),style:{display:"block",userSelect:"none"},children:g?tt.jsx(yT,{}):null})}function bT(u){return"str"in u}function _T(){const u=du();re(u);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:s,onRenderTextLayerSuccess:r,page:o,pageIndex:c,pageNumber:h,rotate:f,scale:g}=u;re(o);const[p,v]=Ia(),{value:b,error:S}=p,_=at.useRef(null);Ze(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function C(){b&&i&&i(b)}function w(){S&&(Ze(!1,S.toString()),e&&e(S))}at.useEffect(function(){v({type:"RESET"})},[o,v]),at.useEffect(function(){if(!o)return;const j=kl(o.getTextContent()),G=j;return j.promise.then(Q=>{v({type:"RESOLVE",value:Q})}).catch(Q=>{v({type:"REJECT",error:Q})}),()=>Dr(G)},[o,v]),at.useEffect(()=>{if(b!==void 0){if(b===!1){w();return}C()}},[b]);const T=at.useCallback(()=>{r&&r()},[r]),E=at.useCallback(R=>{Ze(!1,R.toString()),s&&s(R)},[s]);function D(){const R=_.current;R&&R.classList.add("selecting")}function M(){const R=_.current;R&&R.classList.remove("selecting")}const O=at.useMemo(()=>o.getViewport({scale:g,rotation:f}),[o,f,g]);return at.useLayoutEffect(function(){if(!o||!b)return;const{current:j}=_;if(!j)return;j.innerHTML="";const G=o.streamTextContent({includeMarkedContent:!0}),Q={container:j,textContentSource:G,viewport:O},J=new gl(Q),st=J;return J.render().then(()=>{const rt=document.createElement("div");rt.className="endOfContent",j.append(rt);const it=j.querySelectorAll('[role="presentation"]');if(t){let lt=0;b.items.forEach((L,I)=>{if(!bT(L))return;const K=it[lt];if(!K)return;const dt=t({pageIndex:c,pageNumber:h,itemIndex:I,...L});K.innerHTML=dt,lt+=L.str&&L.hasEOL?2:1})}T()}).catch(E),()=>Dr(st)},[t,E,T,o,c,h,b,O]),tt.jsx("div",{className:hu("react-pdf__Page__textContent","textLayer"),onMouseUp:M,onMouseDown:D,ref:_})}const bb=1;function ST(u){const e={...iS(),...u},{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:r,canvasRef:o,children:c,className:h,customRenderer:f,customTextRenderer:g,devicePixelRatio:p,error:v="Failed to load the page.",height:b,inputRef:S,loading:_="Loading page",noData:C="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:T,onGetStructTreeError:E,onGetStructTreeSuccess:D,onGetTextError:M,onGetTextSuccess:O,onLoadError:R,onLoadSuccess:j,onRenderAnnotationLayerError:G,onRenderAnnotationLayerSuccess:Q,onRenderError:J,onRenderSuccess:st,onRenderTextLayerError:rt,onRenderTextLayerSuccess:it,pageIndex:lt,pageNumber:L,pdf:I,registerPage:K,renderAnnotationLayer:dt=!0,renderForms:_t=!1,renderMode:P="canvas",renderTextLayer:Y=!0,rotate:et,scale:nt=bb,unregisterPage:ft,width:gt,...pt}=e,[Wt,Mt]=Ia(),{value:Pt,error:yt}=Wt,ot=at.useRef(null);re(I);const Tt=gr(L)?L-1:lt??null,Et=L??(gr(lt)?lt+1:null),Dt=et??(Pt?Pt.rotate:null),wt=at.useMemo(()=>{if(!Pt)return null;let ts=1;const es=nt??bb;if(gt||b){const gs=Pt.getViewport({scale:1,rotation:Dt});gt?ts=gt/gs.width:b&&(ts=b/gs.height)}return es*ts},[b,Pt,Dt,nt,gt]);at.useEffect(function(){return()=>{gr(Tt)&&s&&ft&&ft(Tt)}},[s,I,Tt,ft]);function bt(){if(j){if(!Pt||!wt)return;j(Dg(Pt,wt))}if(s&&K){if(!gr(Tt)||!ot.current)return;K(Tt,ot.current)}}function Be(){yt&&(Ze(!1,yt.toString()),R&&R(yt))}at.useEffect(function(){Mt({type:"RESET"})},[Mt,I,Tt]),at.useEffect(function(){if(!I||!Et)return;const es=kl(I.getPage(Et)),gs=es;return es.promise.then(Lr=>{Mt({type:"RESOLVE",value:Lr})}).catch(Lr=>{Mt({type:"REJECT",error:Lr})}),()=>Dr(gs)},[Mt,I,Et]),at.useEffect(()=>{if(Pt!==void 0){if(Pt===!1){Be();return}bt()}},[Pt,wt]);const Kn=at.useMemo(()=>gr(Tt)&&Et&&gr(Dt)&&gr(wt)?{_className:i,canvasBackground:r,customTextRenderer:g,devicePixelRatio:p,onGetAnnotationsError:w,onGetAnnotationsSuccess:T,onGetStructTreeError:E,onGetStructTreeSuccess:D,onGetTextError:M,onGetTextSuccess:O,onRenderAnnotationLayerError:G,onRenderAnnotationLayerSuccess:Q,onRenderError:J,onRenderSuccess:st,onRenderTextLayerError:rt,onRenderTextLayerSuccess:it,page:Pt,pageIndex:Tt,pageNumber:Et,renderForms:_t,renderTextLayer:Y,rotate:Dt,scale:wt}:null,[i,r,g,p,w,T,E,D,M,O,G,Q,J,st,rt,it,Pt,Tt,Et,_t,Y,Dt,wt]),Za=at.useMemo(()=>Z_(pt,()=>Pt&&(wt?Dg(Pt,wt):void 0)),[pt,Pt,wt]),gn=`${Tt}@${wt}/${Dt}`;function Au(){switch(P){case"custom":return re(f),tt.jsx(f,{},`${gn}_custom`);case"none":return null;case"canvas":default:return tt.jsx(vT,{canvasRef:o},`${gn}_canvas`)}}function Tu(){return Y?tt.jsx(_T,{},`${gn}_text`):null}function ti(){return dt?tt.jsx(dT,{},`${gn}_annotations`):null}function Eu(){function ts(gs){return!!gs?.page}if(!ts(Kn))throw new Error("page is undefined");const es=typeof c=="function"?c(Kn):c;return tt.jsxs(nS.Provider,{value:Kn,children:[Au(),Tu(),ti(),es]})}function Bl(){return Et?I===null||Pt===void 0||Pt===null?tt.jsx(La,{type:"loading",children:typeof _=="function"?_():_}):I===!1||Pt===!1?tt.jsx(La,{type:"error",children:typeof v=="function"?v():v}):Eu():tt.jsx(La,{type:"no-data",children:typeof C=="function"?C():C})}return tt.jsx("div",{className:hu(i,h),"data-page-number":Et,ref:sS(S,ot),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${wt}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...Za,children:Bl()})}aT();Vn.workerSrc="pdf.worker.mjs";const qe=[];for(let u=0;u<256;++u)qe.push((u+256).toString(16).slice(1));function xT(u,t=0){return(qe[u[t+0]]+qe[u[t+1]]+qe[u[t+2]]+qe[u[t+3]]+"-"+qe[u[t+4]]+qe[u[t+5]]+"-"+qe[u[t+6]]+qe[u[t+7]]+"-"+qe[u[t+8]]+qe[u[t+9]]+"-"+qe[u[t+10]]+qe[u[t+11]]+qe[u[t+12]]+qe[u[t+13]]+qe[u[t+14]]+qe[u[t+15]]).toLowerCase()}let sg;const wT=new Uint8Array(16);function CT(){if(!sg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");sg=crypto.getRandomValues.bind(crypto)}return sg(wT)}const AT=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_b={randomUUID:AT};function TT(u,t,e){u=u||{};const i=u.random??u.rng?.()??CT();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,xT(i)}function Zo(u,t,e){return _b.randomUUID&&!u?_b.randomUUID():TT(u)}function B(u,t,e){return(t=(function(i){var s=(function(r,o){if(typeof r!="object"||!r)return r;var c=r[Symbol.toPrimitive];if(c!==void 0){var h=c.call(r,o);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(r)})(i,"string");return typeof s=="symbol"?s:s+""})(t))in u?Object.defineProperty(u,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):u[t]=e,u}function Sb(u,t){var e=Object.keys(u);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(u);t&&(i=i.filter((function(s){return Object.getOwnPropertyDescriptor(u,s).enumerable}))),e.push.apply(e,i)}return e}function F(u){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Sb(Object(e),!0).forEach((function(i){B(u,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(e)):Sb(Object(e)).forEach((function(i){Object.defineProperty(u,i,Object.getOwnPropertyDescriptor(e,i))}))}return u}function he(u,t){if(u==null)return{};var e,i,s=(function(o,c){if(o==null)return{};var h={};for(var f in o)if({}.hasOwnProperty.call(o,f)){if(c.indexOf(f)>=0)continue;h[f]=o[f]}return h})(u,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(u);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(u,e)&&(s[e]=u[e])}return s}function Ls(u,t){return t||(t=u.slice(0)),Object.freeze(Object.defineProperties(u,{raw:{value:Object.freeze(t)}}))}class xb{constructor(){B(this,"browserShadowBlurConstant",1),B(this,"DPI",96),B(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),B(this,"perfLimitSizeTotal",2097152),B(this,"maxCacheSideLimit",4096),B(this,"minCacheSideLimit",256),B(this,"disableStyleCopyPaste",!1),B(this,"enableGLFiltering",!0),B(this,"textureSize",4096),B(this,"forceGLPutImageData",!1),B(this,"cachesBoundsOfCurve",!1),B(this,"fontPaths",{}),B(this,"NUM_FRACTION_DIGITS",4)}}const Xt=new class extends xb{constructor(u){super(),this.configure(u)}configure(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,u)}addFonts(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=F(F({},this.fontPaths),u)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((u=>{delete this.fontPaths[u]}))}clearFonts(){this.fontPaths={}}restoreDefaults(u){const t=new xb,e=u?.reduce(((i,s)=>(i[s]=t[s],i)),{})||t;this.configure(e)}},Yn=function(u){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return console[u]("fabric",...e)};class Ms extends Error{constructor(t,e){super("fabric: ".concat(t),e)}}class ET extends Ms{constructor(t){super("".concat(t," 'options.signal' is in 'aborted' state"))}}class DT{}class MT extends DT{testPrecision(t,e){const i="precision ".concat(e,` float;
void main(){}`),s=t.createShader(t.FRAGMENT_SHADER);return!!s&&(t.shaderSource(s,i),t.compileShader(s),!!t.getShaderParameter(s,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((i=>this.testPrecision(e,i))),e.getExtension("WEBGL_lose_context").loseContext(),Yn("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const OT={};let wb;const Rs=()=>wb||(wb={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new MT,dispose(){},copyPasteData:OT}),Va=()=>Rs().document,gu=()=>Rs().window,cS=()=>{var u;return Math.max((u=Xt.devicePixelRatio)!==null&&u!==void 0?u:gu().devicePixelRatio,1)},ol=new class{constructor(){B(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(u){let{fontFamily:t,fontStyle:e,fontWeight:i}=u;t=t.toLowerCase();const s=this.charWidthsCache;s.has(t)||s.set(t,new Map);const r=s.get(t),o="".concat(e.toLowerCase(),"_").concat((i+"").toLowerCase());return r.has(o)||r.set(o,new Map),r.get(o)}clearFontCache(u){u?this.charWidthsCache.delete((u||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(u){const{perfLimitSizeTotal:t}=Xt,e=Math.sqrt(t*u);return[Math.floor(e),Math.floor(t/e)]}},Mg="6.9.0";function Bh(){}const Rl=Math.PI/2,Vh=2*Math.PI,up=Math.PI/180,ai=Object.freeze([1,0,0,1,0,0]),dp=16,In=.4477152502,Ft="center",Qt="left",vi="top",Og="bottom",Ce="right",bi="none",fp=/\r?\n/,hS="moving",pu="scaling",uS="rotating",gp="rotate",dS="skewing",yl="resizing",kT="modifyPoly",RT="modifyPath",Xh="changed",mu="scale",Si="scaleX",Zi="scaleY",Xa="skewX",Ya="skewY",Le="fill",_i="stroke",Yh="modified",ba="json",ng="svg",ct=new class{constructor(){this[ba]=new Map,this[ng]=new Map}has(u){return this[ba].has(u)}getClass(u){const t=this[ba].get(u);if(!t)throw new Ms("No class registered for ".concat(u));return t}setClass(u,t){t?this[ba].set(t,u):(this[ba].set(u.type,u),this[ba].set(u.type.toLowerCase(),u))}getSVGClass(u){return this[ng].get(u)}setSVGClass(u,t){this[ng].set(t??u.type.toLowerCase(),u)}},qh=new class extends Array{remove(u){const t=this.indexOf(u);t>-1&&this.splice(t,1)}cancelAll(){const u=this.splice(0);return u.forEach((t=>t.abort())),u}cancelByCanvas(u){if(!u)return[];const t=this.filter((e=>{var i;return e.target===u||typeof e.target=="object"&&((i=e.target)===null||i===void 0?void 0:i.canvas)===u}));return t.forEach((e=>e.abort())),t}cancelByTarget(u){if(!u)return[];const t=this.filter((e=>e.target===u));return t.forEach((e=>e.abort())),t}};class LT{constructor(){B(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach((i=>{let[s,r]=i;this.on(s,r)})),()=>this.off(t);if(e){const i=t;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(e),()=>this.off(i,e)}return()=>!1}once(t,e){if(typeof t=="object"){const i=[];return Object.entries(t).forEach((s=>{let[r,o]=s;i.push(this.once(r,o))})),()=>i.forEach((s=>s()))}if(e){const i=this.on(t,(function(){for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];e.call(this,...r),i()}));return i}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const i=this.__eventListeners[t],s=i.indexOf(e);s>-1&&i.splice(s,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const i in this.__eventListeners)this._removeEventListener(i);else typeof t=="object"?Object.entries(t).forEach((i=>{let[s,r]=i;this._removeEventListener(s,r)})):this._removeEventListener(t,e)}fire(t,e){var i;if(!this.__eventListeners)return;const s=(i=this.__eventListeners[t])===null||i===void 0?void 0:i.concat();if(s)for(let r=0;r<s.length;r++)s[r].call(this,e||{})}}const wa=(u,t)=>{const e=u.indexOf(t);return e!==-1&&u.splice(e,1),u},ln=u=>{if(u===0)return 1;switch(Math.abs(u)/Rl){case 1:case 3:return 0;case 2:return-1}return Math.cos(u)},cn=u=>{if(u===0)return 0;const t=u/Rl,e=Math.sign(u);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(u)};class X{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new X(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new X(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new X(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new X(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new X(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new X(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new X(this.x/t.x,this.y/t.y)}scalarDivide(t){return new X(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new X(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}midPointFrom(t){return this.lerp(t)}min(t){return new X(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new X(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}clone(){return new X(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pp;const i=cn(t),s=ln(t),r=this.subtract(e);return new X(r.x*s-r.y*i,r.x*i+r.y*s).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new X(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const pp=new X(0,0),Nh=u=>!!u&&Array.isArray(u._objects);function fS(u){class t extends u{constructor(){super(...arguments),B(this,"_objects",[])}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];const o=this._objects.push(...s);return s.forEach((c=>this._onObjectAdded(c))),o}insertAt(i){for(var s=arguments.length,r=new Array(s>1?s-1:0),o=1;o<s;o++)r[o-1]=arguments[o];return this._objects.splice(i,0,...r),r.forEach((c=>this._onObjectAdded(c))),this._objects.length}remove(){const i=this._objects,s=[];for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return o.forEach((h=>{const f=i.indexOf(h);f!==-1&&(i.splice(f,1),s.push(h),this._onObjectRemoved(h))})),s}forEachObject(i){this.getObjects().forEach(((s,r,o)=>i(s,r,o)))}getObjects(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return s.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...s)))}item(i){return this._objects[i]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(i,s){return!!this._objects.includes(i)||!!s&&this._objects.some((r=>r instanceof t&&r.contains(i,!0)))}complexity(){return this._objects.reduce(((i,s)=>i+=s.complexity?s.complexity():0),0)}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(wa(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0)}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(wa(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0)}sendObjectBackwards(i,s){if(!i)return!1;const r=this._objects.indexOf(i);if(r!==0){const o=this.findNewLowerIndex(i,r,s);return wa(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}bringObjectForward(i,s){if(!i)return!1;const r=this._objects.indexOf(i);if(r!==this._objects.length-1){const o=this.findNewUpperIndex(i,r,s);return wa(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}moveObjectTo(i,s){return i!==this._objects[s]&&(wa(this._objects,i),this._objects.splice(s,0,i),this._onStackOrderChanged(i),!0)}findNewLowerIndex(i,s,r){let o;if(r){o=s;for(let c=s-1;c>=0;--c)if(i.isOverlapping(this._objects[c])){o=c;break}}else o=s-1;return o}findNewUpperIndex(i,s,r){let o;if(r){o=s;for(let c=s+1;c<this._objects.length;++c)if(i.isOverlapping(this._objects[c])){o=c;break}}else o=s+1;return o}collectObjects(i){let{left:s,top:r,width:o,height:c}=i,{includeIntersecting:h=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const f=[],g=new X(s,r),p=g.add(new X(o,c));for(let v=this._objects.length-1;v>=0;v--){const b=this._objects[v];b.selectable&&b.visible&&(h&&b.intersectsWithRect(g,p)||b.isContainedWithinRect(g,p)||h&&b.containsPoint(g)||h&&b.containsPoint(p))&&f.push(b)}return f}}return t}class gS extends LT{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function Fh(u){return gu().requestAnimationFrame(u)}function PT(u){return gu().cancelAnimationFrame(u)}let BT=0;const qn=()=>BT++,hn=()=>{const u=Va().createElement("canvas");if(!u||u.getContext===void 0)throw new Ms("Failed to create `canvas` element");return u},NT=()=>Va().createElement("img"),Ji=u=>{const t=hn();return t.width=u.width,t.height=u.height,t},pS=(u,t,e)=>u.toDataURL("image/".concat(t),e),mS=(u,t,e)=>new Promise(((i,s)=>{u.toBlob(i,"image/".concat(t),e)})),Ae=u=>u*up,un=u=>u/up,FT=u=>u.every(((t,e)=>t===ai[e])),yi=(u,t,e)=>new X(u).transform(t,e),hs=u=>{const t=1/(u[0]*u[3]-u[1]*u[2]),e=[t*u[3],-t*u[1],-t*u[2],t*u[0],0,0],{x:i,y:s}=new X(u[4],u[5]).transform(e,!0);return e[4]=-i,e[5]=-s,e},Ke=(u,t,e)=>[u[0]*t[0]+u[2]*t[1],u[1]*t[0]+u[3]*t[1],u[0]*t[2]+u[2]*t[3],u[1]*t[2]+u[3]*t[3],e?0:u[0]*t[4]+u[2]*t[5]+u[4],e?0:u[1]*t[4]+u[3]*t[5]+u[5]],mp=(u,t)=>u.reduceRight(((e,i)=>i&&e?Ke(i,e,t):i||e),void 0)||ai.concat(),yS=u=>{let[t,e]=u;return Math.atan2(e,t)},Wh=u=>{const t=yS(u),e=Math.pow(u[0],2)+Math.pow(u[1],2),i=Math.sqrt(e),s=(u[0]*u[3]-u[2]*u[1])/i,r=Math.atan2(u[0]*u[2]+u[1]*u[3],e);return{angle:un(t),scaleX:i,scaleY:s,skewX:un(r),skewY:0,translateX:u[4]||0,translateY:u[5]||0}},Ll=function(u){return[1,0,0,1,u,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function qa(){let{angle:u=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=Ae(u),s=ln(i),r=cn(i);return[s,r,-r,s,t?t-(s*t-r*e):0,e?e-(r*t+s*e):0]}const yp=function(u){return[u,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,0,0]},vS=u=>Math.tan(Ae(u)),bS=u=>[1,0,vS(u),1,0,0],_S=u=>[1,vS(u),0,1,0,0],yu=u=>{let{scaleX:t=1,scaleY:e=1,flipX:i=!1,flipY:s=!1,skewX:r=0,skewY:o=0}=u,c=yp(i?-t:t,s?-e:e);return r&&(c=Ke(c,bS(r),!0)),o&&(c=Ke(c,_S(o),!0)),c},jT=u=>{const{translateX:t=0,translateY:e=0,angle:i=0}=u;let s=Ll(t,e);i&&(s=Ke(s,qa({angle:i})));const r=yu(u);return FT(r)||(s=Ke(s,r)),s},jh=function(u){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(i,s){if(t&&t.aborted)return s(new ET("loadImage"));const r=NT();let o;t&&(o=function(h){r.src="",s(h)},t.addEventListener("abort",o,{once:!0}));const c=function(){r.onload=r.onerror=null,o&&t?.removeEventListener("abort",o),i(r)};u?(r.onload=c,r.onerror=function(){o&&t?.removeEventListener("abort",o),s(new Ms("Error loading ".concat(r.src)))},e&&(r.crossOrigin=e),r.src=u):c()}))},vl=function(u){let{signal:t,reviver:e=Bh}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((i,s)=>{const r=[];t&&t.addEventListener("abort",s,{once:!0}),Promise.all(u.map((o=>ct.getClass(o.type).fromObject(o,{signal:t}).then((c=>(e(o,c),r.push(c),c)))))).then(i).catch((o=>{r.forEach((c=>{c.dispose&&c.dispose()})),s(o)})).finally((()=>{t&&t.removeEventListener("abort",s)}))}))},vu=function(u){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((e,i)=>{const s=[];t&&t.addEventListener("abort",i,{once:!0});const r=Object.values(u).map((c=>c&&c.type&&ct.has(c.type)?vl([c],{signal:t}).then((h=>{let[f]=h;return s.push(f),f})):c)),o=Object.keys(u);Promise.all(r).then((c=>c.reduce(((h,f,g)=>(h[o[g]]=f,h)),{}))).then(e).catch((c=>{s.forEach((h=>{h.dispose&&h.dispose()})),i(c)})).finally((()=>{t&&t.removeEventListener("abort",i)}))}))},Wa=function(u){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((t,e)=>(e in u&&(t[e]=u[e]),t)),{})},vp=(u,t)=>Object.keys(u).reduce(((e,i)=>(t(u[i],i,u)&&(e[i]=u[i]),e)),{}),oe=(u,t)=>parseFloat(Number(u).toFixed(t)),bl=u=>"matrix("+u.map((t=>oe(t,Xt.NUM_FRACTION_DIGITS))).join(" ")+")",Qi=u=>!!u&&u.toLive!==void 0,Cb=u=>!!u&&typeof u.toObject=="function",Ab=u=>!!u&&u.offsetX!==void 0&&"source"in u,mr=u=>!!u&&"multiSelectionStacking"in u;function SS(u){const t=u&&cs(u);let e=0,i=0;if(!u||!t)return{left:e,top:i};let s=u;const r=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===t?(e=o.scrollLeft||r.scrollLeft||0,i=o.scrollTop||r.scrollTop||0):(e+=s.scrollLeft||0,i+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:e,top:i}}const cs=u=>u.ownerDocument||null,xS=u=>{var t;return((t=u.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},wS=function(u,t,e){let{width:i,height:s}=e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;u.width=i,u.height=s,r>1&&(u.setAttribute("width",(i*r).toString()),u.setAttribute("height",(s*r).toString()),t.scale(r,r))},kg=(u,t)=>{let{width:e,height:i}=t;e&&(u.style.width=typeof e=="number"?"".concat(e,"px"):e),i&&(u.style.height=typeof i=="number"?"".concat(i,"px"):i)};function Tb(u){return u.onselectstart!==void 0&&(u.onselectstart=()=>!1),u.style.userSelect=bi,u}class CS{constructor(t){B(this,"_originalCanvasStyle",void 0),B(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(i=t)&&i.getContext!==void 0?t:t&&Va().getElementById(t)||hn();var i;if(e.hasAttribute("data-fabric"))throw new Ms("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:i}=t;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(e)),s.setAttribute("height","".concat(i)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:i,ctx:s}=this.lower;wS(i,s,t,e)}setCSSDimensions(t){kg(this.lower.el,t)}calcOffset(){return(function(t){var e;const i=t&&cs(t),s={left:0,top:0};if(!i)return s;const r=((e=xS(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};s.left+=parseInt(r.borderLeftWidth,10)||0,s.top+=parseInt(r.borderTopWidth,10)||0,s.left+=parseInt(r.paddingLeft,10)||0,s.top+=parseInt(r.paddingTop,10)||0;let o={left:0,top:0};const c=i.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());const h=SS(t);return{left:o.left+h.left-(c.clientLeft||0)+s.left,top:o.top+h.top-(c.clientTop||0)+s.top}})(this.lower.el)}dispose(){Rs().dispose(this.lower.el),delete this.lower}}const zT={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...ai]},IT=["objects"];class Pl extends fS(gS){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return Pl.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new CS(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];const r=super.insertAt(t,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),r}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(Yn("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?cS():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(t,e){return this.setDimensions({width:t},e)}setHeight(t,e){return this.setDimensions({height:t},e)}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const s=F({width:this.width,height:this.height},t);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}i||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const i=t,s=[...this.viewportTransform],r=yi(t,hs(s));s[0]=e,s[3]=e;const o=yi(r,s);s[4]+=i.x-o.x,s[5]+=i.y-o.y,this.setViewportTransform(s)}setZoom(t){this.zoomToPoint(new X(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new X(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Fh((()=>this.renderAndReset())))}calcViewportBoundaries(){const t=this.width,e=this.height,i=hs(this.viewportTransform),s=yi({x:0,y:0},i),r=yi({x:t,y:e},i),o=s.min(r),c=s.max(r);return this.vptCoords={tl:o,tr:new X(c.x,o.y),bl:new X(o.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(PT(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const i=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality="best",this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,s)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const i=this.viewportTransform;t.save(),t.transform(...i),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let i=0,s=e.length;i<s;++i)e[i]&&e[i].render(t)}_renderBackgroundOrOverlay(t,e){const i=this["".concat(e,"Color")],s=this["".concat(e,"Image")],r=this.viewportTransform,o=this["".concat(e,"Vpt")];if(!i&&!s)return;const c=Qi(i);if(i){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=c?i.toLive(t):i,o&&t.transform(...r),c){t.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);const h=i.gradientTransform||i.patternTransform;h&&t.transform(...h)}t.fill(),t.restore()}if(s){t.save();const{skipOffscreen:h}=this;this.skipOffscreen=o,o&&t.transform(...r),s.render(t),this.skipOffscreen=h,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new X(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new X(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new X(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new X(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new X(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return yi(this.getCenterPoint(),hs(this.viewportTransform))}_centerObject(t,e){t.setXY(e,Ft,Ft),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const i=this.clipPath,s=i&&!i.excludeFromExport?this._toObject(i,t,e):null;return F(F(F({version:Mg},Wa(this,e)),{},{objects:this._objects.filter((r=>!r.excludeFromExport)).map((r=>this._toObject(r,t,e)))},this.__serializeBgOverlay(t,e)),s?{clipPath:s}:null)}_toObject(t,e,i){let s;this.includeDefaultValues||(s=t.includeDefaultValues,t.includeDefaultValues=!1);const r=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=!!s),r}__serializeBgOverlay(t,e){const i={},s=this.backgroundImage,r=this.overlayImage,o=this.backgroundColor,c=this.overlayColor;return Qi(o)?o.excludeFromExport||(i.background=o.toObject(e)):o&&(i.background=o),Qi(c)?c.excludeFromExport||(i.overlay=c.toObject(e)):c&&(i.overlay=c),s&&!s.excludeFromExport&&(i.backgroundImage=this._toObject(s,t,e)),r&&!r.excludeFromExport&&(i.overlayImage=this._toObject(r,t,e)),i}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const i=e.width||"".concat(this.width),s=e.height||"".concat(this.height),r=Xt.NUM_FRACTION_DIGITS,o=e.viewBox;let c;if(o)c='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const h=this.viewportTransform;c='viewBox="'.concat(oe(-h[4]/h[0],r)," ").concat(oe(-h[5]/h[3],r)," ").concat(oe(this.width/h[0],r)," ").concat(oe(this.height/h[3],r),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',s,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Mg,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId="CLIPPATH_".concat(qn()),'<clipPath id="'.concat(e.clipPathId,`" >
`).concat(e.toClipPathSVG(t.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((t=>{const e=this["".concat(t,"Color")];if(Qi(e)){const i=this["".concat(t,"Vpt")],s=this.viewportTransform,r={isType:()=>!1,width:this.width/(i?s[0]:1),height:this.height/(i?s[3]:1)};return e.toSVG(r,{additionalTransform:i?bl(s):""})}})).join("")}createSVGFontFacesMarkup(){const t=[],e={},i=Xt.fontPaths;this._objects.forEach((function r(o){t.push(o),Nh(o)&&o._objects.forEach(r)})),t.forEach((r=>{if(!(o=r)||typeof o._renderText!="function")return;var o;const{styles:c,fontFamily:h}=r;!e[h]&&i[h]&&(e[h]=!0,c&&Object.values(c).forEach((f=>{Object.values(f).forEach((g=>{let{fontFamily:p=""}=g;!e[p]&&i[p]&&(e[p]=!0)}))})))}));const s=Object.keys(e).map((r=>`		@font-face {
			font-family: '`.concat(r,`';
			src: url('`).concat(i[r],`');
		}
`))).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(t,e){this.forEachObject((i=>{i.excludeFromExport||this._setSVGObject(t,i,e)}))}_setSVGObject(t,e,i){t.push(e.toSVG(i))}_setSVGBgOverlayImage(t,e,i){const s=this[e];s&&!s.excludeFromExport&&s.toSVG&&t.push(s.toSVG(i))}_setSVGBgOverlayColor(t,e){const i=this["".concat(e,"Color")];if(i)if(Qi(i)){const s=i.repeat||"",r=this.width,o=this.height,c=this["".concat(e,"Vpt")]?bl(hs(this.viewportTransform)):"";t.push('<rect transform="'.concat(c," translate(").concat(r/2,",").concat(o/2,')" x="').concat(i.offsetX-r/2,'" y="').concat(i.offsetY-o/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!Ab(i)?r:i.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!Ab(i)?o:i.source.height,'" fill="url(#SVGID_').concat(i.id,`)"></rect>
`))}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new Ms("`json` is undefined"));const s=typeof t=="string"?JSON.parse(t):t,{objects:r=[]}=s,o=he(s,IT),{backgroundImage:c,background:h,overlayImage:f,overlay:g,clipPath:p}=o,v=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([vl(r,{reviver:e,signal:i}),vu({backgroundImage:c,backgroundColor:h,overlayImage:f,overlayColor:g,clipPath:p},{signal:i})]).then((b=>{let[S,_]=b;return this.clear(),this.add(...S),this.set(o),this.set(_),this.renderOnAddRemove=v,this}))}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Ji(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:s=1,enableRetinaScaling:r=!1}=t,o=s*(r?this.getRetinaScaling():1);return pS(this.toCanvasElement(o,t),e,i)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:i=1,multiplier:s=1,enableRetinaScaling:r=!1}=t,o=s*(r?this.getRetinaScaling():1);return mS(this.toCanvasElement(o,t),e,i)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:i,left:s,top:r,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(e||this.width)*t,h=(i||this.height)*t,f=this.getZoom(),g=this.width,p=this.height,v=this.skipControlsDrawing,b=f*t,S=this.viewportTransform,_=[b,0,0,b,(S[4]-(s||0))*t,(S[5]-(r||0))*t],C=this.enableRetinaScaling,w=Ji({width:c,height:h}),T=o?this._objects.filter((E=>o(E))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=_,this.width=c,this.height=h,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),T),this.viewportTransform=S,this.width=g,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=C,this.skipControlsDrawing=v,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),qh.cancelByCanvas(this),this.disposed=!0,new Promise(((t,e)=>{const i=()=>{this.destroy(),t(!0)};i.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=i:i()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((t=>t.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}B(Pl,"ownDefaults",zT);const HT=["touchstart","touchmove","touchend"],UT=u=>{const t=SS(u.target),e=(function(i){const s=i.changedTouches;return s&&s[0]?s[0]:i})(u);return new X(e.clientX+t.left,e.clientY+t.top)},Rg=u=>HT.includes(u.type)||u.pointerType==="touch",Eb=u=>{u.preventDefault(),u.stopPropagation()},rn=u=>{let t=0,e=0,i=0,s=0;for(let r=0,o=u.length;r<o;r++){const{x:c,y:h}=u[r];(c>i||!r)&&(i=c),(c<t||!r)&&(t=c),(h>s||!r)&&(s=h),(h<e||!r)&&(e=h)}return{left:t,top:e,width:i-t,height:s-e}},GT=["translateX","translateY","scaleX","scaleY"],VT=(u,t)=>Kh(u,Ke(t,u.calcOwnMatrix())),Kh=(u,t)=>{const e=Wh(t),{translateX:i,translateY:s,scaleX:r,scaleY:o}=e,c=he(e,GT),h=new X(i,s);u.flipX=!1,u.flipY=!1,Object.assign(u,c),u.set({scaleX:r,scaleY:o}),u.setPositionByOrigin(h,Ft,Ft)},XT=u=>{u.scaleX=1,u.scaleY=1,u.skewX=0,u.skewY=0,u.flipX=!1,u.flipY=!1,u.rotate(0)},AS=u=>({scaleX:u.scaleX,scaleY:u.scaleY,skewX:u.skewX,skewY:u.skewY,angle:u.angle,left:u.left,flipX:u.flipX,flipY:u.flipY,top:u.top}),bp=(u,t,e)=>{const i=u/2,s=t/2,r=[new X(-i,-s),new X(i,-s),new X(-i,s),new X(i,s)].map((c=>c.transform(e))),o=rn(r);return new X(o.width,o.height)},bu=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ai;return Ke(hs(arguments.length>1&&arguments[1]!==void 0?arguments[1]:ai),u)},Pa=function(u){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ai,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ai;return u.transform(bu(t,e))},YT=function(u){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ai,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ai;return u.transform(bu(t,e),!0)},qT=(u,t,e)=>{const i=bu(t,e);return Kh(u,Ke(i,u.calcOwnMatrix())),i},TS=(u,t)=>{var e;const{transform:{target:i}}=t;(e=i.canvas)===null||e===void 0||e.fire("object:".concat(u),F(F({},t),{},{target:i})),i.fire(u,t)},WT={left:-.5,top:-.5,center:0,bottom:.5,right:.5},ke=u=>typeof u=="string"?WT[u]:u-.5,$h="not-allowed";function ES(u){return ke(u.originX)===ke(Ft)&&ke(u.originY)===ke(Ft)}function Db(u){return .5-ke(u)}const ds=(u,t)=>u[t],DS=(u,t,e,i)=>({e:u,transform:t,pointer:new X(e,i)});function MS(u,t){const e=u.getTotalAngle()+un(Math.atan2(t.y,t.x))+360;return Math.round(e%360/45)}function _p(u,t,e,i,s){var r;let{target:o,corner:c}=u;const h=o.controls[c],f=((r=o.canvas)===null||r===void 0?void 0:r.getZoom())||1,g=o.padding/f,p=(function(v,b,S,_){const C=v.getRelativeCenterPoint(),w=S!==void 0&&_!==void 0?v.translateToGivenOrigin(C,Ft,Ft,S,_):new X(v.left,v.top);return(v.angle?b.rotate(-Ae(v.angle),C):b).subtract(w)})(o,new X(i,s),t,e);return p.x>=g&&(p.x-=g),p.x<=-g&&(p.x+=g),p.y>=g&&(p.y-=g),p.y<=g&&(p.y+=g),p.x-=h.offsetX,p.y-=h.offsetY,p}const KT=(u,t,e,i)=>{const{target:s,offsetX:r,offsetY:o}=t,c=e-r,h=i-o,f=!ds(s,"lockMovementX")&&s.left!==c,g=!ds(s,"lockMovementY")&&s.top!==h;return f&&s.set(Qt,c),g&&s.set(vi,h),(f||g)&&TS(hS,DS(u,t,e,i)),f||g},Qh=u=>u.replace(/\s+/g," "),Mb={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},rg=(u,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?u+6*(t-u)*e:e<.5?t:e<2/3?u+(t-u)*(2/3-e)*6:u),Ob=(u,t,e,i)=>{u/=255,t/=255,e/=255;const s=Math.max(u,t,e),r=Math.min(u,t,e);let o,c;const h=(s+r)/2;if(s===r)o=c=0;else{const f=s-r;switch(c=h>.5?f/(2-s-r):f/(s+r),s){case u:o=(t-e)/f+(t<e?6:0);break;case t:o=(e-u)/f+2;break;case e:o=(u-t)/f+4}o/=6}return[Math.round(360*o),Math.round(100*c),Math.round(100*h),i]},kb=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(u)/(u.endsWith("%")?100:1)},lh=u=>Math.min(Math.round(u),255).toString(16).toUpperCase().padStart(2,"0"),Rb=u=>{let[t,e,i,s=1]=u;const r=Math.round(.3*t+.59*e+.11*i);return[r,r,r,s]};class $t{constructor(t){if(B(this,"isUnrecognised",!1),t)if(t instanceof $t)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,i,s,r=1]=t;this.setSource([e,i,s,r])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in Mb&&(t=Mb[t]),t==="transparent"?[255,255,255,0]:$t.sourceFromHex(t)||$t.sourceFromRgb(t)||$t.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,i]=this.getSource();return"rgb(".concat(t,",").concat(e,",").concat(i,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[t,e,i]=Ob(...this.getSource());return"hsl(".concat(t,",").concat(e,"%,").concat(i,"%)")}toHsla(){const[t,e,i,s]=Ob(...this.getSource());return"hsla(".concat(t,",").concat(e,"%,").concat(i,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,i,s]=this.getSource();return"".concat(lh(t)).concat(lh(e)).concat(lh(i)).concat(lh(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(Rb(this.getSource())),this}toBlackWhite(t){const[e,,,i]=Rb(this.getSource()),s=e<(t||127)?0:255;return this.setSource([s,s,s,i]),this}overlayWith(t){t instanceof $t||(t=new $t(t));const e=this.getSource(),i=t.getSource(),[s,r,o]=e.map(((c,h)=>Math.round(.5*c+.5*i[h])));return this.setSource([s,r,o,e[3]]),this}static fromRgb(t){return $t.fromRgba(t)}static fromRgba(t){return new $t($t.sourceFromRgb(t))}static sourceFromRgb(t){const e=Qh(t).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(e){const[i,s,r]=e.slice(1,4).map((o=>{const c=parseFloat(o);return o.endsWith("%")?Math.round(2.55*c):c}));return[i,s,r,kb(e[4])]}}static fromHsl(t){return $t.fromHsla(t)}static fromHsla(t){return new $t($t.sourceFromHsl(t))}static sourceFromHsl(t){const e=Qh(t).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!e)return;const i=($t.parseAngletoDegrees(e[1])%360+360)%360/360,s=parseFloat(e[2])/100,r=parseFloat(e[3])/100;let o,c,h;if(s===0)o=c=h=r;else{const f=r<=.5?r*(s+1):r+s-r*s,g=2*r-f;o=rg(g,f,i+1/3),c=rg(g,f,i),h=rg(g,f,i-1/3)}return[Math.round(255*o),Math.round(255*c),Math.round(255*h),kb(e[4])]}static fromHex(t){return new $t($t.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let i;i=e.length<=4?e.split("").map((h=>h+h)):e.match(/.{2}/g);const[s,r,o,c=255]=i.map((h=>parseInt(h,16)));return[s,r,o,c/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),i=parseFloat(e);return e.includes("rad")?un(i):e.includes("turn")?360*i:i}}const Ba=function(u){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dp;const e=/\D{0,2}$/.exec(u),i=parseFloat(u),s=Xt.DPI;switch(e?.[0]){case"mm":return i*s/25.4;case"cm":return i*s/2.54;case"in":return i*s;case"pt":return i*s/72;case"pc":return i*s/72*12;case"em":return i*t;default:return i}},$T=u=>{const[t,e]=u.trim().split(" "),[i,s]=(r=t)&&r!==bi?[r.slice(1,4),r.slice(5,8)]:r===bi?[r,r]:["Mid","Mid"];var r;return{meetOrSlice:e||"meet",alignX:i,alignY:s}},_l=function(u,t){let e,i,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e="url(#SVGID_".concat(t.id,")");else{const r=new $t(t),o=r.getAlpha();e=r.toRgb(),o!==1&&(i=o.toString())}else e="none";return s?"".concat(u,": ").concat(e,"; ").concat(i?"".concat(u,"-opacity: ").concat(i,"; "):""):"".concat(u,'="').concat(e,'" ').concat(i?"".concat(u,'-opacity="').concat(i,'" '):"")};class OS{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):bi,r=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",h=this.strokeMiterLimit?this.strokeMiterLimit:"4",f=this.opacity!==void 0?this.opacity:"1",g=this.visible?"":" visibility: hidden;",p=t?"":this.getSvgFilter(),v=_l(Le,this.fill);return[_l(_i,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",h,"; ",v,"fill-rule: ",e,"; ","opacity: ",f,";",p,g].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=t?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(bl(i));return"".concat(s).concat(e,'" ')}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),r=t.indexOf("COMMON_PARTS");return t[r]=s,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:i,withShadow:s,additionalTransform:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=e?"":'style="'.concat(this.getSvgStyles(),'" '),c=s?'style="'.concat(this.getSvgFilter(),'" '):"",h=this.clipPath,f=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",g=h&&h.absolutePositioned,p=this.stroke,v=this.fill,b=this.shadow,S=[],_=t.indexOf("COMMON_PARTS");let C;h&&(h.clipPathId="CLIPPATH_".concat(qn()),C='<clipPath id="'.concat(h.clipPathId,`" >
`).concat(h.toClipPathSVG(i),`</clipPath>
`)),g&&S.push("<g ",c,this.getSvgCommons(),` >
`),S.push("<g ",this.getSvgTransform(!1),g?"":c+this.getSvgCommons(),` >
`);const w=[o,f,e?"":this.addPaintOrder()," ",r?'transform="'.concat(r,'" '):""].join("");return t[_]=w,Qi(v)&&S.push(v.toSVG(this)),Qi(p)&&S.push(p.toSVG(this)),b&&S.push(b.toSVG(this)),h&&S.push(C),S.push(t.join("")),S.push(`</g>
`),g&&S.push(`</g>
`),i?i(S.join("")):S.join("")}addPaintOrder(){return this.paintFirst!==Le?' paint-order="'.concat(this.paintFirst,'" '):""}}function _u(u){return new RegExp("^("+u.join("|")+")\\b","i")}const Mr="textDecorationThickness",kS=["fontSize","fontWeight","fontFamily","fontStyle"],RS=["underline","overline","linethrough"],LS=[...kS,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],PS=[...LS,...RS,"textBackgroundColor","direction",Mr],QT=[...kS,...RS,_i,"strokeWidth",Le,"deltaY","textBackgroundColor",Mr],ZT={_reNewline:fp,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Qt,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Qt,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Mr]:66.667},Ds="justify",Zh="justify-left",ll="justify-right",cl="justify-center";var Lb,Pb,Bb;const us=String.raw(Lb||(Lb=Ls(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),ag=String.raw(Pb||(Pb=Ls(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),JT=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+us+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+us+"))?\\s+(.*)"),tE={cx:Qt,x:Qt,r:"radius",cy:vi,y:vi,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Mr},og="font-size",lg="clip-path";_u(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);_u(["symbol","image","marker","pattern","view","svg"]);const Nb=_u(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(Bb||(Bb=Ls(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),us,ag,us,ag,us,ag,us));const eE=new X(1,0),BS=new X,NS=(u,t)=>u.rotate(t),Lg=(u,t)=>new X(t).subtract(u),Pg=u=>u.distanceFrom(BS),Bg=(u,t)=>Math.atan2(hl(u,t),sE(u,t)),iE=u=>Bg(eE,u),Sp=u=>u.eq(BS)?u:u.scalarDivide(Pg(u)),FS=function(u){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Sp(new X(-u.y,u.x).scalarMultiply(t?1:-1))},hl=(u,t)=>u.x*t.y-u.y*t.x,sE=(u,t)=>u.x*t.x+u.y*t.y,Fb=(u,t,e)=>{if(u.eq(t)||u.eq(e))return!0;const i=hl(t,e),s=hl(t,u),r=hl(e,u);return i>=0?s>=0&&r<=0:!(s<=0&&r>=0)},jb="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",zb=new RegExp("(?:\\s|^)"+jb+jb+"("+us+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ks{constructor(t){const e=typeof t=="string"?ks.parseShadow(t):t;Object.assign(this,ks.ownDefaults,e),this.id=qn()}static parseShadow(t){const e=t.trim(),[,i=0,s=0,r=0]=(zb.exec(e)||[]).map((o=>parseFloat(o)||0));return{color:(e.replace(zb,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:s,blur:r}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=NS(new X(this.offsetX,this.offsetY),Ae(-t.angle)),i=new $t(this.color);let s=40,r=40;return t.width&&t.height&&(s=100*oe((Math.abs(e.x)+this.blur)/t.width,Xt.NUM_FRACTION_DIGITS)+20,r=100*oe((Math.abs(e.y)+this.blur)/t.height,Xt.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(r,'%" height="').concat(100+2*r,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(oe(this.blur?this.blur/2:0,Xt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(oe(e.x,Xt.NUM_FRACTION_DIGITS),'" dy="').concat(oe(e.y,Xt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(i.toRgb(),'" flood-opacity="').concat(i.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=ks.ownDefaults;return this.includeDefaultValues?t:vp(t,((i,s)=>i!==e[s]))}static async fromObject(t){return new this(t)}}B(ks,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),B(ks,"type","shadow"),ct.setClass(ks,"shadow");const Ha=(u,t,e)=>Math.max(u,Math.min(t,e)),nE=[vi,Qt,Si,Zi,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Xa,Ya],dn=[Le,_i,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],rE={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Qt,originY:vi,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Le,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},aE=(u,t,e,i)=>-e*Math.cos(u/i*Rl)+e+t,oE=()=>!1;class xp{constructor(t){let{startValue:e,byValue:i,duration:s=500,delay:r=0,easing:o=aE,onStart:c=Bh,onChange:h=Bh,onComplete:f=Bh,abort:g=oE,target:p}=t;B(this,"_state","pending"),B(this,"durationProgress",0),B(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=r,this.easing=o,this._onStart=c,this._onChange=h,this._onComplete=f,this._abort=g,this.target=p,this.startValue=e,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>Fh(t)),this.delay):Fh(t)}tick(t){const e=(t||+new Date)-this.startTime,i=Math.min(e,this.duration);this.durationProgress=i/this.duration;const{value:s,valueProgress:r}=this.calculate(i);this.value=Object.freeze(s),this.valueProgress=r,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Fh(this.tick)))}register(){qh.push(this)}unregister(){qh.remove(this)}abort(){this._state="aborted",this.unregister()}}const lE=["startValue","endValue"];class cE extends xp{constructor(t){let{startValue:e=0,endValue:i=100}=t;super(F(F({},he(t,lE)),{},{startValue:e,byValue:i-e}))}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}const hE=["startValue","endValue"];class uE extends xp{constructor(t){let{startValue:e=[0],endValue:i=[100]}=t;super(F(F({},he(t,hE)),{},{startValue:e,byValue:i.map(((s,r)=>s-e[r]))}))}calculate(t){const e=this.startValue.map(((i,s)=>this.easing(t,i,this.byValue[s],this.duration,s)));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const dE=["startValue","endValue","easing","onChange","onComplete","abort"],fE=(u,t,e,i)=>t+e*(1-Math.cos(u/i*Rl)),cg=u=>u&&((t,e,i)=>u(new $t(t).toRgba(),e,i));class gE extends xp{constructor(t){let{startValue:e,endValue:i,easing:s=fE,onChange:r,onComplete:o,abort:c}=t,h=he(t,dE);const f=new $t(e).getSource(),g=new $t(i).getSource();super(F(F({},h),{},{startValue:f,byValue:g.map(((p,v)=>p-f[v])),easing:s,onChange:cg(r),onComplete:cg(o),abort:cg(c)}))}calculate(t){const[e,i,s,r]=this.startValue.map(((c,h)=>this.easing(t,c,this.byValue[h],this.duration,h))),o=[...[e,i,s].map(Math.round),Ha(0,r,1)];return{value:o,valueProgress:o.map(((c,h)=>this.byValue[h]!==0?Math.abs((c-this.startValue[h])/this.byValue[h]):0)).find((c=>c!==0))||0}}}function jS(u){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(u)?new uE(u):new cE(u);return t.start(),t}function pE(u){const t=new gE(u);return t.start(),t}class pe{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some((e=>e.eq(t)))}append(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.points=this.points.concat(e.filter((s=>!this.includes(s)))),this}static isPointContained(t,e,i){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(i))return t.eq(e);if(e.x===i.x)return t.x===e.x&&(s||t.y>=Math.min(e.y,i.y)&&t.y<=Math.max(e.y,i.y));if(e.y===i.y)return t.y===e.y&&(s||t.x>=Math.min(e.x,i.x)&&t.x<=Math.max(e.x,i.x));{const r=Lg(e,i),o=Lg(e,t).divide(r);return s?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){const i=new X(t).setX(Math.min(t.x-1,...e.map((r=>r.x))));let s=0;for(let r=0;r<e.length;r++){const o=this.intersectSegmentSegment(e[r],e[(r+1)%e.length],t,i);if(o.includes(t))return!0;s+=+(o.status==="Intersection")}return s%2==1}static intersectLineLine(t,e,i,s){let r=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=e.x-t.x,h=e.y-t.y,f=s.x-i.x,g=s.y-i.y,p=t.x-i.x,v=t.y-i.y,b=f*v-g*p,S=c*v-h*p,_=g*c-f*h;if(_!==0){const C=b/_,w=S/_;return(r||0<=C&&C<=1)&&(o||0<=w&&w<=1)?new pe("Intersection").append(new X(t.x+C*c,t.y+C*h)):new pe}if(b===0||S===0){const C=r||o||pe.isPointContained(t,i,s)||pe.isPointContained(e,i,s)||pe.isPointContained(i,t,e)||pe.isPointContained(s,t,e);return new pe(C?"Coincident":void 0)}return new pe("Parallel")}static intersectSegmentLine(t,e,i,s){return pe.intersectLineLine(t,e,i,s,!1,!0)}static intersectSegmentSegment(t,e,i,s){return pe.intersectLineLine(t,e,i,s,!1,!1)}static intersectLinePolygon(t,e,i){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const r=new pe,o=i.length;for(let c,h,f,g=0;g<o;g++){if(c=i[g],h=i[(g+1)%o],f=pe.intersectLineLine(t,e,c,h,s,!1),f.status==="Coincident")return f;r.append(...f.points)}return r.points.length>0&&(r.status="Intersection"),r}static intersectSegmentPolygon(t,e,i){return pe.intersectLinePolygon(t,e,i,!1)}static intersectPolygonPolygon(t,e){const i=new pe,s=t.length,r=[];for(let o=0;o<s;o++){const c=t[o],h=t[(o+1)%s],f=pe.intersectSegmentPolygon(c,h,e);f.status==="Coincident"?(r.push(f),i.append(c,h)):i.append(...f.points)}return r.length>0&&r.length===t.length?new pe("Coincident"):(i.points.length>0&&(i.status="Intersection"),i)}static intersectPolygonRectangle(t,e,i){const s=e.min(i),r=e.max(i),o=new X(r.x,s.y),c=new X(s.x,r.y);return pe.intersectPolygonPolygon(t,[s,o,r,c])}}class mE extends gS{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?yi(t,this.group.calcTransformMatrix()):t}setXY(t,e,i){this.group&&(t=yi(t,hs(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,i)}getRelativeXY(){return new X(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,i)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:i,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),r=[t,e,i,s];if(this.group){const o=this.group.calcTransformMatrix();return r.map((c=>yi(c,o)))}return r}intersectsWithRect(t,e){return pe.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=pe.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every((e=>t.containsPoint(e)))}isContainedWithinRect(t,e){const{left:i,top:s,width:r,height:o}=this.getBoundingRect();return i>=t.x&&i+r<=e.x&&s>=t.y&&s+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return pe.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some((i=>i.x<=e.x&&i.x>=t.x&&i.y<=e.y&&i.y>=t.y))||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every((i=>(i.x>=e.x||i.x<=t.x)&&(i.y>=e.y||i.y<=t.y)))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return rn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(Si,t),this._set(Zi,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?un(yS(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||ai.concat()}calcACoords(){const t=qa({angle:this.angle}),{x:e,y:i}=this.getRelativeCenterPoint(),s=Ll(e,i),r=Ke(s,t),o=this._getTransformedDimensions(),c=o.x/2,h=o.y/2;return{tl:yi({x:-c,y:-h},r),tr:yi({x:c,y:-h},r),bl:yi({x:-c,y:h},r),br:yi({x:c,y:h},r)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,ke(this.originX),ke(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const i=this.transformMatrixKey(t),s=this.matrixCache;return s&&s.key.every(((r,o)=>r===i[o]))?s.value:(this.group&&(e=Ke(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:i,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key===t)return e.value;const i=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},r=jT(s);return this.ownMatrixCache={key:t,value:r},r}_getNonTransformedDimensions(){return new X(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=F({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},t),i=e.strokeWidth;let s=i,r=0;this.strokeUniform&&(s=0,r=i);const o=e.width+s,c=e.height+s;let h;return h=e.skewX===0&&e.skewY===0?new X(o*e.scaleX,c*e.scaleY):bp(o,c,yu(e)),h.scalarAdd(r)}translateToGivenOrigin(t,e,i,s,r){let o=t.x,c=t.y;const h=ke(s)-ke(e),f=ke(r)-ke(i);if(h||f){const g=this._getTransformedDimensions();o+=h*g.x,c+=f*g.y}return new X(o,c)}translateToCenterPoint(t,e,i){if(e===Ft&&i===Ft)return t;const s=this.translateToGivenOrigin(t,e,i,Ft,Ft);return this.angle?s.rotate(Ae(this.angle),t):s}translateToOriginPoint(t,e,i){const s=this.translateToGivenOrigin(t,Ft,Ft,e,i);return this.angle?s.rotate(Ae(this.angle),t):s}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?yi(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new X(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,i){const s=this.translateToCenterPoint(t,e,i),r=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:r.x,top:r.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Qt,vi)}}const yE=["type"],vE=["extraParam"];let Js=class zh extends mE{static getDefaults(){return zh.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){Yn("warn","Setting type has no effect",t)}constructor(t){super(),B(this,"_cacheContext",null),Object.assign(this,zh.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=hn(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,i=t.height,s=Xt.maxCacheSideLimit,r=Xt.minCacheSideLimit;if(e<=s&&i<=s&&e*i<=Xt.perfLimitSizeTotal)return e<r&&(t.width=r),i<r&&(t.height=r),t;const o=e/i,[c,h]=ol.limitDimsByArea(o),f=Ha(r,c,s),g=Ha(r,h,s);return e>f&&(t.zoomX/=e/f,t.width=f,t.capped=!0),i>g&&(t.zoomY/=i/g,t.height=g,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),i=e.x*t.x/this.scaleX,s=e.y*t.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(s+2),zoomX:t.x,zoomY:t.y,x:i,y:s}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:i,height:s,zoomX:r,zoomY:o,x:c,y:h}=this._limitCacheSize(this._getCacheCanvasDimensions()),f=i!==t.width||s!==t.height,g=this.zoomX!==r||this.zoomY!==o;if(!t||!e)return!1;if(f||g){i!==t.width||s!==t.height?(t.width=i,t.height=s):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const p=c/2,v=h/2;return this.cacheTranslationX=Math.round(t.width/2-p)+p,this.cacheTranslationY=Math.round(t.height/2-v)+v,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(r,o),this.zoomX=r,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,i=this.calcTransformMatrix(!e);t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}getObjectScaling(){if(!this.group)return new X(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=Wh(this.calcTransformMatrix());return new X(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return t.scalarMultiply(e*i)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==Si&&t!==Zi||(e=this._constrainScale(e)),t===Si&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof ks||(e=new ks(e));const i=this[t]!==e;return this[t]=e,i&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:i,cacheTranslationX:s,cacheTranslationY:r}=this,{width:o,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:i,cacheTranslationX:s,cacheTranslationY:r,width:o,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===_i&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,i){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(i,0,0),t.restore()}drawObject(t,e,i){const s=this.fill,r=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,i),this.fill=s,this.stroke=r}createClipPathLayer(t,e){const i=Ji(e),s=i.getContext("2d");if(s.translate(e.cacheTranslationX,e.cacheTranslationY),s.scale(e.zoomX,e.zoomY),t._cacheCanvas=i,e.parentClipPaths.forEach((r=>{r.transform(s)})),e.parentClipPaths.push(t),t.absolutePositioned){const r=hs(this.calcTransformMatrix());s.transform(r[0],r[1],r[2],r[3],r[4],r[5])}return t.transform(s),t.drawObject(s,!0,e),i}_drawClipPath(t,e,i){if(!e)return;e._transformDone=!0;const s=this.createClipPathLayer(e,i);this.drawClipPathOnCache(t,e,s)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,i=this._cacheContext;return!(!e||!i||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&i&&!t&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),i.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const i=e.stroke;i&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,Qi(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(t,i):(t.strokeStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:i}=e;i&&(Qi(i)?(t.fillStyle=i.toLive(t),this._applyPatternGradientTransform(t,i)):t.fillStyle=i)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,i=this.canvas,s=this.getCanvasRetinaScaling(),[r,,,o]=i?.viewportTransform||ai,c=r*s,h=o*s,f=e.nonScaling?new X(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*Xt.browserShadowBlurConstant*(c+h)*(f.x+f.y)/4,t.shadowOffsetX=e.offsetX*c*f.x,t.shadowOffsetY=e.offsetY*h*f.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!Qi(e))return{offsetX:0,offsetY:0};const i=e.gradientTransform||e.patternTransform,s=-this.width/2+e.offsetX||0,r=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,s,r):t.transform(1,0,0,1,s,r),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:s,offsetY:r}}_renderPaintInOrder(t){this.paintFirst===_i?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var i;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),r=this.getCanvasRetinaScaling(),o=s.x/this.scaleX/r,c=s.y/this.scaleY/r,h=Ji({width:Math.ceil(o),height:Math.ceil(c)}),f=h.getContext("2d");f&&(f.beginPath(),f.moveTo(0,0),f.lineTo(o,0),f.lineTo(o,c),f.lineTo(0,c),f.closePath(),f.translate(o/2,c/2),f.scale(s.zoomX/this.scaleX/r,s.zoomY/this.scaleY/r),this._applyPatternGradientTransform(f,e),f.fillStyle=e.toLive(t),f.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(r*this.scaleX/s.zoomX,r*this.scaleY/s.zoomY),t.strokeStyle=(i=f.createPattern(h,"no-repeat"))!==null&&i!==void 0?i:"")}_findCenterFromElement(){return new X(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(ct.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=AS(this),i=this.group,s=this.shadow,r=Math.abs,o=t.enableRetinaScaling?cS():1,c=(t.multiplier||1)*o,h=t.canvasProvider||(T=>new Pl(T,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&XT(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&qT(this,this.getViewportTransform()),this.setCoords();const f=hn(),g=this.getBoundingRect(),p=this.shadow,v=new X;if(p){const T=p.blur,E=p.nonScaling?new X(1,1):this.getObjectScaling();v.x=2*Math.round(r(p.offsetX)+T)*r(E.x),v.y=2*Math.round(r(p.offsetY)+T)*r(E.y)}const b=g.width+v.x,S=g.height+v.y;f.width=Math.ceil(b),f.height=Math.ceil(S);const _=h(f);t.format==="jpeg"&&(_.backgroundColor="#fff"),this.setPositionByOrigin(new X(_.width/2,_.height/2),Ft,Ft);const C=this.canvas;_._objects=[this],this.set("canvas",_),this.setCoords();const w=_.toCanvasElement(c||1,t);return this.set("canvas",C),this.shadow=s,i&&(this.group=i),this.set(e),this.setCoords(),_._objects=[],_.destroy(),w}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pS(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mS(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:i,originY:s}=this;if(e){const{x:r,y:o}=this.getRelativeCenterPoint();this.originX=Ft,this.originY=Ft,this.left=r,this.top=o}if(this.set("angle",t),e){const{x:r,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),i,s);this.left=r,this.top=o,this.originX=i,this.originY=s}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){qh.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Rs().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce(((i,s)=>{let[r,o]=s;return i[r]=this._animate(r,o,e),i}),{})}_animate(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=t.split("."),r=this.constructor.colorProperties.includes(s[s.length-1]),{abort:o,startValue:c,onChange:h,onComplete:f}=i,g=F(F({},i),{},{target:this,startValue:c??s.reduce(((p,v)=>p[v]),this),endValue:e,abort:o?.bind(this),onChange:(p,v,b)=>{s.reduce(((S,_,C)=>(C===s.length-1&&(S[_]=p),S[_])),this),h&&h(p,v,b)},onComplete:(p,v,b)=>{this.setCoords(),f&&f(p,v,b)}});return r?pE(g):jS(g)}isDescendantOf(t){const{parent:e,group:i}=this;return e===t||i===t||!!e&&e.isDescendantOf(t)||!!i&&i!==e&&i.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),i=t.getAncestors();if(e.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[t,...i.slice(0,i.length-1)],common:[this]};for(let s,r=0;r<e.length;r++){if(s=e[r],s===t)return{fork:[this,...e.slice(0,r)],otherFork:[],common:e.slice(r)};for(let o=0;o<i.length;o++){if(this===i[o])return{fork:[],otherFork:[t,...i.slice(0,o)],common:[this,...e]};if(s===i[o])return{fork:[this,...e.slice(0,r)],otherFork:[t,...i.slice(0,o)],common:e.slice(r)}}}return{fork:[this,...e],otherFork:[t,...i],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const i=e.common[0]||this.canvas;if(!i)return;const s=e.fork.pop(),r=e.otherFork.pop(),o=i._objects.indexOf(s),c=i._objects.indexOf(r);return o>-1&&o>c}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(zh.customProperties,this.constructor.customProperties||[]);let e;const i=Xt.NUM_FRACTION_DIGITS,{clipPath:s,fill:r,stroke:o,shadow:c,strokeDashArray:h,left:f,top:g,originX:p,originY:v,width:b,height:S,strokeWidth:_,strokeLineCap:C,strokeDashOffset:w,strokeLineJoin:T,strokeUniform:E,strokeMiterLimit:D,scaleX:M,scaleY:O,angle:R,flipX:j,flipY:G,opacity:Q,visible:J,backgroundColor:st,fillRule:rt,paintFirst:it,globalCompositeOperation:lt,skewX:L,skewY:I}=this;s&&!s.excludeFromExport&&(e=s.toObject(t.concat("inverted","absolutePositioned")));const K=_t=>oe(_t,i),dt=F(F({},Wa(this,t)),{},{type:this.constructor.type,version:Mg,originX:p,originY:v,left:K(f),top:K(g),width:K(b),height:K(S),fill:Cb(r)?r.toObject():r,stroke:Cb(o)?o.toObject():o,strokeWidth:K(_),strokeDashArray:h&&h.concat(),strokeLineCap:C,strokeDashOffset:w,strokeLineJoin:T,strokeUniform:E,strokeMiterLimit:K(D),scaleX:K(M),scaleY:K(O),angle:K(R),flipX:j,flipY:G,opacity:K(Q),shadow:c&&c.toObject(),visible:J,backgroundColor:st,fillRule:rt,paintFirst:it,globalCompositeOperation:lt,skewX:K(L),skewY:K(I)},e?{clipPath:e}:null);return this.includeDefaultValues?dt:this._removeDefaultValues(dt)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),i=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return vp(t,((s,r)=>{if(r===Qt||r===vi||r==="type")return!0;const o=i[r];return s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&s.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(t){let e=he(t,yE),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=i,r=he(i,vE);return vu(e,r).then((o=>s?(delete o[s],new this(e[s],o)):new this(o)))}static fromObject(t,e){return this._fromObject(t,e)}};B(Js,"stateProperties",nE),B(Js,"cacheProperties",dn),B(Js,"ownDefaults",rE),B(Js,"type","FabricObject"),B(Js,"colorProperties",[Le,_i,"backgroundColor"]),B(Js,"customProperties",[]),ct.setClass(Js),ct.setClass(Js,"object");const Ka=(u,t,e)=>(i,s,r,o)=>{const c=t(i,s,r,o);return c&&TS(u,F(F({},DS(i,s,r,o)),e)),c};function $a(u){return(t,e,i,s)=>{const{target:r,originX:o,originY:c}=e,h=r.getRelativeCenterPoint(),f=r.translateToOriginPoint(h,o,c),g=u(t,e,i,s);return r.setPositionByOrigin(f,e.originX,e.originY),g}}const Ib=Ka(yl,$a(((u,t,e,i)=>{const s=_p(t,t.originX,t.originY,e,i);if(ke(t.originX)===ke(Ft)||ke(t.originX)===ke(Ce)&&s.x<0||ke(t.originX)===ke(Qt)&&s.x>0){const{target:r}=t,o=r.strokeWidth/(r.strokeUniform?r.scaleX:1),c=ES(t)?2:1,h=r.width,f=Math.abs(s.x*c/r.scaleX)-o;return r.set("width",Math.max(f,1)),h!==r.width}return!1})));function bE(u,t,e,i,s){i=i||{};const r=this.sizeX||i.cornerSize||s.cornerSize,o=this.sizeY||i.cornerSize||s.cornerSize,c=i.transparentCorners!==void 0?i.transparentCorners:s.transparentCorners,h=c?_i:Le,f=!c&&(i.cornerStrokeColor||s.cornerStrokeColor);let g,p=t,v=e;u.save(),u.fillStyle=i.cornerColor||s.cornerColor||"",u.strokeStyle=i.cornerStrokeColor||s.cornerStrokeColor||"",r>o?(g=r,u.scale(1,o/r),v=e*r/o):o>r?(g=o,u.scale(r/o,1),p=t*o/r):g=r,u.beginPath(),u.arc(p,v,g/2,0,Vh,!1),u[h](),f&&u.stroke(),u.restore()}function _E(u,t,e,i,s){i=i||{};const r=this.sizeX||i.cornerSize||s.cornerSize,o=this.sizeY||i.cornerSize||s.cornerSize,c=i.transparentCorners!==void 0?i.transparentCorners:s.transparentCorners,h=c?_i:Le,f=!c&&(i.cornerStrokeColor||s.cornerStrokeColor),g=r/2,p=o/2;u.save(),u.fillStyle=i.cornerColor||s.cornerColor||"",u.strokeStyle=i.cornerStrokeColor||s.cornerStrokeColor||"",u.translate(t,e);const v=s.getTotalAngle();u.rotate(Ae(v)),u["".concat(h,"Rect")](-g,-p,r,o),f&&u.strokeRect(-g,-p,r,o),u.restore()}class as{constructor(t){B(this,"visible",!0),B(this,"actionName",mu),B(this,"angle",0),B(this,"x",0),B(this,"y",0),B(this,"offsetX",0),B(this,"offsetY",0),B(this,"sizeX",0),B(this,"sizeY",0),B(this,"touchSizeX",0),B(this,"touchSizeY",0),B(this,"cursorStyle","crosshair"),B(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,i,s){var r;let{tl:o,tr:c,br:h,bl:f}=s;return((r=e.canvas)===null||r===void 0?void 0:r.getActiveObject())===e&&e.isControlVisible(t)&&pe.isPointInPolygon(i,[o,c,h,f])}getActionHandler(t,e,i){return this.actionHandler}getMouseDownHandler(t,e,i){return this.mouseDownHandler}getMouseUpHandler(t,e,i){return this.mouseUpHandler}cursorStyleHandler(t,e,i){return e.cursorStyle}getActionName(t,e,i){return e.actionName}getVisibility(t,e){var i,s;return(i=(s=t._controlsVisibility)===null||s===void 0?void 0:s[e])!==null&&i!==void 0?i:this.visible}setVisibility(t,e,i){this.visible=t}positionHandler(t,e,i,s){return new X(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,i,s,r,o){const c=mp([Ll(i,s),qa({angle:t}),yp((r?this.touchSizeX:this.sizeX)||e,(r?this.touchSizeY:this.sizeY)||e)]);return{tl:new X(-.5,-.5).transform(c),tr:new X(.5,-.5).transform(c),br:new X(.5,.5).transform(c),bl:new X(-.5,.5).transform(c)}}render(t,e,i,s,r){((s=s||{}).cornerStyle||r.cornerStyle)==="circle"?bE.call(this,t,e,i,s,r):_E.call(this,t,e,i,s,r)}}const SE=(u,t,e)=>e.lockRotation?$h:t.cursorStyle,xE=Ka(uS,$a(((u,t,e,i)=>{let{target:s,ex:r,ey:o,theta:c,originX:h,originY:f}=t;const g=s.translateToOriginPoint(s.getRelativeCenterPoint(),h,f);if(ds(s,"lockRotation"))return!1;const p=Math.atan2(o-g.y,r-g.x),v=Math.atan2(i-g.y,e-g.x);let b=un(v-p+c);if(s.snapAngle&&s.snapAngle>0){const _=s.snapAngle,C=s.snapThreshold||_,w=Math.ceil(b/_)*_,T=Math.floor(b/_)*_;Math.abs(b-T)<C?b=T:Math.abs(b-w)<C&&(b=w)}b<0&&(b=360+b),b%=360;const S=s.angle!==b;return s.angle=b,S})));function zS(u,t){const e=t.canvas,i=u[e.uniScaleKey];return e.uniformScaling&&!i||!e.uniformScaling&&i}function IS(u,t,e){const i=ds(u,"lockScalingX"),s=ds(u,"lockScalingY");if(i&&s||!t&&(i||s)&&e||i&&t==="x"||s&&t==="y")return!0;const{width:r,height:o,strokeWidth:c}=u;return r===0&&c===0&&t!=="y"||o===0&&c===0&&t!=="x"}const wE=["e","se","s","sw","w","nw","n","ne","e"],nl=(u,t,e)=>{const i=zS(u,e);if(IS(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",i))return $h;const s=MS(e,t);return"".concat(wE[s],"-resize")};function wp(u,t,e,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const r=t.target,o=s.by,c=zS(u,r);let h,f,g,p,v,b;if(IS(r,o,c))return!1;if(t.gestureScale)f=t.scaleX*t.gestureScale,g=t.scaleY*t.gestureScale;else{if(h=_p(t,t.originX,t.originY,e,i),v=o!=="y"?Math.sign(h.x||t.signX||1):1,b=o!=="x"?Math.sign(h.y||t.signY||1):1,t.signX||(t.signX=v),t.signY||(t.signY=b),ds(r,"lockScalingFlip")&&(t.signX!==v||t.signY!==b))return!1;if(p=r._getTransformedDimensions(),c&&!o){const C=Math.abs(h.x)+Math.abs(h.y),{original:w}=t,T=C/(Math.abs(p.x*w.scaleX/r.scaleX)+Math.abs(p.y*w.scaleY/r.scaleY));f=w.scaleX*T,g=w.scaleY*T}else f=Math.abs(h.x*r.scaleX/p.x),g=Math.abs(h.y*r.scaleY/p.y);ES(t)&&(f*=2,g*=2),t.signX!==v&&o!=="y"&&(t.originX=Db(t.originX),f*=-1,t.signX=v),t.signY!==b&&o!=="x"&&(t.originY=Db(t.originY),g*=-1,t.signY=b)}const S=r.scaleX,_=r.scaleY;return o?(o==="x"&&r.set(Si,f),o==="y"&&r.set(Zi,g)):(!ds(r,"lockScalingX")&&r.set(Si,f),!ds(r,"lockScalingY")&&r.set(Zi,g)),S!==r.scaleX||_!==r.scaleY}const ch=Ka(pu,$a(((u,t,e,i)=>wp(u,t,e,i)))),CE=Ka(pu,$a(((u,t,e,i)=>wp(u,t,e,i,{by:"x"})))),AE=Ka(pu,$a(((u,t,e,i)=>wp(u,t,e,i,{by:"y"})))),TE=["target","ex","ey","skewingSide"],hg={x:{counterAxis:"y",scale:Si,skew:Xa,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Zi,skew:Ya,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},EE=["ns","nesw","ew","nwse"],DE=(u,t,e)=>{if(t.x!==0&&ds(e,"lockSkewingY")||t.y!==0&&ds(e,"lockSkewingX"))return $h;const i=MS(e,t)%4;return"".concat(EE[i],"-resize")};function HS(u,t,e,i,s){const{target:r}=e,{counterAxis:o,origin:c,lockSkewing:h,skew:f,flip:g}=hg[u];if(ds(r,h))return!1;const{origin:p,flip:v}=hg[o],b=ke(e[p])*(r[v]?-1:1),S=-Math.sign(b)*(r[g]?-1:1),_=.5*-((r[f]===0&&_p(e,Ft,Ft,i,s)[u]>0||r[f]>0?1:-1)*S)+.5;return Ka(dS,$a(((w,T,E,D)=>(function(M,O,R){let{target:j,ex:G,ey:Q,skewingSide:J}=O,st=he(O,TE);const{skew:rt}=hg[M],it=R.subtract(new X(G,Q)).divide(new X(j.scaleX,j.scaleY))[M],lt=j[rt],L=st[rt],I=Math.tan(Ae(L)),K=M==="y"?j._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:j._getTransformedDimensions({scaleX:1,scaleY:1}).y,dt=2*it*J/Math.max(K,1)+I,_t=un(Math.atan(dt));j.set(rt,_t);const P=lt!==j[rt];if(P&&M==="y"){const{skewX:Y,scaleX:et}=j,nt=j._getTransformedDimensions({skewY:lt}),ft=j._getTransformedDimensions(),gt=Y!==0?nt.x/ft.x:1;gt!==1&&j.set(Si,gt*et)}return P})(u,T,new X(E,D)))))(t,F(F({},e),{},{[c]:_,skewingSide:S}),i,s)}const ME=(u,t,e,i)=>HS("x",u,t,e,i),OE=(u,t,e,i)=>HS("y",u,t,e,i);function Su(u,t){return u[t.canvas.altActionKey]}const hh=(u,t,e)=>{const i=Su(u,e);return t.x===0?i?Xa:Zi:t.y===0?i?Ya:Si:""},Ta=(u,t,e)=>Su(u,e)?DE(0,t,e):nl(u,t,e),Hb=(u,t,e,i)=>Su(u,t.target)?OE(u,t,e,i):CE(u,t,e,i),Ub=(u,t,e,i)=>Su(u,t.target)?ME(u,t,e,i):AE(u,t,e,i),US=()=>({ml:new as({x:-.5,y:0,cursorStyleHandler:Ta,actionHandler:Hb,getActionName:hh}),mr:new as({x:.5,y:0,cursorStyleHandler:Ta,actionHandler:Hb,getActionName:hh}),mb:new as({x:0,y:.5,cursorStyleHandler:Ta,actionHandler:Ub,getActionName:hh}),mt:new as({x:0,y:-.5,cursorStyleHandler:Ta,actionHandler:Ub,getActionName:hh}),tl:new as({x:-.5,y:-.5,cursorStyleHandler:nl,actionHandler:ch}),tr:new as({x:.5,y:-.5,cursorStyleHandler:nl,actionHandler:ch}),bl:new as({x:-.5,y:.5,cursorStyleHandler:nl,actionHandler:ch}),br:new as({x:.5,y:.5,cursorStyleHandler:nl,actionHandler:ch}),mtr:new as({x:0,y:-.5,actionHandler:xE,cursorStyleHandler:SE,offsetY:-40,withConnection:!0,actionName:gp})}),kE=()=>({mr:new as({x:.5,y:0,actionHandler:Ib,cursorStyleHandler:Ta,actionName:yl}),ml:new as({x:-.5,y:0,actionHandler:Ib,cursorStyleHandler:Ta,actionName:yl})}),RE=()=>F(F({},US()),kE());class Sl extends Js{static getDefaults(){return F(F({},super.getDefaults()),Sl.ownDefaults)}constructor(t){super(),Object.assign(this,this.constructor.createControls(),Sl.ownDefaults),this.setOptions(t)}static createControls(){return{controls:US()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,i=e.target,s=e.action;if(this===i&&s&&s.startsWith(mu))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const i=Object.entries(this.oCoords);for(let s=i.length-1;s>=0;s--){const[r,o]=i[s],c=this.controls[r];if(c.shouldActivate(r,this,t,e?o.touchCorner:o.corner))return this.__corner=r,{key:r,control:c,coord:this.oCoords[r]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),i=Ll(e.x,e.y),s=qa({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),r=Ke(i,s),o=Ke(t,r),c=Ke(o,[1/t[0],0,0,1/t[3],0,0]),h=this.group?Wh(this.calcTransformMatrix()):void 0;h&&(h.scaleX=Math.abs(h.scaleX),h.scaleY=Math.abs(h.scaleY));const f=this._calculateCurrentDimensions(h),g={};return this.forEachControl(((p,v)=>{const b=p.positionHandler(f,c,this,p);g[v]=Object.assign(b,this._calcCornerCoords(p,b))})),g}_calcCornerCoords(t,e){const i=this.getTotalAngle();return{corner:t.calcCornerCoords(i,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(i,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),s=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/s[0],1/s[3]),t.rotate(Ae(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=F({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},i);t.save(),t.strokeStyle=s.borderColor,this._setLineDash(t,s.borderDashArray),this.strokeBorders(t,e),s.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:i,hasControls:s}=this,r=F({hasBorders:i,hasControls:s},e),o=this.getViewportTransform(),c=r.hasBorders,h=r.hasControls,f=Ke(o,this.calcTransformMatrix()),g=Wh(f);t.save(),t.translate(g.translateX,g.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(g.angle-=180),t.rotate(Ae(this.group?g.angle:this.angle)),c&&this.drawBorders(t,g,e),h&&this.drawControls(t,e),t.restore()}drawBorders(t,e,i){let s;if(i&&i.forActiveSelection||this.group){const r=bp(this.width,this.height,yu(e)),o=this.isStrokeAccountedForInDimensions()?pp:(this.strokeUniform?new X().scalarAdd(this.canvas?this.canvas.getZoom():1):new X(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);s=r.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,s,i)}drawControlsConnectingLines(t,e){let i=!1;t.beginPath(),this.forEachControl(((s,r)=>{s.withConnection&&s.getVisibility(this,r)&&(i=!0,t.moveTo(s.x*e.x,s.y*e.y),t.lineTo(s.x*e.x+s.offsetX,s.y*e.y+s.offsetY))})),i&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const i=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:r,cornerColor:o}=this,c=F({cornerStrokeColor:s,cornerDashArray:r,cornerColor:o},e);t.setTransform(i,0,0,i,0,0),t.strokeStyle=t.fillStyle=c.cornerColor,this.transparentCorners||(t.strokeStyle=c.cornerStrokeColor),this._setLineDash(t,c.cornerDashArray),this.forEachControl(((h,f)=>{if(h.getVisibility(this,f)){const g=this.oCoords[f];h.render(t,g.x,g.y,c,this)}})),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach((e=>{let[i,s]=e;return this.setControlVisible(i,s)}))}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e);const s=this.width+4,r=this.height+4;return e.clearRect(-s/2,-r/2,s,r),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function GS(u,t){return t.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((i=>{i!=="constructor"&&Object.defineProperty(u.prototype,i,Object.getOwnPropertyDescriptor(e.prototype,i)||Object.create(null))}))})),u}B(Sl,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Je extends Sl{}GS(Je,[OS]),ct.setClass(Je),ct.setClass(Je,"object");const LE=(u,t,e,i)=>{const s=2*(i=Math.round(i))+1,{data:r}=u.getImageData(t-i,e-i,s,s);for(let o=3;o<r.length;o+=4)if(r[o]>0)return!1;return!0};class VS{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new X(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new X(1/this.options.scaleX,1/this.options.scaleY):new X(1,1)}createSideVector(t,e){const i=Lg(t,e);return this.options.strokeUniform?i.multiply(this.scale):i}projectOrthogonally(t,e,i){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,i)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new X(t);return e.y+=e.x*Math.tan(Ae(this.options.skewY)),e.x+=e.y*Math.tan(Ae(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const PE=new X;class Na extends VS{static getOrthogonalRotationFactor(t,e){const i=e?Bg(t,e):iE(t);return Math.abs(i)<Rl?-1:1}constructor(t,e,i,s){super(s),B(this,"AB",void 0),B(this,"AC",void 0),B(this,"alpha",void 0),B(this,"bisector",void 0),this.A=new X(t),this.B=new X(e),this.C=new X(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Bg(this.AB,this.AC),this.bisector=Sp(NS(this.AB.eq(PE)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(t,e),r=FS(s),o=Na.getOrthogonalRotationFactor(r,this.bisector);return this.scaleUnitVector(r,i*o)}projectBevel(){const t=[];return(this.alpha%Vh==0?[this.B]:[this.B,this.C]).forEach((e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))})),t}projectMiter(){const t=[],e=Math.abs(this.alpha),i=1/Math.sin(e/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),r=this.options.strokeUniform?Pg(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Pg(s)/this.strokeProjectionMagnitude<=r&&t.push(this.applySkew(this.A.add(s))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const i=[],s=new X(Na.getOrthogonalRotationFactor(this.bisector),Na.getOrthogonalRotationFactor(new X(this.bisector.y,this.bisector.x)));return[new X(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new X(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach((r=>{Fb(r,t,e)&&i.push(this.A.add(r))})),i}projectRoundWithSkew(t,e){const i=[],{skewX:s,skewY:r,scaleX:o,scaleY:c,strokeUniform:h}=this.options,f=new X(Math.tan(Ae(s)),Math.tan(Ae(r))),g=this.strokeProjectionMagnitude,p=h?g/c/Math.sqrt(1/c**2+1/o**2*f.y**2):g/Math.sqrt(1+f.y**2),v=new X(Math.sqrt(Math.max(g**2-p**2,0)),p),b=h?g/Math.sqrt(1+f.x**2*(1/c)**2/(1/o+1/o*f.x*f.y)**2):g/Math.sqrt(1+f.x**2/(1+f.x*f.y)**2),S=new X(b,Math.sqrt(Math.max(g**2-b**2,0)));return[S,S.scalarMultiply(-1),v,v.scalarMultiply(-1)].map((_=>this.applySkew(h?_.multiply(this.strokeUniformScalar):_))).forEach((_=>{Fb(_,t,e)&&i.push(this.applySkew(this.A).add(_))})),i}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%Vh==0,i=this.applySkew(this.A),s=t[e?0:2].subtract(i),r=t[e?1:0].subtract(i),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=hl(s,o)>0,h=c?s:r,f=c?r:s;return this.isSkewed()?t.push(...this.projectRoundWithSkew(h,f)):t.push(...this.projectRoundNoSkew(h,f)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector})))}}class Gb extends VS{constructor(t,e,i){super(i),this.A=new X(t),this.T=new X(e)}calcOrthogonalProjection(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(t,e);return this.scaleUnitVector(FS(s),i)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new X(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new Na(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new X(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(Sp(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(i);t.push(s.add(e),s.subtract(e))}return t.map((e=>this.applySkew(e)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((t=>({originPoint:this.A,projectedPoint:t})))}}const BE=function(u,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const i=[];if(u.length===0)return i;const s=u.reduce(((r,o)=>(r[r.length-1].eq(o)||r.push(new X(o)),r)),[new X(u[0])]);if(s.length===1)e=!0;else if(!e){const r=s[0],o=((c,h)=>{for(let f=c.length-1;f>=0;f--)if(h(c[f],f,c))return f;return-1})(s,(c=>!c.eq(r)));s.splice(o+1)}return s.forEach(((r,o,c)=>{let h,f;o===0?(f=c[1],h=e?r:c[c.length-1]):o===c.length-1?(h=c[o-1],f=e?r:c[0]):(h=c[o-1],f=c[o+1]),e&&c.length===1?i.push(...new Gb(r,r,t).project()):!e||o!==0&&o!==c.length-1?i.push(...new Na(r,h,f,t).project()):i.push(...new Gb(r,o===0?f:h,t).project())})),i},Cp=u=>{const t={};return Object.keys(u).forEach((e=>{t[e]={},Object.keys(u[e]).forEach((i=>{t[e][i]=F({},u[e][i])}))})),t},NE=u=>u.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Jo;const Ap=u=>{if(Jo||Jo||(Jo="Intl"in gu()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Jo){const t=Jo.segment(u);return Array.from(t).map((e=>{let{segment:i}=e;return i}))}return FE(u)},FE=u=>{const t=[];for(let e,i=0;i<u.length;i++)(e=jE(u,i))!==!1&&t.push(e);return t},jE=(u,t)=>{const e=u.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return u.charAt(t);if(55296<=e&&e<=56319){if(u.length<=t+1)throw"High surrogate without following low surrogate";const s=u.charCodeAt(t+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return u.charAt(t)+u.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const i=u.charCodeAt(t-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1},Tp=function(u,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.fill!==t.fill||u.stroke!==t.stroke||u.strokeWidth!==t.strokeWidth||u.fontSize!==t.fontSize||u.fontFamily!==t.fontFamily||u.fontWeight!==t.fontWeight||u.fontStyle!==t.fontStyle||u.textDecorationThickness!==t.textDecorationThickness||u.textBackgroundColor!==t.textBackgroundColor||u.deltaY!==t.deltaY||e&&(u.overline!==t.overline||u.underline!==t.underline||u.linethrough!==t.linethrough)},zE=(u,t)=>{const e=t.split(`
`),i=[];let s=-1,r={};u=Cp(u);for(let o=0;o<e.length;o++){const c=Ap(e[o]);if(u[o])for(let h=0;h<c.length;h++){s++;const f=u[o][h];f&&Object.keys(f).length>0&&(Tp(r,f,!0)?i.push({start:s,end:s+1,style:f}):i[i.length-1].end++),r=f||{}}else s+=c.length,r={}}return i},IE=(u,t)=>{if(!Array.isArray(u))return Cp(u);const e=t.split(fp),i={};let s=-1,r=0;for(let o=0;o<e.length;o++){const c=Ap(e[o]);for(let h=0;h<c.length;h++)s++,u[r]&&u[r].start<=s&&s<u[r].end&&(i[o]=i[o]||{},i[o][h]=F({},u[r].style),s===u[r].end-1&&r++)}return i},Wn=["display","transform",Le,"fill-opacity","fill-rule","opacity",_i,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Vb(u,t){const e=u.nodeName,i=u.getAttribute("class"),s=u.getAttribute("id"),r="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),s&&t.length&&(o=new RegExp("#"+s+r,"i"),t=t.replace(o,"")),i&&t.length){const c=i.split(" ");for(let h=c.length;h--;)o=new RegExp("\\."+c[h]+r,"i"),t=t.replace(o,"")}return t.length===0}function HE(u,t){let e=!0;const i=Vb(u,t.pop());return i&&t.length&&(e=(function(s,r){let o,c=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&r.length;)c&&(o=r.pop()),c=Vb(s=s.parentElement,o);return r.length===0})(u,t)),i&&e&&t.length===0}const UE=u=>{var t;return(t=tE[u])!==null&&t!==void 0?t:u},GE=new RegExp("(".concat(us,")"),"gi"),VE=u=>Qh(u.replace(GE," $1 ").replace(/,/gi," "));var Xb,Yb,qb,Wb,Kb,$b,Qb;const ni="(".concat(us,")"),XE=String.raw(Xb||(Xb=Ls(["(skewX)(",")"],["(skewX)\\(","\\)"])),ni),YE=String.raw(Yb||(Yb=Ls(["(skewY)(",")"],["(skewY)\\(","\\)"])),ni),qE=String.raw(qb||(qb=Ls(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),ni,ni,ni),WE=String.raw(Wb||(Wb=Ls(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),ni,ni),KE=String.raw(Kb||(Kb=Ls(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),ni,ni),$E=String.raw($b||($b=Ls(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),ni,ni,ni,ni,ni,ni),Ep="(?:".concat($E,"|").concat(KE,"|").concat(qE,"|").concat(WE,"|").concat(XE,"|").concat(YE,")"),QE="(?:".concat(Ep,"*)"),ZE=String.raw(Qb||(Qb=Ls(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),QE),JE=new RegExp(ZE),t2=new RegExp(Ep),e2=new RegExp(Ep,"g");function Ng(u){const t=[];if(!(u=VE(u).replace(/\s*([()])\s*/gi,"$1"))||u&&!JE.test(u))return[...ai];for(const e of u.matchAll(e2)){const i=t2.exec(e[0]);if(!i)continue;let s=ai;const r=i.filter((S=>!!S)),[,o,...c]=r,[h,f,g,p,v,b]=c.map((S=>parseFloat(S)));switch(o){case"translate":s=Ll(h,f);break;case gp:s=qa({angle:h},{x:f,y:g});break;case mu:s=yp(h,f);break;case Xa:s=bS(h);break;case Ya:s=_S(h);break;case"matrix":s=[h,f,g,p,v,b]}t.push(s)}return mp(t)}function i2(u,t,e,i){const s=Array.isArray(t);let r,o=t;if(u!==Le&&u!==_i||t!==bi){if(u==="strokeUniform")return t==="non-scaling-stroke";if(u==="strokeDashArray")o=t===bi?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(u==="transformMatrix")o=e&&e.transformMatrix?Ke(e.transformMatrix,Ng(t)):Ng(t);else if(u==="visible")o=t!==bi&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(u==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(u==="textAnchor")o=t==="start"?Qt:t==="end"?Ce:Ft;else if(u==="charSpacing"||u===Mr)r=Ba(t,i)/i*1e3;else if(u==="paintFirst"){const c=t.indexOf(Le),h=t.indexOf(_i);o=Le,(c>-1&&h>-1&&h<c||c===-1&&h>-1)&&(o=_i)}else{if(u==="href"||u==="xlink:href"||u==="font"||u==="id")return t;if(u==="imageSmoothing")return t==="optimizeQuality";r=s?t.map(Ba):Ba(t,i)}}else o="";return!s&&isNaN(r)?o:r}function s2(u,t){const e=u.match(JT);if(!e)return;const i=e[1],s=e[3],r=e[4],o=e[5],c=e[6];i&&(t.fontStyle=i),s&&(t.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),r&&(t.fontSize=Ba(r)),c&&(t.fontFamily=c),o&&(t.lineHeight=o==="normal"?1:o)}function n2(u,t){u.replace(/;\s*$/,"").split(";").forEach((e=>{if(!e)return;const[i,s]=e.split(":");t[i.trim().toLowerCase()]=s.trim()}))}function r2(u){const t={},e=u.getAttribute("style");return e&&(typeof e=="string"?n2(e,t):(function(i,s){Object.entries(i).forEach((r=>{let[o,c]=r;c!==void 0&&(s[o.toLowerCase()]=c)}))})(e,t)),t}const a2={stroke:"strokeOpacity",fill:"fillOpacity"};function fn(u,t,e){if(!u)return{};let i,s={},r=dp;u.parentNode&&Nb.test(u.parentNode.nodeName)&&(s=fn(u.parentElement,t,e),s.fontSize&&(i=r=Ba(s.fontSize)));const o=F(F(F({},t.reduce(((f,g)=>{const p=u.getAttribute(g);return p&&(f[g]=p),f}),{})),(function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(const v in g)HE(f,v.split(" "))&&(p=F(F({},p),g[v]));return p})(u,e)),r2(u));o[lg]&&u.setAttribute(lg,o[lg]),o[og]&&(i=Ba(o[og],r),o[og]="".concat(i));const c={};for(const f in o){const g=UE(f),p=i2(g,o[f],s,i);c[g]=p}c&&c.font&&s2(c.font,c);const h=F(F({},s),c);return Nb.test(u.nodeName)?h:(function(f){const g=Je.getDefaults();return Object.entries(a2).forEach((p=>{let[v,b]=p;if(f[b]===void 0||f[v]==="")return;if(f[v]===void 0){if(!g[v])return;f[v]=g[v]}if(f[v].indexOf("url(")===0)return;const S=new $t(f[v]);f[v]=S.setAlpha(oe(S.getAlpha()*f[b],2)).toRgba()})),f})(h)}const o2=["left","top","width","height","visible"],XS=["rx","ry"];class Ts extends Je{static getDefaults(){return F(F({},super.getDefaults()),Ts.ownDefaults)}constructor(t){super(),Object.assign(this,Ts.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:i}=this,s=-e/2,r=-i/2,o=this.rx?Math.min(this.rx,e/2):0,c=this.ry?Math.min(this.ry,i/2):0,h=o!==0||c!==0;t.beginPath(),t.moveTo(s+o,r),t.lineTo(s+e-o,r),h&&t.bezierCurveTo(s+e-In*o,r,s+e,r+In*c,s+e,r+c),t.lineTo(s+e,r+i-c),h&&t.bezierCurveTo(s+e,r+i-In*c,s+e-In*o,r+i,s+e-o,r+i),t.lineTo(s+o,r+i),h&&t.bezierCurveTo(s+In*o,r+i,s,r+i-In*c,s,r+i-c),t.lineTo(s,r+c),h&&t.bezierCurveTo(s,r+In*c,s+In*o,r,s+o,r),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...XS,...t])}_toSVG(){const{width:t,height:e,rx:i,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-t/2,'" y="').concat(-e/2,'" rx="').concat(i,'" ry="').concat(s,'" width="').concat(t,'" height="').concat(e,`" />
`)]}static async fromElement(t,e,i){const s=fn(t,this.ATTRIBUTE_NAMES,i),{left:r=0,top:o=0,width:c=0,height:h=0,visible:f=!0}=s,g=he(s,o2);return new this(F(F(F({},e),g),{},{left:r,top:o,width:c,height:h,visible:!!(f&&c&&h)}))}}B(Ts,"type","Rect"),B(Ts,"cacheProperties",[...dn,...XS]),B(Ts,"ownDefaults",{rx:0,ry:0}),B(Ts,"ATTRIBUTE_NAMES",[...Wn,"x","y","rx","ry","width","height"]),ct.setClass(Ts),ct.setSVGClass(Ts);const nn="initialization",Jh="added",Dp="removed",tu="imperative",YS=(u,t)=>{const{strokeUniform:e,strokeWidth:i,width:s,height:r,group:o}=t,c=o&&o!==u?bu(o.calcTransformMatrix(),u.calcTransformMatrix()):null,h=c?t.getRelativeCenterPoint().transform(c):t.getRelativeCenterPoint(),f=!t.isStrokeAccountedForInDimensions(),g=e&&f?YT(new X(i,i),void 0,u.calcTransformMatrix()):pp,p=!e&&f?i:0,v=bp(s+p,r+p,mp([c,t.calcOwnMatrix()],!0)).add(g).scalarDivide(2);return[h.subtract(v),h.add(v)]};class xu{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:i,strategy:s}=t;return e===nn||e===tu||!!i&&s!==i}shouldLayoutClipPath(t){let{type:e,target:{clipPath:i}}=t;return e!==nn&&i&&!i.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:i,target:s}=e;if(i===tu&&e.overrides)return e.overrides;if(t.length===0)return;const{left:r,top:o,width:c,height:h}=rn(t.map((p=>YS(s,p))).reduce(((p,v)=>p.concat(v)),[])),f=new X(c,h),g=new X(r,o).add(f.scalarDivide(2));if(i===nn){const p=this.getInitialSize(e,{size:f,center:g});return{center:g,relativeCorrection:new X(0,0),size:p}}return{center:g.transform(s.calcOwnMatrix()),size:f}}}B(xu,"type","strategy");class Fg extends xu{shouldPerformLayout(t){return!0}}B(Fg,"type","fit-content"),ct.setClass(Fg);const l2=["strategy"],c2=["target","strategy","bubbles","prevStrategy"],qS="layoutManager";class xl{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Fg;B(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e=F(F({bubbles:!0,strategy:this.strategy},t),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(e);const i=this.getLayoutResult(e);i&&this.commitLayout(e,i),this.onAfterLayout(e,i),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:i}=e;return[Yh,hS,yl,uS,pu,dS,Xh,kT,RT].map((s=>t.on(s,(r=>this.performLayout(s===Yh?{type:"object_modified",trigger:s,e:r,target:i}:{type:"object_modifying",trigger:s,e:r,target:i})))))}subscribe(t,e){this.unsubscribe(t,e);const i=this.attachHandlers(t,e);this._subscriptions.set(t,i)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach((i=>i())),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach((e=>this.unsubscribe(e,t)))}subscribeTargets(t){t.targets.forEach((e=>this.subscribe(e,t)))}onBeforeLayout(t){const{target:e,type:i}=t,{canvas:s}=e;if(i===nn||i===Jh?this.subscribeTargets(t):i===Dp&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),s&&s.fire("object:layout:before",{target:e,context:t}),i===tu&&t.deep){const r=he(t,l2);e.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout(F(F({},r),{},{bubbles:!1,target:o}))))}}getLayoutResult(t){const{target:e,strategy:i,type:s}=t,r=i.calcLayoutResult(t,e.getObjects());if(!r)return;const o=s===nn?new X:e.getRelativeCenterPoint(),{center:c,correction:h=new X,relativeCorrection:f=new X}=r,g=o.subtract(c).add(h).transform(s===nn?ai:hs(e.calcOwnMatrix()),!0).add(f);return{result:r,prevCenter:o,nextCenter:c,offset:g}}commitLayout(t,e){const{target:i}=t,{result:{size:s},nextCenter:r}=e;var o,c;i.set({width:s.x,height:s.y}),this.layoutObjects(t,e),t.type===nn?i.set({left:(o=t.x)!==null&&o!==void 0?o:r.x+s.x*ke(i.originX),top:(c=t.y)!==null&&c!==void 0?c:r.y+s.y*ke(i.originY)}):(i.setPositionByOrigin(r,Ft,Ft),i.setCoords(),i.set("dirty",!0))}layoutObjects(t,e){const{target:i}=t;i.forEachObject((s=>{s.group===i&&this.layoutObject(t,e,s)})),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,i.clipPath)}layoutObject(t,e,i){let{offset:s}=e;i.set({left:i.left+s.x,top:i.top+s.y})}onAfterLayout(t,e){const{target:i,strategy:s,bubbles:r,prevStrategy:o}=t,c=he(t,c2),{canvas:h}=i;i.fire("layout:after",{context:t,result:e}),h&&h.fire("object:layout:after",{context:t,result:e,target:i});const f=i.parent;r&&f!=null&&f.layoutManager&&((c.path||(c.path=[])).push(i),f.layoutManager.performLayout(F(F({},c),{},{target:f}))),i.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach((e=>e.forEach((i=>i())))),t.clear()}toObject(){return{type:qS,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ct.setClass(xl,qS);const h2=["type","objects","layoutManager"];class u2 extends xl{performLayout(){}}class Ar extends fS(Je){static getDefaults(){return F(F({},super.getDefaults()),Ar.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),B(this,"_activeObjects",[]),B(this,"__objectSelectionTracker",void 0),B(this,"__objectSelectionDisposer",void 0),Object.assign(this,Ar.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var i;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((s=>{this.enterGroup(s,!1)})),this.layoutManager=(i=e.layoutManager)!==null&&i!==void 0?i:new xl,this.layoutManager.performLayout({type:nn,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(Yn("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(Yn("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter(((e,i,s)=>this.canEnterGroup(e)&&s.indexOf(e)===i))}add(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const s=this._filterObjectsBeforeEnteringGroup(e),r=super.add(...s);return this._onAfterObjectsChange(Jh,s),r}insertAt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];const r=this._filterObjectsBeforeEnteringGroup(i),o=super.insertAt(t,...r);return this._onAfterObjectsChange(Jh,r),o}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(Dp,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const i=this[t];return super._set(t,e),t==="canvas"&&i!==e&&(this._objects||[]).forEach((s=>{s._set(t,e)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:i}=e;const s=this._activeObjects;if(t)s.push(i),this._set("dirty",!0);else if(s.length>0){const r=s.indexOf(i);r>-1&&(s.splice(r,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&Kh(t,Ke(hs(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===t||t.isDescendantOf(i))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(Kh(t,Ke(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const i=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;i>-1&&this._activeObjects.splice(i,1)}shouldCache(){const t=Je.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,i){this._renderBackground(t);for(let r=0;r<this._objects.length;r++){var s;const o=this._objects[r];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...hs(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,i)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((t=>t.setCoords()))}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(F({target:this,type:tu},t))}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const i=this.includeDefaultValues;return this._objects.filter((function(s){return!s.excludeFromExport})).map((function(s){const r=s.includeDefaultValues;s.includeDefaultValues=i;const o=s[t||"toObject"](e);return s.includeDefaultValues=r,o}))}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return F(F(F({},super.toObject(["subTargetCheck","interactive",...t])),e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{}),{},{objects:this.__serializeObjects("toObject",t)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((t=>{this._watchObject(!1,t),t.dispose()})),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=Ts.prototype._toSVG.call(this),i=e.indexOf("COMMON_PARTS");e[i]='for="group" ';const s=e.join("");return t?t(s):s}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(t);i&&e.push("		",i);for(let s=0;s<this._objects.length;s++)e.push("		",this._objects[s].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],i=this._createSVGBgRect(t);i&&e.push("	",i);for(let s=0;s<this._objects.length;s++)e.push("	",this._objects[s].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:i,objects:s=[],layoutManager:r}=t,o=he(t,h2);return Promise.all([vl(s,e),vu(o,e)]).then((c=>{let[h,f]=c;const g=new this(h,F(F(F({},o),f),{},{layoutManager:new u2}));if(r){const p=ct.getClass(r.type),v=ct.getClass(r.strategy);g.layoutManager=new p(new v)}else g.layoutManager=new xl;return g.layoutManager.subscribeTargets({type:nn,target:g,targets:g.getObjects()}),g.setCoords(),g}))}}B(Ar,"type","Group"),B(Ar,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ct.setClass(Ar);const d2=(u,t)=>Math.min(t.width/u.width,t.height/u.height),f2=(u,t)=>Math.max(t.width/u.width,t.height/u.height),jg="\\s*,?\\s*",tl="".concat(jg,"(").concat(us,")"),g2="".concat(tl).concat(tl).concat(tl).concat(jg,"([01])").concat(jg,"([01])").concat(tl).concat(tl),p2={m:"l",M:"L"},m2=(u,t,e,i,s,r,o,c,h,f,g)=>{const p=ln(u),v=cn(u),b=ln(t),S=cn(t),_=e*s*b-i*r*S+o,C=i*s*b+e*r*S+c;return["C",f+h*(-e*s*v-i*r*p),g+h*(-i*s*v+e*r*p),_+h*(e*s*S+i*r*b),C+h*(i*s*S-e*r*b),_,C]},Zb=(u,t,e,i)=>{const s=Math.atan2(t,u),r=Math.atan2(i,e);return r>=s?r-s:2*Math.PI-(s-r)};function Jb(u,t,e,i,s,r,o,c){let h;if(Xt.cachesBoundsOfCurve&&(h=[...arguments].join(),ol.boundsOfCurveCache[h]))return ol.boundsOfCurveCache[h];const f=Math.sqrt,g=Math.abs,p=[],v=[[0,0],[0,0]];let b=6*u-12*e+6*s,S=-3*u+9*e-9*s+3*o,_=3*e-3*u;for(let D=0;D<2;++D){if(D>0&&(b=6*t-12*i+6*r,S=-3*t+9*i-9*r+3*c,_=3*i-3*t),g(S)<1e-12){if(g(b)<1e-12)continue;const G=-_/b;0<G&&G<1&&p.push(G);continue}const M=b*b-4*_*S;if(M<0)continue;const O=f(M),R=(-b+O)/(2*S);0<R&&R<1&&p.push(R);const j=(-b-O)/(2*S);0<j&&j<1&&p.push(j)}let C=p.length;const w=C,T=WS(u,t,e,i,s,r,o,c);for(;C--;){const{x:D,y:M}=T(p[C]);v[0][C]=D,v[1][C]=M}v[0][w]=u,v[1][w]=t,v[0][w+1]=o,v[1][w+1]=c;const E=[new X(Math.min(...v[0]),Math.min(...v[1])),new X(Math.max(...v[0]),Math.max(...v[1]))];return Xt.cachesBoundsOfCurve&&(ol.boundsOfCurveCache[h]=E),E}const y2=(u,t,e)=>{let[i,s,r,o,c,h,f,g]=e;const p=((v,b,S,_,C,w,T)=>{if(S===0||_===0)return[];let E=0,D=0,M=0;const O=Math.PI,R=T*up,j=cn(R),G=ln(R),Q=.5*(-G*v-j*b),J=.5*(-G*b+j*v),st=S**2,rt=_**2,it=J**2,lt=Q**2,L=st*rt-st*it-rt*lt;let I=Math.abs(S),K=Math.abs(_);if(L<0){const Pt=Math.sqrt(1-L/(st*rt));I*=Pt,K*=Pt}else M=(C===w?-1:1)*Math.sqrt(L/(st*it+rt*lt));const dt=M*I*J/K,_t=-M*K*Q/I,P=G*dt-j*_t+.5*v,Y=j*dt+G*_t+.5*b;let et=Zb(1,0,(Q-dt)/I,(J-_t)/K),nt=Zb((Q-dt)/I,(J-_t)/K,(-Q-dt)/I,(-J-_t)/K);w===0&&nt>0?nt-=2*O:w===1&&nt<0&&(nt+=2*O);const ft=Math.ceil(Math.abs(nt/O*2)),gt=[],pt=nt/ft,Wt=8/3*Math.sin(pt/4)*Math.sin(pt/4)/Math.sin(pt/2);let Mt=et+pt;for(let Pt=0;Pt<ft;Pt++)gt[Pt]=m2(et,Mt,G,j,I,K,P,Y,Wt,E,D),E=gt[Pt][5],D=gt[Pt][6],et=Mt,Mt+=pt;return gt})(f-u,g-t,s,r,c,h,o);for(let v=0,b=p.length;v<b;v++)p[v][1]+=u,p[v][2]+=t,p[v][3]+=u,p[v][4]+=t,p[v][5]+=u,p[v][6]+=t;return p},v2=u=>{let t=0,e=0,i=0,s=0;const r=[];let o,c=0,h=0;for(const f of u){const g=[...f];let p;switch(g[0]){case"l":g[1]+=t,g[2]+=e;case"L":t=g[1],e=g[2],p=["L",t,e];break;case"h":g[1]+=t;case"H":t=g[1],p=["L",t,e];break;case"v":g[1]+=e;case"V":e=g[1],p=["L",t,e];break;case"m":g[1]+=t,g[2]+=e;case"M":t=g[1],e=g[2],i=g[1],s=g[2],p=["M",t,e];break;case"c":g[1]+=t,g[2]+=e,g[3]+=t,g[4]+=e,g[5]+=t,g[6]+=e;case"C":c=g[3],h=g[4],t=g[5],e=g[6],p=["C",g[1],g[2],c,h,t,e];break;case"s":g[1]+=t,g[2]+=e,g[3]+=t,g[4]+=e;case"S":o==="C"?(c=2*t-c,h=2*e-h):(c=t,h=e),t=g[3],e=g[4],p=["C",c,h,g[1],g[2],t,e],c=p[3],h=p[4];break;case"q":g[1]+=t,g[2]+=e,g[3]+=t,g[4]+=e;case"Q":c=g[1],h=g[2],t=g[3],e=g[4],p=["Q",c,h,t,e];break;case"t":g[1]+=t,g[2]+=e;case"T":o==="Q"?(c=2*t-c,h=2*e-h):(c=t,h=e),t=g[1],e=g[2],p=["Q",c,h,t,e];break;case"a":g[6]+=t,g[7]+=e;case"A":y2(t,e,g).forEach((v=>r.push(v))),t=g[6],e=g[7];break;case"z":case"Z":t=i,e=s,p=["Z"]}p?(r.push(p),o=p[0]):o=""}return r},eu=(u,t,e,i)=>Math.sqrt((e-u)**2+(i-t)**2),WS=(u,t,e,i,s,r,o,c)=>h=>{const f=h**3,g=(b=>3*b**2*(1-b))(h),p=(b=>3*b*(1-b)**2)(h),v=(b=>(1-b)**3)(h);return new X(o*f+s*g+e*p+u*v,c*f+r*g+i*p+t*v)},KS=u=>u**2,$S=u=>2*u*(1-u),QS=u=>(1-u)**2,b2=(u,t,e,i,s,r,o,c)=>h=>{const f=KS(h),g=$S(h),p=QS(h),v=3*(p*(e-u)+g*(s-e)+f*(o-s)),b=3*(p*(i-t)+g*(r-i)+f*(c-r));return Math.atan2(b,v)},_2=(u,t,e,i,s,r)=>o=>{const c=KS(o),h=$S(o),f=QS(o);return new X(s*c+e*h+u*f,r*c+i*h+t*f)},S2=(u,t,e,i,s,r)=>o=>{const c=1-o,h=2*(c*(e-u)+o*(s-e)),f=2*(c*(i-t)+o*(r-i));return Math.atan2(f,h)},t_=(u,t,e)=>{let i=new X(t,e),s=0;for(let r=1;r<=100;r+=1){const o=u(r/100);s+=eu(i.x,i.y,o.x,o.y),i=o}return s},x2=(u,t)=>{let e,i=0,s=0,r={x:u.x,y:u.y},o=F({},r),c=.01,h=0;const f=u.iterator,g=u.angleFinder;for(;s<t&&c>1e-4;)o=f(i),h=i,e=eu(r.x,r.y,o.x,o.y),e+s>t?(i-=c,c/=2):(r=o,i+=c,s+=e);return F(F({},o),{},{angle:g(h)})},ZS=u=>{let t,e,i=0,s=0,r=0,o=0,c=0;const h=[];for(const f of u){const g={x:s,y:r,command:f[0],length:0};switch(f[0]){case"M":e=g,e.x=o=s=f[1],e.y=c=r=f[2];break;case"L":e=g,e.length=eu(s,r,f[1],f[2]),s=f[1],r=f[2];break;case"C":t=WS(s,r,f[1],f[2],f[3],f[4],f[5],f[6]),e=g,e.iterator=t,e.angleFinder=b2(s,r,f[1],f[2],f[3],f[4],f[5],f[6]),e.length=t_(t,s,r),s=f[5],r=f[6];break;case"Q":t=_2(s,r,f[1],f[2],f[3],f[4]),e=g,e.iterator=t,e.angleFinder=S2(s,r,f[1],f[2],f[3],f[4]),e.length=t_(t,s,r),s=f[3],r=f[4];break;case"Z":e=g,e.destX=o,e.destY=c,e.length=eu(s,r,o,c),s=o,r=c}i+=e.length,h.push(e)}return h.push({length:i,x:s,y:r}),h},w2=function(u,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ZS(u),i=0;for(;t-e[i].length>0&&i<e.length-2;)t-=e[i].length,i++;const s=e[i],r=t/s.length,o=u[i];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return F(F({},new X(s.x,s.y).lerp(new X(s.destX,s.destY),r)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return F(F({},new X(s.x,s.y).lerp(new X(o[1],o[2]),r)),{},{angle:Math.atan2(o[2]-s.y,o[1]-s.x)});case"C":case"Q":return x2(s,t)}},C2=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),e_=new RegExp(g2,"g"),A2=new RegExp(us,"gi"),T2={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},E2=u=>{var t;const e=[],i=(t=u.match(C2))!==null&&t!==void 0?t:[];for(const s of i){const r=s[0];if(r==="z"||r==="Z"){e.push([r]);continue}const o=T2[r.toLowerCase()];let c=[];if(r==="a"||r==="A"){e_.lastIndex=0;for(let h=null;h=e_.exec(s);)c.push(...h.slice(1))}else c=s.match(A2)||[];for(let h=0;h<c.length;h+=o){const f=new Array(o),g=p2[r];f[0]=h>0&&g?g:r;for(let p=0;p<o;p++)f[p+1]=parseFloat(c[h+p]);e.push(f)}}return e},D2=function(u){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new X(u[0]),i=new X(u[1]),s=1,r=0;const o=[],c=u.length,h=c>2;let f;for(h&&(s=u[2].x<i.x?-1:u[2].x===i.x?0:1,r=u[2].y<i.y?-1:u[2].y===i.y?0:1),o.push(["M",e.x-s*t,e.y-r*t]),f=1;f<c;f++){if(!e.eq(i)){const g=e.midPointFrom(i);o.push(["Q",e.x,e.y,g.x,g.y])}e=u[f],f+1<u.length&&(i=u[f+1])}return h&&(s=e.x>u[f-2].x?1:e.x===u[f-2].x?0:-1,r=e.y>u[f-2].y?1:e.y===u[f-2].y?0:-1),o.push(["L",e.x+s*t,e.y+r*t]),o},JS=(u,t)=>u.map((e=>e.map(((i,s)=>s===0||t===void 0?i:oe(i,t))).join(" "))).join(" ");function zg(u,t){const e=u.style;e&&t&&(typeof t=="string"?e.cssText+=";"+t:Object.entries(t).forEach((i=>{let[s,r]=i;return e.setProperty(s,r)})))}class M2 extends CS{constructor(t){let{allowTouchScrolling:e=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),B(this,"upper",void 0),B(this,"container",void 0);const{el:s}=this.lower,r=this.createUpperCanvas();this.upper={el:r,ctx:r.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:e}),this.applyCanvasStyle(r,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(i),s.parentNode&&s.parentNode.replaceChild(o,s),o.append(s,r),this.container=o}createUpperCanvas(){const{el:t}=this.lower,e=hn();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=Va().createElement("div");return t.setAttribute("data-fabric","wrapper"),zg(t,{position:"relative"}),Tb(t),t}applyCanvasStyle(t,e){const{styles:i,allowTouchScrolling:s}=e;zg(t,F(F({},i),{},{"touch-action":s?"manipulation":bi})),Tb(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:i,ctx:s}=this.upper;wS(i,s,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),kg(this.upper.el,t),kg(this.container,t)}cleanupDOM(t){const e=this.container,{el:i}=this.lower,{el:s}=this.upper;super.cleanupDOM(t),e.removeChild(s),e.removeChild(i),e.parentNode&&e.parentNode.replaceChild(i,e)}dispose(){super.dispose(),Rs().dispose(this.upper.el),delete this.upper,delete this.container}}class wu extends Pl{constructor(){super(...arguments),B(this,"targets",[]),B(this,"_hoveredTargets",[]),B(this,"_currentTransform",null),B(this,"_groupSelector",null),B(this,"contextTopDirty",!1)}static getDefaults(){return F(F({},super.getDefaults()),wu.ownDefaults)}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new M2(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter((e=>!e.group&&e!==t)).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),i=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,i){const s=this.targetFindTolerance,r=this.pixelFindContext;this.clearContext(r),r.save(),r.translate(-e+s,-i+s),r.transform(...this.viewportTransform);const o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(r),t.selectionBackgroundColor=o,r.restore();const c=Math.round(s*this.getRetinaScaling());return LE(r,c,c,c)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find((i=>!!i&&t[i]===!0)):t[e])}_shouldClearSelection(t,e){const i=this.getActiveObjects(),s=this._activeObject;return!!(!e||e&&s&&i.length>1&&i.indexOf(e)===-1&&s!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&s&&s!==e)}_shouldCenterTransform(t,e,i){if(!t)return;let s;return e===mu||e===Si||e===Zi||e===yl?s=this.centeredScaling||t.centeredScaling:e===gp&&(s=this.centeredRotation||t.centeredRotation),s?!i:i}_getOriginFromCorner(t,e){const i={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?i.x=Ce:["mr","tr","br"].includes(e)&&(i.x=Qt),["tl","mt","tr"].includes(e)?i.y=Og:["bl","mb","br"].includes(e)&&(i.y=vi)),i}_setupCurrentTransform(t,e,i){var s;const r=e.group?Pa(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:c}=e.getActiveControl()||{},h=i&&c?(s=c.getActionHandler(t,e,c))===null||s===void 0?void 0:s.bind(c):KT,f=((b,S,_,C)=>{if(!S||!b)return"drag";const w=C.controls[S];return w.getActionName(_,w,C)})(i,o,t,e),g=t[this.centeredKey],p=this._shouldCenterTransform(e,f,g)?{x:Ft,y:Ft}:this._getOriginFromCorner(e,o),v={target:e,action:f,actionHandler:h,actionPerformed:!1,corner:o,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:r.x-e.left,offsetY:r.y-e.top,originX:p.x,originY:p.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:Ae(e.angle),width:e.width,height:e.height,shiftKey:t.shiftKey,altKey:g,original:F(F({},AS(e)),{},{originX:p.x,originY:p.y})};this._currentTransform=v,this.fire("before:transform",{e:t,transform:v})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:i,deltaX:s,deltaY:r}=this._groupSelector,o=new X(e,i).transform(this.viewportTransform),c=new X(e+s,i+r).transform(this.viewportTransform),h=this.selectionLineWidth/2;let f=Math.min(o.x,c.x),g=Math.min(o.y,c.y),p=Math.max(o.x,c.x),v=Math.max(o.y,c.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(f,g,p-f,v-g)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,f+=h,g+=h,p-=h,v-=h,Je.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(f,g,p-f,v-g))}findTarget(t){if(this.skipTargetFind)return;const e=this.getViewportPoint(t),i=this._activeObject,s=this.getActiveObjects();if(this.targets=[],i&&s.length>=1){if(i.findControl(e,Rg(t))||s.length>1&&this.searchPossibleTargets([i],e))return i;if(i===this.searchPossibleTargets([i],e)){if(this.preserveObjectStacking){const r=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&o&&o!==i?(this.targets=r,i):o}return i}}return this.searchPossibleTargets(this._objects,e)}_pointIsInObjectSelectionArea(t,e){let i=t.getCoords();const s=this.getZoom(),r=t.padding/s;if(r){const[o,c,h,f]=i,g=Math.atan2(c.y-o.y,c.x-o.x),p=ln(g)*r,v=cn(g)*r,b=p+v,S=p-v;i=[new X(o.x-S,o.y-b),new X(c.x+b,c.y-S),new X(h.x+S,h.y+b),new X(f.x-b,f.y+S)]}return pe.isPointInPolygon(e,i)}_checkTarget(t,e){return!!(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,Pa(e,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing||!this.isTargetTransparent(t,e.x,e.y)))}_searchPossibleTargets(t,e){let i=t.length;for(;i--;){const s=t[i];if(this._checkTarget(s,e)){if(Nh(s)&&s.subTargetCheck){const r=this._searchPossibleTargets(s._objects,e);r&&this.targets.push(r)}return s}}}searchPossibleTargets(t,e){const i=this._searchPossibleTargets(t,e);if(i&&Nh(i)&&i.interactive&&this.targets[0]){const s=this.targets;for(let r=s.length-1;r>0;r--){const o=s[r];if(!Nh(o)||!o.interactive)return o}return s[0]}return i}getViewportPoint(t){return this._pointer?this._pointer:this.getPointer(t,!0)}getScenePoint(t){return this._absolutePointer?this._absolutePointer:this.getPointer(t)}getPointer(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,s=i.getBoundingClientRect();let r=UT(t),o=s.width||0,c=s.height||0;o&&c||(vi in s&&Og in s&&(c=Math.abs(s.top-s.bottom)),Ce in s&&Qt in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,e||(r=Pa(r,void 0,this.viewportTransform));const h=this.getRetinaScaling();h!==1&&(r.x/=h,r.y/=h);const f=o===0||c===0?new X(1,1):new X(i.width/o,i.height/c);return r.multiply(f)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=hn(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return mr(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let i=!1,s=!1;const r=this.getActiveObjects(),o=[],c=[];t.forEach((h=>{r.includes(h)||(i=!0,h.fire("deselected",{e,target:h}),c.push(h))})),r.forEach((h=>{t.includes(h)||(i=!0,h.fire("selected",{e,target:h}),o.push(h))})),t.length>0&&r.length>0?(s=!0,i&&this.fire("selection:updated",{e,selected:o,deselected:c})):r.length>0?(s=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(s=!0,this.fire("selection:cleared",{e,deselected:c})),s&&(this._objectsToRender=void 0)}setActiveObject(t,e){const i=this.getActiveObjects(),s=this._setActiveObject(t,e);return this._fireSelectionEvents(i,e),s}_setActiveObject(t,e){const i=this._activeObject;return i!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,mr(t)&&i!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const i=this._activeObject;return!!i&&!i.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(t),mr(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),i=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[i]});const s=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),s}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,i=e.target,s={e:t,target:i,transform:e,action:e.action};i._scaling&&(i._scaling=!1),i.setCoords(),e.actionPerformed&&(this.fire("object:modified",s),i.fire(Yh,s))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;mr(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,i){const s=this._realizeGroupTransformOnObject(t),r=super._toObject(t,e,i);return t.set(s),r}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&mr(e)&&this._activeObject===e){const i=Wa(t,["angle","flipX","flipY",Qt,Si,Zi,Xa,Ya,vi]);return VT(t,e.calcOwnMatrix()),i}return{}}_setSVGObject(t,e,i){const s=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,i),e.set(s)}}B(wu,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class O2{constructor(t){B(this,"targets",[]),B(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:s}=t.getActiveObject()||{};s&&s.focus()},i=t.upperCanvasEl;i.addEventListener("click",e),this.__disposer=()=>i.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach((t=>{t.isEditing&&t.exitEditing()}))}add(t){this.targets.push(t)}remove(t){this.unregister(t),wa(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const k2=["target","oldTarget","fireCanvas","e"],ki={passive:!1},_a=(u,t)=>{const e=u.getViewportPoint(t),i=u.getScenePoint(t);return{viewportPoint:e,scenePoint:i,pointer:e,absolutePointer:i}},Hn=function(u){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return u.addEventListener(...e)},Wi=function(u){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];return u.removeEventListener(...e)},R2={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Ig extends wu{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),B(this,"_isClick",void 0),B(this,"textEditingManager",new O2(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((e=>{this[e]=this[e].bind(this)})),this.addOrRemove(Hn,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t,e){const i=this.upperCanvasEl,s=this._getEventPrefix();t(xS(i),"resize",this._onResize),t(i,s+"down",this._onMouseDown),t(i,"".concat(s,"move"),this._onMouseMove,ki),t(i,"".concat(s,"out"),this._onMouseOut),t(i,"".concat(s,"enter"),this._onMouseEnter),t(i,"wheel",this._onMouseWheel,{passive:!1}),t(i,"contextmenu",this._onContextMenu),t(i,"click",this._onClick),t(i,"dblclick",this._onClick),t(i,"dragstart",this._onDragStart),t(i,"dragend",this._onDragEnd),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,ki)}removeListeners(){this.addOrRemove(Wi,"remove");const t=this._getEventPrefix(),e=cs(this.upperCanvasEl);Wi(e,"".concat(t,"up"),this._onMouseUp),Wi(e,"touchend",this._onTouchEnd,ki),Wi(e,"".concat(t,"move"),this._onMouseMove,ki),Wi(e,"touchmove",this._onMouseMove,ki),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this.__onMouseWheel(t)}_onMouseOut(t){const e=this._hoveredTarget,i=F({e:t},_a(this,t));this.fire("mouse:out",F(F({},i),{},{target:e})),this._hoveredTarget=void 0,e&&e.fire("mouseout",F({},i)),this._hoveredTargets.forEach((s=>{this.fire("mouse:out",F(F({},i),{},{target:s})),s&&s.fire("mouseout",F({},i))})),this._hoveredTargets=[]}_onMouseEnter(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",F({e:t},_a(this,t))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const i={e:t,target:e};return this.fire("dragstart",i),e.fire("dragstart",i),void Hn(this.upperCanvasEl,"drag",this._onDragProgress)}Eb(t)}_renderDragEffects(t,e,i){let s=!1;const r=this._dropTarget;r&&r!==e&&r!==i&&(r.clearContextTop(),s=!0),e?.clearContextTop(),i!==e&&i?.clearContextTop();const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),s=!0),i&&(o.save(),i.transform(o),i.renderDropTargetEffect(t),o.restore(),s=!0),o.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(t){const e=!!t.dataTransfer&&t.dataTransfer.dropEffect!==bi,i=e?this._activeObject:void 0,s={e:t,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:e,dropTarget:i};Wi(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}findDragTargets(t){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(t)),targets:[...this.targets]}}_onDragOver(t){const e="dragover",{target:i,targets:s}=this.findDragTargets(t),r=this._dragSource,o={e:t,target:i,subTargets:s,dragSource:r,canDrop:!1,dropTarget:void 0};let c;this.fire(e,o),this._fireEnterLeaveEvents(i,o),i&&(i.canDrop(t)&&(c=i),i.fire(e,o));for(let h=0;h<s.length;h++){const f=s[h];f.canDrop(t)&&(c=f),f.fire(e,o)}this._renderDragEffects(t,r,c),this._dropTarget=c}_onDragEnter(t){const{target:e,targets:i}=this.findDragTargets(t),s={e:t,target:e,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(e,s)}_onDragLeave(t){const e={e:t,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",e),this._fireEnterLeaveEvents(void 0,e),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(t){const{target:e,targets:i}=this.findDragTargets(t),s=this._basicEventHandler("drop:before",F({e:t,target:e,subTargets:i,dragSource:this._dragSource},_a(this,t)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(t){const e=this.findTarget(t),i=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:i});return this.stopContextMenu&&Eb(t),this._basicEventHandler("contextmenu",s),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){let e=!this.allowTouchScrolling;const i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),(this.isDrawingMode||i&&this._target===i)&&(e=!0),e&&t.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,r=this._getEventPrefix(),o=cs(s);Hn(o,"touchend",this._onTouchEnd,ki),e&&Hn(o,"touchmove",this._onMouseMove,ki),Wi(s,"".concat(r,"down"),this._onMouseDown)}_onMouseDown(t){this.__onMouseDown(t),this._resetTransformEventData();const e=this.upperCanvasEl,i=this._getEventPrefix();Wi(e,"".concat(i,"move"),this._onMouseMove,ki);const s=cs(e);Hn(s,"".concat(i,"up"),this._onMouseUp),Hn(s,"".concat(i,"move"),this._onMouseMove,ki)}_onTouchEnd(t){if(t.touches.length>0)return;this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),i=cs(this.upperCanvasEl);Wi(i,"touchend",this._onTouchEnd,ki),Wi(i,"touchmove",this._onMouseMove,ki),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{Hn(this.upperCanvasEl,"".concat(e,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(t){this.__onMouseUp(t),this._resetTransformEventData();const e=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(t)){const s=cs(this.upperCanvasEl);Wi(s,"".concat(i,"up"),this._onMouseUp),Wi(s,"".concat(i,"move"),this._onMouseMove,ki),Hn(e,"".concat(i,"move"),this._onMouseMove,ki)}}_onMouseMove(t){const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._cacheTransformEventData(t),this._handleEvent(t,"up:before");const i=this._currentTransform,s=this._isClick,r=this._target,{button:o}=t;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let c,h,f=!1;if(i&&(this._finalizeCurrentTransform(t),f=i.actionPerformed),!s){const g=r===this._activeObject;this.handleSelection(t),f||(f=this._shouldRender(r)||!g&&r===this._activeObject)}if(r){const g=r.findControl(this.getViewportPoint(t),Rg(t)),{key:p,control:v}=g||{};if(h=p,r.selectable&&r!==this._activeObject&&r.activeOn==="up")this.setActiveObject(r,t),f=!0;else if(v){const b=v.getMouseUpHandler(t,r,v);b&&(c=this.getScenePoint(t),b.call(v,t,i,c.x,c.y))}r.isMoving=!1}if(i&&(i.target!==r||i.corner!==h)){const g=i.target&&i.target.controls[i.corner],p=g&&g.getMouseUpHandler(t,i.target,g);c=c||this.getScenePoint(t),p&&p.call(g,t,i,c.x,c.y)}this._setCursorFromEvent(t,r),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,r&&(r.__corner=void 0),f?this.requestRenderAll():s||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:i,subTargets:s=[]}=e;this.fire(t,e),i&&i.fire(t,e);for(let r=0;r<s.length;r++)s[r]!==i&&s[r].fire(t,e);return e}_handleEvent(t,e,i){const s=this._target,r=this.targets||[],o=F(F(F({e:t,target:s,subTargets:r},_a(this,t)),{},{transform:this._currentTransform},e==="up:before"||e==="up"?{isClick:this._isClick,currentTarget:this.findTarget(t),currentSubTargets:this.targets}:{}),e==="down:before"||e==="down"?i:{});this.fire("mouse:".concat(e),o),s&&s.fire("mouse".concat(e),o);for(let c=0;c<r.length;c++)r[c]!==s&&r[c].fire("mouse".concat(e),o)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._cacheTransformEventData(t),this._handleEvent(t,"down:before");let e=this._target,i=!!e&&e===this._activeObject;const{button:s}=t;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(t,"down",{alreadySelected:i}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let r=this._shouldRender(e),o=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,o=!0,r=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const c=this.getScenePoint(t);this._groupSelector={x:c.x,y:c.y,deltaY:0,deltaX:0}}if(i=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const c=e.findControl(this.getViewportPoint(t),Rg(t));if(e===this._activeObject&&(c||!o)){this._setupCurrentTransform(t,e,i);const h=c?c.control:void 0,f=this.getScenePoint(t),g=h&&h.getMouseDownHandler(t,e,h);g&&g.call(h,t,this._currentTransform,f.x,f.y)}}r&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:i}),r&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._pointer=this.getViewportPoint(t),this._absolutePointer=Pa(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)}__onMouseMove(t){if(this._isClick=!1,this._cacheTransformEventData(t),this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const i=this.getScenePoint(t);e.deltaX=i.x-e.x,e.deltaY=i.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const i=this.findTarget(t);this._setCursorFromEvent(t,i),this._fireOverOutEvents(t,i)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move"),this._resetTransformEventData()}_fireOverOutEvents(t,e){const i=this._hoveredTarget,s=this._hoveredTargets,r=this.targets,o=Math.max(s.length,r.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:i,fireCanvas:!0});for(let c=0;c<o;c++)r[c]===e||s[c]&&s[c]===i||this.fireSyntheticInOutEvents("mouse",{e:t,target:r[c],oldTarget:s[c]});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(t,e){const i=this._draggedoverTarget,s=this._hoveredTargets,r=this.targets,o=Math.max(s.length,r.length);this.fireSyntheticInOutEvents("drag",F(F({},e),{},{target:t,oldTarget:i,fireCanvas:!0}));for(let c=0;c<o;c++)this.fireSyntheticInOutEvents("drag",F(F({},e),{},{target:r[c],oldTarget:s[c]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(t,e){let{target:i,oldTarget:s,fireCanvas:r,e:o}=e,c=he(e,k2);const{targetIn:h,targetOut:f,canvasIn:g,canvasOut:p}=R2[t],v=s!==i;if(s&&v){const b=F(F({},c),{},{e:o,target:s,nextTarget:i},_a(this,o));r&&this.fire(p,b),s.fire(f,b)}if(i&&v){const b=F(F({},c),{},{e:o,target:i,previousTarget:s},_a(this,o));r&&this.fire(g,b),i.fire(h,b)}}__onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_transformObject(t){const e=this.getScenePoint(t),i=this._currentTransform,s=i.target,r=s.group?Pa(e,void 0,s.group.calcTransformMatrix()):e;i.shiftKey=t.shiftKey,i.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,i,r),i.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,i){const{action:s,actionHandler:r,target:o}=e,c=!!r&&r(t,e,i.x,i.y);c&&o.setCoords(),s==="drag"&&c&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||c}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let i=e.hoverCursor||this.hoverCursor;const s=mr(this._activeObject)?this._activeObject:null,r=(!s||e.group!==s)&&e.findControl(this.getViewportPoint(t));if(r){const o=r.control;this.setCursor(o.cursorStyleHandler(t,o,e))}else e.subTargetCheck&&this.targets.concat().reverse().map((o=>{i=o.hoverCursor||i})),this.setCursor(i)}handleMultiSelection(t,e){const i=this._activeObject,s=mr(i);if(i&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(i!==e||s)&&(s||!e.isDescendantOf(i)&&!i.isDescendantOf(e))&&!e.onSelect({e:t})&&!i.getActiveControl()){if(s){const r=i.getObjects();if(e===i){const o=this.getViewportPoint(t);if(!(e=this.searchPossibleTargets(r,o)||this.searchPossibleTargets(this._objects,o))||!e.selectable)return!1}e.group===i?(i.remove(e),this._hoveredTarget=e,this._hoveredTargets=[...this.targets],i.size()===1&&this._setActiveObject(i.item(0),t)):(i.multiSelectAdd(e),this._hoveredTarget=i,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(r,t)}else{i.isEditing&&i.exitEditing();const r=new(ct.getClass("ActiveSelection"))([],{canvas:this});r.multiSelectAdd(i,e),this._hoveredTarget=r,this._setActiveObject(r,t),this._fireSelectionEvents([i],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:i,deltaX:s,deltaY:r}=this._groupSelector,o=new X(e,i),c=o.add(new X(s,r)),h=o.min(c),f=o.max(c).subtract(h),g=this.collectObjects({left:h.x,top:h.y,width:f.x,height:f.y},{includeIntersecting:!this.selectionFullyContained}),p=o.eq(c)?g[0]?[g[0]]:[]:g.length>1?g.filter((v=>!v.onSelect({e:t}))).reverse():g;if(p.length===1)this.setActiveObject(p[0],t);else if(p.length>1){const v=ct.getClass("ActiveSelection");this.setActiveObject(new v(p,{canvas:this}),t)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const tx={x1:0,y1:0,x2:0,y2:0},L2=F(F({},tx),{},{r1:0,r2:0}),Ea=(u,t)=>isNaN(u)&&typeof t=="number"?t:u;function ex(u){return u&&/%$/.test(u)&&Number.isFinite(parseFloat(u))}function ix(u,t){const e=typeof u=="number"?u:typeof u=="string"?parseFloat(u)/(ex(u)?100:1):NaN;return Ha(0,Ea(e,t),1)}const P2=/\s*;\s*/,B2=/\s*:\s*/;function N2(u,t){let e,i;const s=u.getAttribute("style");if(s){const o=s.split(P2);o[o.length-1]===""&&o.pop();for(let c=o.length;c--;){const[h,f]=o[c].split(B2).map((g=>g.trim()));h==="stop-color"?e=f:h==="stop-opacity"&&(i=f)}}const r=new $t(e||u.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:ix(u.getAttribute("offset"),0),color:r.toRgb(),opacity:Ea(parseFloat(i||u.getAttribute("stop-opacity")||""),1)*r.getAlpha()*t}}function F2(u,t){const e=[],i=u.getElementsByTagName("stop"),s=ix(t,1);for(let r=i.length;r--;)e.push(N2(i[r],s));return e}function sx(u){return u.nodeName==="linearGradient"||u.nodeName==="LINEARGRADIENT"?"linear":"radial"}function nx(u){return u.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function rs(u,t){return u.getAttribute(t)}function j2(u,t){return(function(e,i){let s,{width:r,height:o,gradientUnits:c}=i;return Object.entries(e).reduce(((h,f)=>{let[g,p]=f;if(p==="Infinity")s=1;else if(p==="-Infinity")s=0;else{const v=typeof p=="string";s=v?parseFloat(p):p,v&&ex(p)&&(s*=.01,c==="pixels"&&(g!=="x1"&&g!=="x2"&&g!=="r2"||(s*=r),g!=="y1"&&g!=="y2"||(s*=o)))}return h[g]=s,h}),{})})(sx(u)==="linear"?(function(e){return{x1:rs(e,"x1")||0,y1:rs(e,"y1")||0,x2:rs(e,"x2")||"100%",y2:rs(e,"y2")||0}})(u):(function(e){return{x1:rs(e,"fx")||rs(e,"cx")||"50%",y1:rs(e,"fy")||rs(e,"cy")||"50%",r1:0,x2:rs(e,"cx")||"50%",y2:rs(e,"cy")||"50%",r2:rs(e,"r")||"50%"}})(u),F(F({},t),{},{gradientUnits:nx(u)}))}class uh{constructor(t){const{type:e="linear",gradientUnits:i="pixels",coords:s={},colorStops:r=[],offsetX:o=0,offsetY:c=0,gradientTransform:h,id:f}=t||{};Object.assign(this,{type:e,gradientUnits:i,coords:F(F({},e==="radial"?L2:tx),s),colorStops:r,offsetX:o,offsetY:c,gradientTransform:h,id:f?"".concat(f,"_").concat(qn()):qn()})}addColorStop(t){for(const e in t){const i=new $t(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this}toObject(t){return F(F({},Wa(this,t)),{},{type:this.type,coords:F({},this.coords),colorStops:this.colorStops.map((e=>F({},e))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[],s=this.gradientTransform?this.gradientTransform.concat():ai.concat(),r=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((p=>F({},p))).sort(((p,v)=>p.offset-v.offset));let c=-this.offsetX,h=-this.offsetY;var f;r==="objectBoundingBox"?(c/=t.width,h/=t.height):(c+=t.width/2,h+=t.height/2),(f=t)&&typeof f._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=t.pathOffset.x,h-=t.pathOffset.y),s[4]-=c,s[5]-=h;const g=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(r,'"'),'gradientTransform="'.concat(e?e+" ":"").concat(bl(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:p,y1:v,x2:b,y2:S}=this.coords;i.push("<linearGradient ",g,' x1="',p,'" y1="',v,'" x2="',b,'" y2="',S,`">
`)}else if(this.type==="radial"){const{x1:p,y1:v,x2:b,y2:S,r1:_,r2:C}=this.coords,w=_>C;i.push("<radialGradient ",g,' cx="',w?p:b,'" cy="',w?v:S,'" r="',w?_:C,'" fx="',w?b:p,'" fy="',w?S:v,`">
`),w&&(o.reverse(),o.forEach((E=>{E.offset=1-E.offset})));const T=Math.min(_,C);if(T>0){const E=T/Math.max(_,C);o.forEach((D=>{D.offset+=E*(1-D.offset)}))}}return o.forEach((p=>{let{color:v,offset:b,opacity:S}=p;i.push("<stop ",'offset="',100*b+"%",'" style="stop-color:',v,S!==void 0?";stop-opacity: "+S:";",`"/>
`)})),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("")}toLive(t){const{x1:e,y1:i,x2:s,y2:r,r1:o,r2:c}=this.coords,h=this.type==="linear"?t.createLinearGradient(e,i,s,r):t.createRadialGradient(e,i,o,s,r,c);return this.colorStops.forEach((f=>{let{color:g,opacity:p,offset:v}=f;h.addColorStop(v,p!==void 0?new $t(g).setAlpha(p).toRgba():g)})),h}static async fromObject(t){const{colorStops:e,gradientTransform:i}=t;return new this(F(F({},t),{},{colorStops:e?e.map((s=>F({},s))):void 0,gradientTransform:i?[...i]:void 0}))}static fromElement(t,e,i){const s=nx(t),r=e._findCenterFromElement();return new this(F({id:t.getAttribute("id")||void 0,type:sx(t),coords:j2(t,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:F2(t,i.opacity),gradientUnits:s,gradientTransform:Ng(t.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:e.width/2-r.x,offsetY:e.height/2-r.y}:{offsetX:0,offsetY:0}))}}B(uh,"type","Gradient"),ct.setClass(uh,"gradient"),ct.setClass(uh,"linear"),ct.setClass(uh,"radial");const z2=["type","source","patternTransform"];class ug{get type(){return"pattern"}set type(t){Yn("warn","Setting type has no effect",t)}constructor(t){B(this,"repeat","repeat"),B(this,"offsetX",0),B(this,"offsetY",0),B(this,"crossOrigin",""),this.id=qn(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:i}=this;return F(F({},Wa(this,t)),{},{type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:i,offsetX:oe(this.offsetX,Xt.NUM_FRACTION_DIGITS),offsetY:oe(this.offsetY,Xt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(t){let{width:e,height:i}=t;const{source:s,repeat:r,id:o}=this,c=Ea(this.offsetX/e,0),h=Ea(this.offsetY/i,0),f=r==="repeat-y"||r==="no-repeat"?1+Math.abs(c||0):Ea(s.width/e,0),g=r==="repeat-x"||r==="no-repeat"?1+Math.abs(h||0):Ea(s.height/i,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(c,'" y="').concat(h,'" width="').concat(f,'" height="').concat(g,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:i,source:s,patternTransform:r}=t,o=he(t,z2);const c=await jh(s,F(F({},e),{},{crossOrigin:o.crossOrigin}));return new this(F(F({},o),{},{patternTransform:r&&r.slice(0),source:c}))}}B(ug,"type","Pattern"),ct.setClass(ug),ct.setClass(ug,"pattern");class I2{constructor(t){B(this,"color","rgb(0, 0, 0)"),B(this,"width",1),B(this,"shadow",null),B(this,"strokeLineCap","round"),B(this,"strokeLineJoin","round"),B(this,"strokeMiterLimit",10),B(this,"strokeDashArray",null),B(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new $t(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,i=t.contextTop,s=t.getZoom()*t.getRetinaScaling();i.shadowColor=e.color,i.shadowBlur=e.blur*s,i.shadowOffsetX=e.offsetX*s,i.shadowOffsetY=e.offsetY*s}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}const H2=["path","left","top"],U2=["d"];class Un extends Je{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:i,left:s,top:r}=e,o=he(e,H2);super(),Object.assign(this,Un.ownDefaults),this.setOptions(o),this._setPath(t||[],!0),typeof s=="number"&&this.set(Qt,s),typeof r=="number"&&this.set(vi,r)}_setPath(t,e){this.path=v2(Array.isArray(t)?t:E2(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new X(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,i=-this.pathOffset.y;t.beginPath();for(const s of this.path)switch(s[0]){case"L":t.lineTo(s[1]+e,s[2]+i);break;case"M":t.moveTo(s[1]+e,s[2]+i);break;case"C":t.bezierCurveTo(s[1]+e,s[2]+i,s[3]+e,s[4]+i,s[5]+e,s[6]+i);break;case"Q":t.quadraticCurveTo(s[1]+e,s[2]+i,s[3]+e,s[4]+i);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F(F({},super.toObject(t)),{},{path:this.path.map((e=>e.slice()))})}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){const t=JS(this.path,Xt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(t,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const t=Xt.NUM_FRACTION_DIGITS;return" translate(".concat(oe(-this.pathOffset.x,t),", ").concat(oe(-this.pathOffset.y,t),")")}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:i,pathOffset:s}=this._calcDimensions();this.set({width:e,height:i,pathOffset:s}),t&&this.setPositionByOrigin(s,Ft,Ft)}_calcBoundsFromPath(){const t=[];let e=0,i=0,s=0,r=0;for(const o of this.path)switch(o[0]){case"L":s=o[1],r=o[2],t.push({x:e,y:i},{x:s,y:r});break;case"M":s=o[1],r=o[2],e=s,i=r;break;case"C":t.push(...Jb(s,r,o[1],o[2],o[3],o[4],o[5],o[6])),s=o[5],r=o[6];break;case"Q":t.push(...Jb(s,r,o[1],o[2],o[1],o[2],o[3],o[4])),s=o[3],r=o[4];break;case"Z":s=e,r=i}return rn(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return F(F({},t),{},{pathOffset:new X(t.left+t.width/2,t.top+t.height/2)})}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,i){const s=fn(t,this.ATTRIBUTE_NAMES,i),{d:r}=s;return new this(r,F(F(F({},he(s,U2)),e),{},{left:void 0,top:void 0}))}}B(Un,"type","Path"),B(Un,"cacheProperties",[...dn,"path","fillRule"]),B(Un,"ATTRIBUTE_NAMES",[...Wn,"d"]),ct.setClass(Un),ct.setSVGClass(Un);class iu extends I2{constructor(t){super(t),B(this,"decimate",.4),B(this,"drawStraightLine",!1),B(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,i){const s=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,s.x,s.y),s}onMouseDown(t,e){let{e:i}=e;this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:i}=e;if(this.canvas._isMainEvent(i)&&(this.drawStraightLine=!!this.straightLineKey&&i[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const s=this._points,r=s.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=iu.drawSegment(o,s[r-2],s[r-1]),o.stroke(),o.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],i=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===i.x&&e.y===i.y){const s=this.width/1e3;e.x-=s,i.x+=s}t.moveTo(e.x,e.y);for(let s=1;s<this._points.length;s++)iu.drawSegment(t,e,i),e=this._points[s],i=this._points[s+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return D2(t,e)}createPath(t){const e=new Un(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new ks(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let i,s=t[0];const r=this.canvas.getZoom(),o=Math.pow(e/r,2),c=t.length-1,h=[s];for(let f=1;f<c-1;f++)i=Math.pow(s.x-t[f].x,2)+Math.pow(s.y-t[f].y,2),i>=o&&(s=t[f],h.push(s));return h.push(t[c]),h}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(i){return JS(i)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const G2=["left","top","radius"],rx=["radius","startAngle","endAngle","counterClockwise"];class tn extends Je{static getDefaults(){return F(F({},super.getDefaults()),tn.ownDefaults)}constructor(t){super(),Object.assign(this,tn.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,Ae(this.startAngle),Ae(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(Si)}getRadiusY(){return this.get("radius")*this.get(Zi)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...rx,...t])}_toSVG(){const t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:e}=this,i=Ae(this.startAngle),s=Ae(this.endAngle),r=ln(i)*e,o=cn(i)*e,c=ln(s)*e,h=cn(s)*e,f=t>180?1:0,g=this.counterClockwise?0:1;return['<path d="M '.concat(r," ").concat(o," A ").concat(e," ").concat(e," 0 ").concat(f," ").concat(g," ").concat(c," ").concat(h,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(t,e,i){const s=fn(t,this.ATTRIBUTE_NAMES,i),{left:r=0,top:o=0,radius:c=0}=s;return new this(F(F({},he(s,G2)),{},{radius:c,left:r-c,top:o-c}))}static fromObject(t){return super._fromObject(t)}}B(tn,"type","Circle"),B(tn,"cacheProperties",[...dn,...rx]),B(tn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),B(tn,"ATTRIBUTE_NAMES",["cx","cy","r",...Wn]),ct.setClass(tn),ct.setSVGClass(tn);const V2=["x1","y1","x2","y2"],X2=["x1","y1","x2","y2"],Hg=["x1","x2","y1","y2"];class yr extends Je{constructor(){let[t,e,i,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,yr.ownDefaults),this.setOptions(r),this.x1=t,this.x2=i,this.y1=e,this.y2=s,this._setWidthHeight();const{left:o,top:c}=r;typeof o=="number"&&this.set(Qt,o),typeof c=="number"&&this.set(vi,c)}_setWidthHeight(){const{x1:t,y1:e,x2:i,y2:s}=this;this.width=Math.abs(i-t),this.height=Math.abs(s-e);const{left:r,top:o,width:c,height:h}=rn([{x:t,y:e},{x:i,y:s}]),f=new X(r+c/2,o+h/2);this.setPositionByOrigin(f,Ft,Ft)}_set(t,e){return super._set(t,e),Hg.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const i=t.strokeStyle;var s;Qi(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i}_findCenterFromElement(){return new X((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F(F({},super.toObject(t)),this.calcLinePoints())}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:i,y2:s,width:r,height:o}=this,c=t<=e?-1:1,h=i<=s?-1:1;return{x1:c*r/2,x2:c*-r/2,y1:h*o/2,y2:h*-o/2}}_toSVG(){const{x1:t,x2:e,y1:i,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(t,'" y1="').concat(i,'" x2="').concat(e,'" y2="').concat(s,`" />
`)]}static async fromElement(t,e,i){const s=fn(t,this.ATTRIBUTE_NAMES,i),{x1:r=0,y1:o=0,x2:c=0,y2:h=0}=s;return new this([r,o,c,h],he(s,V2))}static fromObject(t){let{x1:e,y1:i,x2:s,y2:r}=t,o=he(t,X2);return this._fromObject(F(F({},o),{},{points:[e,i,s,r]}),{extraParam:"points"})}}B(yr,"type","Line"),B(yr,"cacheProperties",[...dn,...Hg]),B(yr,"ATTRIBUTE_NAMES",Wn.concat(Hg)),ct.setClass(yr),ct.setSVGClass(yr);class br extends Je{static getDefaults(){return F(F({},super.getDefaults()),br.ownDefaults)}constructor(t){super(),Object.assign(this,br.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-t," ").concat(e,",0 ").concat(-e,",").concat(t," ").concat(e),'" />']}}B(br,"type","Triangle"),B(br,"ownDefaults",{width:100,height:100}),ct.setClass(br),ct.setSVGClass(br);const ax=["rx","ry"];class en extends Je{static getDefaults(){return F(F({},super.getDefaults()),en.ownDefaults)}constructor(t){super(),Object.assign(this,en.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(Si)}getRy(){return this.get("ry")*this.get(Zi)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ax,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,Vh,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,i){const s=fn(t,this.ATTRIBUTE_NAMES,i);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function Y2(u){if(!u)return[];const t=u.replace(/,/g," ").trim().split(/\s+/),e=[];for(let i=0;i<t.length;i+=2)e.push({x:parseFloat(t[i]),y:parseFloat(t[i+1])});return e}B(en,"type","Ellipse"),B(en,"cacheProperties",[...dn,...ax]),B(en,"ownDefaults",{rx:0,ry:0}),B(en,"ATTRIBUTE_NAMES",[...Wn,"cx","cy","rx","ry"]),ct.setClass(en),ct.setSVGClass(en);const q2=["left","top"],ox={exactBoundingBox:!1};class ls extends Je{static getDefaults(){return F(F({},super.getDefaults()),ls.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),B(this,"strokeDiff",void 0),Object.assign(this,ls.ownDefaults),this.setOptions(e),this.points=t;const{left:i,top:s}=e;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(Qt,i),typeof s=="number"&&this.set(vi,s)}isOpen(){return!0}_projectStrokeOnPoints(t){return BE(this.points,t,this.isOpen())}_calcDimensions(t){t=F({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},t||{});const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map((f=>f.projectedPoint)):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new X,strokeOffset:new X,strokeDiff:new X};const i=rn(e),s=yu(F(F({},t),{},{scaleX:1,scaleY:1})),r=rn(this.points.map((f=>yi(f,s,!0)))),o=new X(this.scaleX,this.scaleY);let c=i.left+i.width/2,h=i.top+i.height/2;return this.exactBoundingBox&&(c-=h*Math.tan(Ae(this.skewX)),h-=c*Math.tan(Ae(this.skewY))),F(F({},i),{},{pathOffset:new X(c,h),strokeOffset:new X(r.left,r.top).subtract(new X(i.left,i.top)).multiply(o),strokeDiff:new X(i.width,i.height).subtract(new X(r.width,r.height)).multiply(o)})}_findCenterFromElement(){const t=rn(this.points);return new X(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:i,width:s,height:r,pathOffset:o,strokeOffset:c,strokeDiff:h}=this._calcDimensions();this.set({width:s,height:r,pathOffset:o,strokeOffset:c,strokeDiff:h}),t&&this.setPositionByOrigin(new X(e+s/2,i+r/2),Ft,Ft)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new X(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some((c=>this.strokeUniform||this.constructor.layoutProperties.includes(c)))){var e,i;const{width:c,height:h}=this._calcDimensions(t);o=new X((e=t.width)!==null&&e!==void 0?e:c,(i=t.height)!==null&&i!==void 0?i:h)}else{var s,r;o=new X((s=t.width)!==null&&s!==void 0?s:this.width,(r=t.height)!==null&&r!==void 0?r:this.height)}return o.multiply(new X(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const i=this.initialized&&this[t]!==e,s=super._set(t,e);return this.exactBoundingBox&&i&&((t===Si||t===Zi)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),s}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F(F({},super.toObject(t)),{},{points:this.points.map((e=>{let{x:i,y:s}=e;return{x:i,y:s}}))})}_toSVG(){const t=[],e=this.pathOffset.x,i=this.pathOffset.y,s=Xt.NUM_FRACTION_DIGITS;for(let r=0,o=this.points.length;r<o;r++)t.push(oe(this.points[r].x-e,s),",",oe(this.points[r].y-i,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(t.join(""),`" />
`)]}_render(t){const e=this.points.length,i=this.pathOffset.x,s=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-i,this.points[0].y-s);for(let r=0;r<e;r++){const o=this.points[r];t.lineTo(o.x-i,o.y-s)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,i){return new this(Y2(t.getAttribute("points")),F(F({},he(fn(t,this.ATTRIBUTE_NAMES,i),q2)),e))}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}B(ls,"ownDefaults",ox),B(ls,"type","Polyline"),B(ls,"layoutProperties",[Xa,Ya,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),B(ls,"cacheProperties",[...dn,"points"]),B(ls,"ATTRIBUTE_NAMES",[...Wn]),ct.setClass(ls),ct.setSVGClass(ls);class dh extends ls{isOpen(){return!1}}B(dh,"ownDefaults",ox),B(dh,"type","Polygon"),ct.setClass(dh),ct.setSVGClass(dh);class lx extends Je{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const i in e)for(const s in e[i])for(const r in e[i][s])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const i=e===void 0?this.styles:{0:this.styles[e]};for(const s in i)for(const r in i[s])if(i[s][r][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let i,s,r=0,o=!0,c=0;for(const h in e){i=0;for(const f in e[h]){const g=e[h][f]||{};r++,g[t]!==void 0?(s?g[t]!==s&&(o=!1):s=g[t],g[t]===this[t]&&delete g[t]):o=!1,Object.keys(g).length!==0?i++:delete e[h][f]}i===0&&delete e[h]}for(let h=0;h<this._textLines.length;h++)c+=this._textLines[h].length;o&&r===c&&(this[t]=s,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let i,s,r;for(s in e){for(r in i=e[s],i)delete i[r][t],Object.keys(i[r]).length===0&&delete i[r];Object.keys(i).length===0&&delete e[s]}}_extendStyles(t,e){const{lineIndex:i,charIndex:s}=this.get2DCursorLocation(t);this._getLineStyle(i)||this._setLineStyle(i);const r=vp(F(F({},this._getStyleDeclaration(i,s)),e),(o=>o!==void 0));this._setStyleDeclaration(i,s,r)}getSelectionStyles(t,e,i){const s=[];for(let r=t;r<(e||t);r++)s.push(this.getStyleAtPosition(r,i));return s}getStyleAtPosition(t,e){const{lineIndex:i,charIndex:s}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(i,s):this._getStyleDeclaration(i,s)}setSelectionStyles(t,e,i){for(let s=e;s<(i||e);s++)this._extendStyles(s,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var i;const s=this.styles&&this.styles[t];return s&&(i=s[e])!==null&&i!==void 0?i:{}}getCompleteStyleDeclaration(t,e){return F(F({},Wa(this,this.constructor._styleProperties)),this._getStyleDeclaration(t,e))}_setStyleDeclaration(t,e,i){this.styles[t][e]=i}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}B(lx,"_styleProperties",QT);const W2=/  +/g,K2=/"/g;function dg(u,t,e,i,s){return"		".concat((function(r,o){let{left:c,top:h,width:f,height:g}=o,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xt.NUM_FRACTION_DIGITS;const v=_l(Le,r,!1),[b,S,_,C]=[c,h,f,g].map((w=>oe(w,p)));return"<rect ".concat(v,' x="').concat(b,'" y="').concat(S,'" width="').concat(_,'" height="').concat(C,'"></rect>')})(u,{left:t,top:e,width:i,height:s}),`
`)}const $2=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let fg;class si extends lx{static getDefaults(){return F(F({},super.getDefaults()),si.ownDefaults)}constructor(t,e){super(),B(this,"__charBounds",[]),Object.assign(this,si.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=ZS(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Ds)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,i,s,r,o,c;for(let h=0,f=this._textLines.length;h<f;h++)if((this.textAlign===Ds||h!==f-1&&!this.isEndOfWrapping(h))&&(s=0,r=this._textLines[h],e=this.getLineWidth(h),e<this.width&&(c=this.textLines[h].match(this._reSpacesAndTabs)))){i=c.length,t=(this.width-e)/i;for(let g=0;g<=r.length;g++)o=this.__charBounds[h][g],this._reSpaceAndTab.test(r[g])?(o.width+=t,o.kernedWidth+=t,o.left+=s,s+=t):o.left+=s}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const i=e?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<i.length;s++){if(t<=i[s].length)return{lineIndex:s,charIndex:t};t-=i[s].length+this.missingNewlineOffset(s,e)}return{lineIndex:s-1,charIndex:i[s-1].length<t?i[s-1].length:t}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===_i?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,i){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Ft:t.textBaseline="middle";break;case"ascender":t.textBaseline=vi;break;case"descender":t.textBaseline=Og}t.font=this._getFontDeclaration(e,i)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,i=this._textLines.length;e<i;e++){const s=this.getLineWidth(e);s>t&&(t=s)}return t}_renderTextLine(t,e,i,s,r,o){this._renderChars(t,e,i,s,r,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,i=this._getLeftOffset();let s=this._getTopOffset();for(let r=0,o=this._textLines.length;r<o;r++){const c=this.getHeightOfLine(r);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",r)){s+=c;continue}const h=this._textLines[r].length,f=this._getLineLeftOffset(r);let g,p,v=0,b=0,S=this.getValueOfPropertyAt(r,0,"textBackgroundColor");const _=this.getHeightOfLineImpl(r);for(let C=0;C<h;C++){const w=this.__charBounds[r][C];p=this.getValueOfPropertyAt(r,C,"textBackgroundColor"),this.path?(t.save(),t.translate(w.renderLeft,w.renderTop),t.rotate(w.angle),t.fillStyle=p,p&&t.fillRect(-w.width/2,-_*(1-this._fontSizeFraction),w.width,_),t.restore()):p!==S?(g=i+f+b,this.direction==="rtl"&&(g=this.width-g-v),t.fillStyle=S,S&&t.fillRect(g,s,v,_),b=w.left,v=w.width,S=p):v+=w.kernedWidth}p&&!this.path&&(g=i+f+b,this.direction==="rtl"&&(g=this.width-g-v),t.fillStyle=p,t.fillRect(g,s,v,_)),s+=c}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,i,s){const r=ol.getFontCache(e),o=this._getFontDeclaration(e),c=i+t,h=i&&o===this._getFontDeclaration(s),f=e.fontSize/this.CACHE_FONT_SIZE;let g,p,v,b;if(i&&r.has(i)&&(v=r.get(i)),r.has(t)&&(b=g=r.get(t)),h&&r.has(c)&&(p=r.get(c),b=p-v),g===void 0||v===void 0||p===void 0){const S=(function(){return fg||(fg=Ji({width:0,height:0}).getContext("2d")),fg})();this._setTextStyles(S,e,!0),g===void 0&&(b=g=S.measureText(t).width,r.set(t,g)),v===void 0&&h&&i&&(v=S.measureText(i).width,r.set(i,v)),h&&p===void 0&&(p=S.measureText(c).width,r.set(c,p),b=p-v)}return{width:g*f,kernedWidth:b*f}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,i,s=0;const r=this.pathSide===Ce,o=this.path,c=this._textLines[t],h=c.length,f=new Array(h);this.__charBounds[t]=f;for(let g=0;g<h;g++){const p=c[g];i=this._getGraphemeBox(p,t,g,e),f[g]=i,s+=i.kernedWidth,e=p}if(f[h]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let g=0;const p=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Qt:g=r?p-s:0;break;case Ft:g=(p-s)/2;break;case Ce:g=r?0:p-s}g+=this.pathStartOffset*(r?-1:1);for(let v=r?h-1:0;r?v>=0:v<h;r?v--:v++)i=f[v],g>p?g%=p:g<0&&(g+=p),this._setGraphemeOnPath(g,i),g+=i.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(t,e){const i=t+e.kernedWidth/2,s=this.path,r=w2(s.path,i,s.segmentsInfo);e.renderLeft=r.x-s.pathOffset.x,e.renderTop=r.y-s.pathOffset.y,e.angle=r.angle+(this.pathSide===Ce?Math.PI:0)}_getGraphemeBox(t,e,i,s,r){const o=this.getCompleteStyleDeclaration(e,i),c=s?this.getCompleteStyleDeclaration(e,i-1):{},h=this._measureChar(t,o,s,c);let f,g=h.kernedWidth,p=h.width;this.charSpacing!==0&&(f=this._getWidthOfCharSpacing(),p+=f,g+=f);const v={width:p,left:0,height:o.fontSize,kernedWidth:g,deltaY:o.deltaY};if(i>0&&!r){const b=this.__charBounds[e][i-1];v.left=b.left+b.width+h.kernedWidth-h.width}return v}getHeightOfLineImpl(t){const e=this.__lineHeights;if(e[t])return e[t];let i=this.getHeightOfChar(t,0);for(let s=1,r=this._textLines[t].length;s<r;s++)i=Math.max(this.getHeightOfChar(t,s),i);return e[t]=i*this._fontSizeMult}getHeightOfLine(t){return this.getHeightOfLineImpl(t)*this.lineHeight}calcTextHeight(){let t=0;for(let e=0,i=this._textLines.length;e<i;e++)t+=e===i-1?this.getHeightOfLineImpl(e):this.getHeightOfLine(e);return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let i=0;const s=this._getLeftOffset(),r=this._getTopOffset();for(let o=0,c=this._textLines.length;o<c;o++)this._renderTextLine(e,t,this._textLines[o],s+this._getLineLeftOffset(o),r+i+this.getHeightOfLineImpl(o),o),i+=this.getHeightOfLine(o);t.restore()}_renderTextFill(t){(this.fill||this.styleHas(Le))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,i,s,r,o){const c=this.textAlign.includes(Ds),h=this.path,f=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!h,g=this.direction==="ltr",p=this.direction==="ltr"?1:-1,v=e.direction;let b,S,_,C,w,T="",E=0;if(e.save(),v!==this.direction&&(e.canvas.setAttribute("dir",g?"ltr":"rtl"),e.direction=g?"ltr":"rtl",e.textAlign=g?Qt:Ce),r-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,f)return this._renderChar(t,e,o,0,i.join(""),s,r),void e.restore();for(let D=0,M=i.length-1;D<=M;D++)C=D===M||this.charSpacing||h,T+=i[D],_=this.__charBounds[o][D],E===0?(s+=p*(_.kernedWidth-_.width),E+=_.width):E+=_.kernedWidth,c&&!C&&this._reSpaceAndTab.test(i[D])&&(C=!0),C||(b=b||this.getCompleteStyleDeclaration(o,D),S=this.getCompleteStyleDeclaration(o,D+1),C=Tp(b,S,!1)),C&&(h?(e.save(),e.translate(_.renderLeft,_.renderTop),e.rotate(_.angle),this._renderChar(t,e,o,D,T,-E/2,0),e.restore()):(w=s,this._renderChar(t,e,o,D,T,w,r)),T="",b=S,s+=p*E,E=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,i=this.height+this.strokeWidth,s=Ji({width:e,height:i}),r=s.getContext("2d");return s.width=e,s.height=i,r.beginPath(),r.moveTo(0,0),r.lineTo(e,0),r.lineTo(e,i),r.lineTo(0,i),r.closePath(),r.translate(e/2,i/2),r.fillStyle=t.toLive(r),this._applyPatternGradientTransform(r,t),r.fill(),r.createPattern(s,"no-repeat")}handleFiller(t,e,i){let s,r;return Qi(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(s=-this.width/2,r=-this.height/2,t.translate(s,r),t[e]=this._applyPatternGradientTransformText(i),{offsetX:s,offsetY:r}):(t[e]=i.toLive(t),this._applyPatternGradientTransform(t,i)):(t[e]=i,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:i,strokeWidth:s}=e;return t.lineWidth=s,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",i)}_setFillStyles(t,e){let{fill:i}=e;return this.handleFiller(t,"fillStyle",i)}_renderChar(t,e,i,s,r,o,c){const h=this._getStyleDeclaration(i,s),f=this.getCompleteStyleDeclaration(i,s),g=t==="fillText"&&f.fill,p=t==="strokeText"&&f.stroke&&f.strokeWidth;if(p||g){if(e.save(),e.font=this._getFontDeclaration(f),h.textBackgroundColor&&this._removeShadow(e),h.deltaY&&(c+=h.deltaY),g){const v=this._setFillStyles(e,f);e.fillText(r,o-v.offsetX,c-v.offsetY)}if(p){const v=this._setStrokeStyles(e,f);e.strokeText(r,o-v.offsetX,c-v.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,i){const s=this.get2DCursorLocation(t,!0),r=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),c={fontSize:r*i.size,deltaY:o+r*i.baseline};this.setSelectionStyles(c,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),i=this.width-e,s=this.textAlign,r=this.direction,o=this.isEndOfWrapping(t);let c=0;return s===Ds||s===cl&&!o||s===ll&&!o||s===Zh&&!o?0:(s===Ft&&(c=i/2),s===Ce&&(c=i),s===cl&&(c=i/2),s===ll&&(c=i),r==="rtl"&&(s===Ce||s===Ds||s===ll?c=0:s===Qt||s===Zh?c=-i:s!==Ft&&s!==cl||(c=-i/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,i){var s;return(s=this._getStyleDeclaration(t,e)[i])!==null&&s!==void 0?s:this[i]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let i=this._getTopOffset();const s=this._getLeftOffset(),r=this.path,o=this._getWidthOfCharSpacing(),c=e==="linethrough"?.5:e==="overline"?1:0,h=this.offsets[e];for(let f=0,g=this._textLines.length;f<g;f++){const p=this.getHeightOfLine(f);if(!this[e]&&!this.styleHas(e,f)){i+=p;continue}const v=this._textLines[f],b=p/this.lineHeight,S=this._getLineLeftOffset(f);let _=0,C=0,w=this.getValueOfPropertyAt(f,0,e),T=this.getValueOfPropertyAt(f,0,Le),E=this.getValueOfPropertyAt(f,0,Mr),D=w,M=T,O=E;const R=i+b*(1-this._fontSizeFraction);let j=this.getHeightOfChar(f,0),G=this.getValueOfPropertyAt(f,0,"deltaY");for(let st=0,rt=v.length;st<rt;st++){const it=this.__charBounds[f][st];D=this.getValueOfPropertyAt(f,st,e),M=this.getValueOfPropertyAt(f,st,Le),O=this.getValueOfPropertyAt(f,st,Mr);const lt=this.getHeightOfChar(f,st),L=this.getValueOfPropertyAt(f,st,"deltaY");if(r&&D&&M){const I=this.fontSize*O/1e3;t.save(),t.fillStyle=T,t.translate(it.renderLeft,it.renderTop),t.rotate(it.angle),t.fillRect(-it.kernedWidth/2,h*lt+L-c*I,it.kernedWidth,I),t.restore()}else if((D!==w||M!==T||lt!==j||O!==E||L!==G)&&C>0){const I=this.fontSize*E/1e3;let K=s+S+_;this.direction==="rtl"&&(K=this.width-K-C),w&&T&&E&&(t.fillStyle=T,t.fillRect(K,R+h*j+G-c*I,C,I)),_=it.left,C=it.width,w=D,E=O,T=M,j=lt,G=L}else C+=it.kernedWidth}let Q=s+S+_;this.direction==="rtl"&&(Q=this.width-Q-C),t.fillStyle=M;const J=this.fontSize*O/1e3;D&&M&&O&&t.fillRect(Q,R+h*j+G-c*J,C-o,J),i+=p}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;const o=t.includes("'")||t.includes('"')||t.includes(",")||si.genericFonts.includes(t.toLowerCase())?t:'"'.concat(t,'"');return[e,i,"".concat(r?this.CACHE_FONT_SIZE:s,"px"),o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return Ap(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),i=new Array(e.length),s=[`
`];let r=[];for(let o=0;o<e.length;o++)i[o]=this.graphemeSplit(e[o]),r=r.concat(i[o],s);return r.pop(),{_unwrappedLines:i,lines:e,graphemeText:r,graphemeLines:i}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F(F({},super.toObject([...PS,...t])),{},{styles:zE(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(t,e){const{textLayoutProperties:i}=this.constructor;super.set(t,e);let s=!1,r=!1;if(typeof t=="object")for(const o in t)o==="path"&&this.setPathInfo(),s=s||i.includes(o),r=r||o==="path";else s=i.includes(t),r=t==="path";return r&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,i){const s=fn(t,si.ATTRIBUTE_NAMES,i),r=F(F({},e),s),{textAnchor:o=Qt,textDecoration:c="",dx:h=0,dy:f=0,top:g=0,left:p=0,fontSize:v=dp,strokeWidth:b=1}=r,S=he(r,$2),_=new this(Qh(t.textContent||"").trim(),F({left:p+h,top:g+f,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:v},S)),C=_.getScaledHeight()/_.height,w=((_.height+_.strokeWidth)*_.lineHeight-_.height)*C,T=_.getScaledHeight()+w;let E=0;return o===Ft&&(E=_.getScaledWidth()/2),o===Ce&&(E=_.getScaledWidth()),_.set({left:_.left-E,top:_.top-(T-_.fontSize*(.07+_._fontSizeFraction))/_.lineHeight,strokeWidth:b}),_}static fromObject(t){return this._fromObject(F(F({},t),{},{styles:IE(t.styles||{},t.text)}),{extraParam:"text"})}}B(si,"textLayoutProperties",LS),B(si,"cacheProperties",[...dn,...PS]),B(si,"ownDefaults",ZT),B(si,"type","Text"),B(si,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),B(si,"ATTRIBUTE_NAMES",Wn.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),GS(si,[class extends OS{_toSVG(){const u=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(u.textTop,u.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(u){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:u,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:u,withShadow:!0,additionalTransform:bl(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(u){let{textBgRects:t,textSpans:e}=u;const i=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(K2,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",i?'text-decoration="'.concat(i,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(u,t){const e=[],i=[];let s,r=u;this.backgroundColor&&i.push(...dg(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,c=this._textLines.length;o<c;o++)s=this._getLineLeftOffset(o),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(i,o,t+s,r),this._setSVGTextLineText(e,o,t+s,r),r+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:i}}_createTextCharSpan(u,t,e,i,s){const r=Xt.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,u!==u.trim()||!!u.match(W2)),c=o?'style="'.concat(o,'"'):"",h=t.deltaY,f=h?' dy="'.concat(oe(h,r),'" '):"",{angle:g,renderLeft:p,renderTop:v,width:b}=s;let S="";if(p!==void 0){const _=b/2;g&&(S=' rotate="'.concat(oe(un(g),r),'"'));const C=qa({angle:un(g)});C[4]=p,C[5]=v;const w=new X(-_,0).transform(C);e=w.x,i=w.y}return'<tspan x="'.concat(oe(e,r),'" y="').concat(oe(i,r),'" ').concat(f).concat(S).concat(c,">").concat(NE(u),"</tspan>")}_setSVGTextLineText(u,t,e,i){const s=this.getHeightOfLine(t),r=this.textAlign.includes(Ds),o=this._textLines[t];let c,h,f,g,p,v="",b=0;i+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let S=0,_=o.length-1;S<=_;S++)p=S===_||this.charSpacing||this.path,v+=o[S],f=this.__charBounds[t][S],b===0?(e+=f.kernedWidth-f.width,b+=f.width):b+=f.kernedWidth,r&&!p&&this._reSpaceAndTab.test(o[S])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(t,S),h=this.getCompleteStyleDeclaration(t,S+1),p=Tp(c,h,!0)),p&&(g=this._getStyleDeclaration(t,S),u.push(this._createTextCharSpan(v,g,e,i,f)),v="",c=h,this.direction==="rtl"?e-=b:e+=b,b=0)}_setSVGTextLineBg(u,t,e,i){const s=this._textLines[t],r=this.getHeightOfLine(t)/this.lineHeight;let o,c=0,h=0,f=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let g=0;g<s.length;g++){const{left:p,width:v,kernedWidth:b}=this.__charBounds[t][g];o=this.getValueOfPropertyAt(t,g,"textBackgroundColor"),o!==f?(f&&u.push(...dg(f,e+h,i,c,r)),h=p,c=v,f=o):c+=b}o&&u.push(...dg(f,e+h,i,c,r))}_getSVGLineTopOffset(u){let t,e=0;for(t=0;t<u;t++)e+=this.getHeightOfLine(t);const i=this.getHeightOfLine(t);return{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(u){return"".concat(super.getSvgStyles(u)," text-decoration-thickness: ").concat(oe(this.textDecorationThickness*this.getObjectScaling().y/10,Xt.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(u,t){const{fontFamily:e,strokeWidth:i,stroke:s,fill:r,fontSize:o,fontStyle:c,fontWeight:h,deltaY:f,textDecorationThickness:g,linethrough:p,overline:v,underline:b}=u,S=this.getSvgTextDecoration({underline:b??this.underline,overline:v??this.overline,linethrough:p??this.linethrough}),_=g||this.textDecorationThickness;return[s?_l(_i,s):"",i?"stroke-width: ".concat(i,"; "):"",e?"font-family: ".concat(e.includes("'")||e.includes('"')?e:"'".concat(e,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",c?"font-style: ".concat(c,"; "):"",h?"font-weight: ".concat(h,"; "):"",S?"text-decoration: ".concat(S,"; text-decoration-thickness: ").concat(oe(_*this.getObjectScaling().y/10,Xt.NUM_FRACTION_DIGITS),"%; "):"",r?_l(Le,r):"",f?"baseline-shift: ".concat(-f,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(u){return["overline","underline","line-through"].filter((t=>u[t.replace("-","")])).join(" ")}}]),ct.setClass(si),ct.setSVGClass(si);class Q2{constructor(t){B(this,"target",void 0),B(this,"__mouseDownInPlace",!1),B(this,"__dragStartFired",!1),B(this,"__isDraggingOver",!1),B(this,"__dragStartSelection",void 0),B(this,"__dragImageDisposer",void 0),B(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach((i=>i())),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,i=e.getSelectionStartFromPointer(t);return e.isEditing&&i>=e.selectionStart&&i<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var i;let{selectionStart:s,selectionEnd:r}=e;const o=this.target,c=o.canvas,h=new X(o.flipX?-1:1,o.flipY?-1:1),f=o._getCursorBoundaries(s),g=new X(f.left+f.leftOffset,f.top+f.topOffset).multiply(h).transform(o.calcTransformMatrix()),p=c.getScenePoint(t).subtract(g),v=o.getCanvasRetinaScaling(),b=o.getBoundingRect(),S=g.subtract(new X(b.left,b.top)),_=c.viewportTransform,C=S.add(p).transform(_,!0),w=o.backgroundColor,T=Cp(o.styles);o.backgroundColor="";const E={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(E,0,s),o.setSelectionStyles(E,r,o.text.length),o.dirty=!0;const D=o.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=w,o.styles=T,o.dirty=!0,zg(D,{position:"fixed",left:"".concat(-D.width,"px"),border:bi,width:"".concat(D.width/v,"px"),height:"".concat(D.height/v,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{D.remove()},cs(t.target||this.target.hiddenTextarea).body.appendChild(D),(i=t.dataTransfer)===null||i===void 0||i.setDragImage(D,C.x,C.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,i=this.isActive();if(i&&t.dataTransfer){const s=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},r=e._text.slice(s.selectionStart,s.selectionEnd).join(""),o=F({text:e.text,value:r},s);t.dataTransfer.setData("text/plain",r),t.dataTransfer.setData("application/fabric",JSON.stringify({value:r,styles:e.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),i}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),i=this.__dragStartSelection;return e<i.selectionStart||e>i.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const i=this.targetCanDrop(e);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,i=this.targetCanDrop(e);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:i}=t,s=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let r=(e=i.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(r&&!s){const o=this.target,c=o.canvas;let h=o.getSelectionStartFromPointer(i);const{styles:f}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},g=r[Math.max(0,r.length-1)],p=0;if(this.__dragStartSelection){const v=this.__dragStartSelection.selectionStart,b=this.__dragStartSelection.selectionEnd;h>v&&h<=b?h=v:h>b&&(h-=b-v),o.removeChars(v,b),delete this.__dragStartSelection}o._reNewline.test(g)&&(o._reNewline.test(o._text[h])||h===o._text.length)&&(r=r.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(r,f,h),c.setActiveObject(o),o.enterEditing(i),o.selectionStart=Math.min(h+p,o._text.length),o.selectionEnd=Math.min(o.selectionStart+r.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Xh,{index:h+p,action:"drop"}),c.fire("text:changed",{target:o}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;const s=this.target,r=this.target.canvas,{selectionStart:o,selectionEnd:c}=this.__dragStartSelection,h=((i=e.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||bi;h===bi?(s.selectionStart=o,s.selectionEnd=c,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),h==="move"&&(s.removeChars(o,c),s.selectionStart=s.selectionEnd=o,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Xh,{index:o,action:"dragend"}),r.fire("text:changed",{target:s}),r.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const i_=/[ \n\.,;!\?\-]/;class Z2 extends si{constructor(){super(...arguments),B(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:i,delay:s,onComplete:r}=t;return jS({startValue:this._currentCursorOpacity,endValue:e,duration:i,delay:s,onComplete:r,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach((e=>{e&&!e.isDone()&&(t=!0,e.abort())})),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((t=>!t||t.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findWordBoundaryRight(t){let e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}findLineBoundaryLeft(t){let e=0,i=t-1;for(;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e}findLineBoundaryRight(t){let e=0,i=t;for(;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e}searchWordBoundary(t,e){const i=this._text;let s=t>0&&this._reSpace.test(i[t])&&(e===-1||!fp.test(i[t-1]))?t-1:t,r=i[s];for(;s>0&&s<i.length&&!i_.test(r);)s+=e,r=i[s];return e===-1&&i_.test(r)&&s++,s}selectWord(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const i=this.searchWordBoundary(t,-1),s=Math.max(i,this.searchWordBoundary(t,1));this.selectionStart=i,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;const i=this.findLineBoundaryLeft(t),s=this.findLineBoundaryRight(t);this.selectionStart=i,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;cs(e).activeElement!==e&&e.focus();const i=this.getSelectionStartFromPointer(t),s=this.selectionStart,r=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&s!==r||s!==i&&r!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===r||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,i){const s=i.slice(0,t),r=this.graphemeSplit(s).length;if(t===e)return{selectionStart:r,selectionEnd:r};const o=i.slice(t,e);return{selectionStart:r,selectionEnd:r+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,i){const s=i.slice(0,t).join("").length;return t===e?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+i.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const t=this.hiddenTextarea;this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const e=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),s=i.lineIndex,r=i.charIndex,o=this.getValueOfPropertyAt(s,r,"fontSize")*this.lineHeight,c=e.leftOffset,h=this.getCanvasRetinaScaling(),f=this.canvas.upperCanvasEl,g=f.width/h,p=f.height/h,v=g-o,b=p-o,S=new X(e.left+c,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new X(f.clientWidth/g,f.clientHeight/p));return S.x<0&&(S.x=0),S.x>v&&(S.x=v),S.y<0&&(S.y=0),S.y>b&&(S.y=b),S.x+=this.canvas._offset.left,S.y+=this.canvas._offset.top,{left:"".concat(S.x,"px"),top:"".concat(S.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(Yh),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:i,charIndex:s}=this.get2DCursorLocation(t,!0),{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e,!0);if(i!==r){if(this.styles[i])for(let c=s;c<this._unwrappedTextLines[i].length;c++)delete this.styles[i][c];if(this.styles[r])for(let c=o;c<this._unwrappedTextLines[r].length;c++){const h=this.styles[r][c];h&&(this.styles[i]||(this.styles[i]={}),this.styles[i][s+c-o]=h)}for(let c=i+1;c<=r;c++)delete this.styles[c];this.shiftLineStyles(r,i-r)}else if(this.styles[i]){const c=this.styles[i],h=o-s;for(let f=s;f<o;f++)delete c[f];for(const f in this.styles[i]){const g=parseInt(f,10);g>=o&&(c[g-h]=c[f],delete c[f])}}}shiftLineStyles(t,e){const i=Object.assign({},this.styles);for(const s in this.styles){const r=parseInt(s,10);r>t&&(this.styles[r+e]=i[r],i[r-e]||delete this.styles[r])}}insertNewlineStyleObject(t,e,i,s){const r={},o=this._unwrappedTextLines[t].length,c=o===e;let h=!1;i||(i=1),this.shiftLineStyles(t,i);const f=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const p in this.styles[t]){const v=parseInt(p,10);v>=e&&(h=!0,r[v-e]=this.styles[t][p],c&&e===0||delete this.styles[t][p])}let g=!1;for(h&&!c&&(this.styles[t+i]=r,g=!0),(g||o>e)&&i--;i>0;)s&&s[i-1]?this.styles[t+i]={0:F({},s[i-1])}:f?this.styles[t+i]={0:F({},f)}:delete this.styles[t+i],i--;this._forceClearCache=!0}insertCharStyleObject(t,e,i,s){this.styles||(this.styles={});const r=this.styles[t],o=r?F({},r):{};i||(i=1);for(const h in o){const f=parseInt(h,10);f>=e&&(r[f+i]=o[f],o[f-i]||delete r[f])}if(this._forceClearCache=!0,s){for(;i--;)Object.keys(s[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]=F({},s[i]));return}if(!r)return;const c=r[e?e-1:1];for(;c&&i--;)this.styles[t][e+i]=F({},c)}insertNewStyleBlock(t,e,i){const s=this.get2DCursorLocation(e,!0),r=[0];let o,c=0;for(let h=0;h<t.length;h++)t[h]===`
`?(c++,r[c]=0):r[c]++;for(r[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,r[0],i),i=i&&i.slice(r[0]+1)),c&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+r[0],c),o=1;o<c;o++)r[o]>0?this.insertCharStyleObject(s.lineIndex+o,0,r[o],i):i&&this.styles[s.lineIndex+o]&&i[0]&&(this.styles[s.lineIndex+o][0]=i[0]),i=i&&i.slice(r[o]+1);r[o]>0&&this.insertCharStyleObject(s.lineIndex+o,0,r[o],i)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;s>i&&this.removeStyleFromTo(i,s);const r=this.graphemeSplit(t);this.insertNewStyleBlock(r,i,e),this._text=[...this._text.slice(0,i),...r,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,i){i<=t?(e===t?this._selectionDirection=Qt:this._selectionDirection===Ce&&(this._selectionDirection=Qt,this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?this._selectionDirection===Ce?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection=Ce:this._selectionDirection===Qt&&(this._selectionDirection=Ce,this.selectionStart=e),this.selectionEnd=i)}}class J2 extends Z2{initHiddenTextarea(){const t=this.canvas&&cs(this.canvas.getElement())||Va(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((o=>{let[c,h]=o;return e.setAttribute(c,h)}));const{top:i,left:s,fontSize:r}=this._calcTextareaPosition();e.style.cssText="position: absolute; top: ".concat(i,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(r,";"),(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[c,h]=o;return e.addEventListener(c,this[h].bind(this))})),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:i,selectionStart:s,selectionEnd:r}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Xh),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const c=this._splitTextIntoLines(i).graphemeText,h=this._text.length,f=c.length,g=this.selectionStart,p=this.selectionEnd,v=g!==p;let b,S,_,C,w=f-h;const T=this.fromStringToGraphemeSelection(s,r,i),E=g>T.selectionStart;v?(S=this._text.slice(g,p),w+=p-g):f<h&&(S=E?this._text.slice(p+w,p):this._text.slice(g,g-w));const D=c.slice(T.selectionEnd-w,T.selectionEnd);if(S&&S.length&&(D.length&&(b=this.getSelectionStyles(g,g+1,!1),b=D.map((()=>b[0]))),v?(_=g,C=p):E?(_=p-S.length,C=p):(_=p,C=p+S.length),this.removeStyleFromTo(_,C)),D.length){const{copyPasteData:M}=Rs();e&&D.join("")===M.copiedText&&!Xt.disableStyleCopyPaste&&(b=M.copiedTextStyle),this.insertNewStyleBlock(D,g,b)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:i,selectionEnd:s}=e;this.compositionStart=i,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=Rs();t.copiedText=this.getSelectedText(),Xt.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let i,s=this._getLineLeftOffset(t);return e>0&&(i=this.__charBounds[t][e-1],s+=i.left+i.width),s}getDownCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),s=this.get2DCursorLocation(i),r=s.lineIndex;if(r===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-i;const o=s.charIndex,c=this._getWidthBeforeCursor(r,o),h=this._getIndexOnLine(r+1,c);return this._textLines[r].slice(o).length+h+1+this.missingNewlineOffset(r)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const i=this._getSelectionForOffset(t,e),s=this.get2DCursorLocation(i),r=s.lineIndex;if(r===0||t.metaKey||t.keyCode===33)return-i;const o=s.charIndex,c=this._getWidthBeforeCursor(r,o),h=this._getIndexOnLine(r-1,c),f=this._textLines[r].slice(0,o),g=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+h-f.length+(1-g)}_getIndexOnLine(t,e){const i=this._textLines[t];let s,r,o=this._getLineLeftOffset(t),c=0;for(let h=0,f=i.length;h<f;h++)if(s=this.__charBounds[t][h].width,o+=s,o>e){r=!0;const g=o-s,p=o,v=Math.abs(g-e);c=Math.abs(p-e)<v?h:h-1;break}return r||(c=i.length-1),c}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const i=this["get".concat(t,"CursorOffset")](e,this._selectionDirection===Ce);if(e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){const s=this.text.length;this.selectionStart=Ha(0,this.selectionStart,s),this.selectionEnd=Ha(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===Qt?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,i){let s;if(t.altKey)s=this["findWordBoundary".concat(i)](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=i==="Left"?-1:1,!0;s=this["findLineBoundary".concat(i)](this[e])}return s!==void 0&&this[e]!==s&&(this[e]=s,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=Qt,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===Ce&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Qt,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const i="moveCursor".concat(t).concat(e.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===Qt&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Ce,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=Ce,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const s_=u=>!!u.button;class tD extends J2{constructor(){super(...arguments),B(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Q2(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:i}=t;this.canvas&&this.editable&&!s_(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)))}mouseUpHandler(t){let{e,transform:i}=t;const s=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const r=this.canvas._activeObject;if(r&&r!==this)return}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||s_(e)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),i=this.selectionStart,s=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,s,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(hs(this.calcTransformMatrix())).add(new X(-this._getLeftOffset(),-this._getTopOffset()));let i=0,s=0,r=0;for(let f=0;f<this._textLines.length&&i<=e.y;f++)i+=this.getHeightOfLine(f),r=f,f>0&&(s+=this._textLines[f-1].length+this.missingNewlineOffset(f-1));let o=Math.abs(this._getLineLeftOffset(r));const c=this._textLines[r].length,h=this.__charBounds[r];for(let f=0;f<c;f++){const g=o+h[f].kernedWidth;if(e.x<=g){Math.abs(e.x-g)<=Math.abs(e.x-o)&&s++;break}o=g,s++}return Math.min(this.flipX?c-s:s,this._text.length)}}const fh="moveCursorUp",gh="moveCursorDown",ph="moveCursorLeft",mh="moveCursorRight",yh="exitEditing",n_=(u,t)=>{const e=t.getRetinaScaling();u.setTransform(e,0,0,e,0,0);const i=t.viewportTransform;u.transform(i[0],i[1],i[2],i[3],i[4],i[5])},eD=F({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:yh,27:yh,33:fh,34:gh,35:mh,36:ph,37:ph,38:fh,39:mh,40:gh},keysMapRtl:{9:yh,27:yh,33:fh,34:gh,35:ph,36:mh,37:mh,38:fh,39:ph,40:gh},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Os extends tD{static getDefaults(){return F(F({},super.getDefaults()),Os.ownDefaults)}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,F(F({},Os.ownDefaults),e)),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof Ig&&this.canvas.textEditingManager.remove(this),e instanceof Ig&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,i)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,i)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const i=super.toCanvasElement(t);return this.isEditing=e,i}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),s=i.length>0;let r,o=t;if(s){r=Ji(t.canvas),o=r.getContext("2d"),n_(o,this.canvas);const c=this.calcTransformMatrix();o.transform(c[0],c[1],c[2],c[3],c[4],c[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,e):this.renderCursor(o,e),s)for(const c of i){const h=c.clipPath,f=Ji(t.canvas),g=f.getContext("2d");if(n_(g,this.canvas),!h.absolutePositioned){const p=c.calcTransformMatrix();g.transform(p[0],p[1],p[2],p[3],p[4],p[5])}h.transform(g),h.drawObject(g,!0,{}),this.drawClipPathOnCache(o,h,f)}s&&(t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const i=this._getLeftOffset(),s=this._getTopOffset(),r=this._getCursorBoundariesOffsets(t,e);return{left:i,top:s,leftOffset:r.left,topOffset:r.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,i=0;const{charIndex:s,lineIndex:r}=this.get2DCursorLocation(t);for(let f=0;f<r;f++)e+=this.getHeightOfLine(f);const o=this._getLineLeftOffset(r),c=this.__charBounds[r][s];c&&(i=c.left),this.charSpacing!==0&&s===this._textLines[r].length&&(i-=this._getWidthOfCharSpacing());const h={top:e,left:o+(i>0?i:0)};return this.direction==="rtl"&&(this.textAlign===Ce||this.textAlign===Ds||this.textAlign===ll?h.left*=-1:this.textAlign===Qt||this.textAlign===Zh?h.left=o-(i>0?i:0):this.textAlign!==Ft&&this.textAlign!==cl||(h.left=o-(i>0?i:0))),h}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const i=this.get2DCursorLocation(t),s=i.lineIndex,r=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(s,r,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),h=this.cursorWidth/c,f=this.getValueOfPropertyAt(s,r,"deltaY"),g=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,r,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-h/2,top:g+e.top+f,width:h,height:o}}_renderCursor(t,e,i){const{color:s,opacity:r,left:o,top:c,width:h,height:f}=this.getCursorRenderingData(i,e);t.fillStyle=s,t.globalAlpha=r,t.fillRect(o,c,h,f)}renderSelection(t,e){const i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,i,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,i){const s=e.selectionStart,r=e.selectionEnd,o=this.textAlign.includes(Ds),c=this.get2DCursorLocation(s),h=this.get2DCursorLocation(r),f=c.lineIndex,g=h.lineIndex,p=c.charIndex<0?0:c.charIndex,v=h.charIndex<0?0:h.charIndex;for(let b=f;b<=g;b++){const S=this._getLineLeftOffset(b)||0;let _=this.getHeightOfLine(b),C=0,w=0,T=0;if(b===f&&(w=this.__charBounds[f][p].left),b>=f&&b<g)T=o&&!this.isEndOfWrapping(b)?this.width:this.getLineWidth(b)||5;else if(b===g)if(v===0)T=this.__charBounds[g][v].left;else{const R=this._getWidthOfCharSpacing();T=this.__charBounds[g][v-1].left+this.__charBounds[g][v-1].width-R}C=_,(this.lineHeight<1||b===g&&this.lineHeight>1)&&(_/=this.lineHeight);let E=i.left+S+w,D=_,M=0;const O=T-w;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",D=1,M=_):t.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Ce||this.textAlign===Ds||this.textAlign===ll?E=this.width-E-O:this.textAlign===Qt||this.textAlign===Zh?E=i.left+S-T:this.textAlign!==Ft&&this.textAlign!==cl||(E=i.left+S-T)),t.fillRect(E,i.top+i.topOffset+M,O,D),i.topOffset+=C}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,Le)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}B(Os,"ownDefaults",eD),B(Os,"type","IText"),ct.setClass(Os),ct.setClass(Os,"i-text");class _r extends Os{static getDefaults(){return F(F({},super.getDefaults()),_r.ownDefaults)}constructor(t,e){super(t,F(F({},_r.ownDefaults),e))}static createControls(){return{controls:RE()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Ds)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,i=0,s=0;const r={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[s]===`
`&&o>0?(i=0,s++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[s])&&o>0&&(i++,s++),r[o]={line:e,offset:i},s+=t.graphemeLines[o].length,i+=t.graphemeLines[o].length;return r}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[e];i&&(e=i.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,i=0,s=t+1,r=!1;const o=this._styleMap[t],c=this._styleMap[t+1];o&&(t=o.line,i=o.offset),c&&(s=c.line,r=s===t,e=c.offset);const h=t===void 0?this.styles:{line:this.styles[t]};for(const f in h)for(const g in h[f]){const p=parseInt(g,10);if(p>=i&&(!r||p<e))for(const v in h[f][g])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[t];if(!i)return{};t=i.line,e=i.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,i){const s=this._styleMap[t];super._setStyleDeclaration(s.line,s.offset+e,i)}_deleteStyleDeclaration(t,e){const i=this._styleMap[t];super._deleteStyleDeclaration(i.line,i.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const i=this.getGraphemeDataForRender(t),s=[];for(let r=0;r<i.wordsData.length;r++)s.push(...this._wrapLine(r,e,i));return this.isWrapping=!1,s}getGraphemeDataForRender(t){const e=this.splitByGrapheme,i=e?"":" ";let s=0;return{wordsData:t.map(((r,o)=>{let c=0;const h=e?this.graphemeSplit(r):this.wordSplit(r);return h.length===0?[{word:[],width:0}]:h.map((f=>{const g=e?[f]:this.graphemeSplit(f),p=this._measureWord(g,o,c);return s=Math.max(p,s),c+=g.length+i.length,{word:g,width:p}}))})),largestWordWidth:s}}_measureWord(t,e){let i,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=0;for(let o=0,c=t.length;o<c;o++)r+=this._getGraphemeBox(t[o],e,o+s,i,!0).kernedWidth,i=t[o];return r}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,i){let{largestWordWidth:s,wordsData:r}=i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),h=this.splitByGrapheme,f=[],g=h?"":" ";let p=0,v=[],b=0,S=0,_=!0;e-=o;const C=Math.max(e,s,this.dynamicMinWidth),w=r[t];let T;for(b=0,T=0;T<w.length;T++){const{word:E,width:D}=w[T];b+=E.length,p+=S+D-c,p>C&&!_?(f.push(v),v=[],p=D,_=!0):p+=c,_||h||v.push(g),v=v.concat(E),S=h?0:this._measureWord([g],t,b),b++,_=!1}return T&&f.push(v),s+o>this.dynamicMinWidth&&(this.dynamicMinWidth=s-c+o),f}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),i=this._wrapText(e.lines,this.width),s=new Array(i.length);for(let r=0;r<i.length;r++)s[r]=i[r].join("");return e.lines=s,e.graphemeLines=i,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const i=parseInt(e,10);if(this._textLines[i]){const s=this._styleMap[e].line;t.set("".concat(s),!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}B(_r,"type","Textbox"),B(_r,"textLayoutProperties",[...Os.textLayoutProperties,"width"]),B(_r,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ct.setClass(_r);class r_ extends xu{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:i}=t,{clipPath:s,group:r}=i;if(!s||!this.shouldPerformLayout(t))return;const{width:o,height:c}=rn(YS(i,s)),h=new X(o,c);if(s.absolutePositioned)return{center:Pa(s.getRelativeCenterPoint(),void 0,r?r.calcTransformMatrix():void 0),size:h};{const f=s.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:g=new X,correction:p=new X}=this.calcBoundingBox(e,t)||{};return{center:g.add(f),correction:p.subtract(f),size:h}}return{center:i.getRelativeCenterPoint().add(f),size:h}}}}B(r_,"type","clip-path"),ct.setClass(r_);class a_ extends xu{getInitialSize(t,e){let{target:i}=t,{size:s}=e;return new X(i.width||s.x,i.height||s.y)}}B(a_,"type","fixed"),ct.setClass(a_);class iD extends xl{subscribeTargets(t){const e=t.target;t.targets.reduce(((i,s)=>(s.parent&&i.add(s.parent),i)),new Set).forEach((i=>{i.layoutManager.subscribeTargets({target:i,targets:[e]})}))}unsubscribeTargets(t){const e=t.target,i=e.getObjects();t.targets.reduce(((s,r)=>(r.parent&&s.add(r.parent),s)),new Set).forEach((s=>{!i.some((r=>r.parent===s))&&s.layoutManager.unsubscribeTargets({target:s,targets:[e]})}))}}class Sr extends Ar{static getDefaults(){return F(F({},super.getDefaults()),Sr.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Sr.ownDefaults),this.setOptions(e);const{left:i,top:s,layoutManager:r}=e;this.groupInit(t,{left:i,top:s,layoutManager:r??new iD})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach((s=>{const r=this._objects.findIndex((c=>c.isInFrontOf(s))),o=r===-1?this.size():r;this.insertAt(o,s)}))}canEnterGroup(t){return this.getObjects().some((e=>e.isDescendantOf(t)||t.isDescendantOf(e)))?(Yn("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const i=new Set;e.forEach((s=>{const{parent:r}=s;r&&i.add(r)})),t===Dp?i.forEach((s=>{s._onAfterObjectsChange(Jh,e)})):i.forEach((s=>{s._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=F(F({hasControls:!1},i),{},{forActiveSelection:!0});for(let r=0;r<this._objects.length;r++)this._objects[r]._renderControls(t,s);super._renderControls(t,e),t.restore()}}B(Sr,"type","ActiveSelection"),B(Sr,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ct.setClass(Sr),ct.setClass(Sr,"activeSelection");class sD{constructor(){B(this,"resources",{})}applyFilters(t,e,i,s,r){const o=r.getContext("2d");if(!o)return;o.drawImage(e,0,0,i,s);const c={sourceWidth:i,sourceHeight:s,imageData:o.getImageData(0,0,i,s),originalEl:e,originalImageData:o.getImageData(0,0,i,s),canvasEl:r,ctx:o,filterBackend:this};t.forEach((f=>{f.applyTo(c)}));const{imageData:h}=c;return h.width===i&&h.height===s||(r.width=h.width,r.height=h.height),o.putImageData(h,0,0),c}}class cx{constructor(){let{tileSize:t=Xt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};B(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),B(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const i=Ji({width:t,height:e}),s=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=i,this.gl=s)}applyFilters(t,e,i,s,r,o){const c=this.gl,h=r.getContext("2d");if(!c||!h)return;let f;o&&(f=this.getCachedTexture(o,e));const g={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:i,sourceHeight:s,destinationWidth:i,destinationHeight:s,context:c,sourceTexture:this.createTexture(c,i,s,f?void 0:e),targetTexture:this.createTexture(c,i,s),originalTexture:f||this.createTexture(c,i,s,f?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},p=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,p),t.forEach((v=>{v&&v.applyTo(g)})),(function(v){const b=v.targetCanvas,S=b.width,_=b.height,C=v.destinationWidth,w=v.destinationHeight;S===C&&_===w||(b.width=C,b.height=w)})(g),this.copyGLTo2D(c,g),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(g.sourceTexture),c.deleteTexture(g.targetTexture),c.deleteFramebuffer(p),h.setTransform(1,0,0,1,0,0),g}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,i,s,r){const{NEAREST:o,TEXTURE_2D:c,RGBA:h,UNSIGNED_BYTE:f,CLAMP_TO_EDGE:g,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:v,TEXTURE_WRAP_S:b,TEXTURE_WRAP_T:S}=t,_=t.createTexture();return t.bindTexture(c,_),t.texParameteri(c,p,r||o),t.texParameteri(c,v,r||o),t.texParameteri(c,b,g),t.texParameteri(c,S,g),s?t.texImage2D(c,0,h,h,f,s):t.texImage2D(c,0,h,e,i,0,h,f,null),_}getCachedTexture(t,e,i){const{textureCache:s}=this;if(s[t])return s[t];{const r=this.createTexture(this.gl,e.width,e.height,e,i);return r&&(s[t]=r),r}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const i=t.canvas,s=e.targetCanvas,r=s.getContext("2d");if(!r)return;r.translate(0,s.height),r.scale(1,-1);const o=i.height-s.height;r.drawImage(i,0,o,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(t,e){const i=e.targetCanvas.getContext("2d"),s=e.destinationWidth,r=e.destinationHeight,o=s*r*4;if(!i)return;const c=new Uint8Array(this.imageBuffer,0,o),h=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,s,r,t.RGBA,t.UNSIGNED_BYTE,c);const f=new ImageData(h,s,r);i.putImageData(f,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const i=t.getExtension("WEBGL_debug_renderer_info");if(i){const s=t.getParameter(i.UNMASKED_RENDERER_WEBGL),r=t.getParameter(i.UNMASKED_VENDOR_WEBGL);s&&(e.renderer=s.toLowerCase()),r&&(e.vendor=r.toLowerCase())}return this.gpuInfo=e,e}}let gg;function nD(){const{WebGLProbe:u}=Rs();return u.queryWebGL(hn()),Xt.enableGLFiltering&&u.isSupported(Xt.textureSize)?new cx({tileSize:Xt.textureSize}):new sD}function pg(){return!gg&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(gg=nD()),gg}const rD=["filters","resizeFilter","src","crossOrigin","type"],hx=["cropX","cropY"];class $i extends Je{static getDefaults(){return F(F({},super.getDefaults()),$i.ownDefaults)}constructor(t,e){super(),B(this,"_lastScaleX",1),B(this,"_lastScaleY",1),B(this,"_filterScalingX",1),B(this,"_filterScalingY",1),this.filters=[],Object.assign(this,$i.ownDefaults),this.setOptions(e),this.cacheKey="texture".concat(qn()),this.setElement(typeof t=="string"?(this.canvas&&cs(this.canvas.getElement())||Va()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){var e;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=t,this._originalElement=t,this._setWidthHeight(i),(e=t.classList)===null||e===void 0||e.add($i.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=pg(!1);e instanceof cx&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((t=>{const e=this[t];e&&Rs().dispose(e),this[t]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach((i=>{i&&e.push(i.toObject())})),F(F({},super.toObject([...hx,...t])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,i=-this.width/2,s=-this.height/2;let r=[],o=[],c="",h="";if(!e)return[];if(this.hasCrop()){const f=qn();r.push('<clipPath id="imageCrop_'+f+`">
`,'	<rect x="'+i+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+f+')" '}if(this.imageSmoothing||(h=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(i-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(e.width||e.naturalWidth,'" height="').concat(e.height||e.naturalHeight,'"').concat(h).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const f=this.fill;this.fill=null,o=['	<rect x="'.concat(i,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=f}return r=this.paintFirst!==Le?r.concat(o,t):r.concat(t,o),r}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jh(t,{crossOrigin:e,signal:i}).then((s=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(s)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),s=i.x,r=i.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||s>e&&r>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=r);const c=Ji(o),{width:h,height:f}=o;this._element=c,this._lastScaleX=t.scaleX=s,this._lastScaleY=t.scaleY=r,pg().applyFilters([t],o,h,f,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter((r=>r&&!r.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,i=e.naturalWidth||e.width,s=e.naturalHeight||e.height;if(this._element===this._originalElement){const r=Ji({width:i,height:s});this._element=r,this._filteredEl=r}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,s),this._lastScaleX=1,this._lastScaleY=1);pg().applyFilters(t,this._originalElement,i,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const i=this._filterScalingX,s=this._filterScalingY,r=this.width,o=this.height,c=Math.max(this.cropX,0),h=Math.max(this.cropY,0),f=e.naturalWidth||e.width,g=e.naturalHeight||e.height,p=c*i,v=h*s,b=Math.min(r*i,f-p),S=Math.min(o*s,g-v),_=-r/2,C=-o/2,w=Math.min(r,f/i-c),T=Math.min(o,g/s-h);e&&t.drawImage(e,p,v,b,S,_,C,w,T)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=this.getOriginalSize();this.width=t||i.width,this.height=e||i.height}parsePreserveAspectRatioAttribute(){const t=$T(this.preserveAspectRatio||""),e=this.width,i=this.height,s={width:e,height:i};let r,o=this._element.width,c=this._element.height,h=1,f=1,g=0,p=0,v=0,b=0;return!t||t.alignX===bi&&t.alignY===bi?(h=e/o,f=i/c):(t.meetOrSlice==="meet"&&(h=f=d2(this._element,s),r=(e-o*h)/2,t.alignX==="Min"&&(g=-r),t.alignX==="Max"&&(g=r),r=(i-c*f)/2,t.alignY==="Min"&&(p=-r),t.alignY==="Max"&&(p=r)),t.meetOrSlice==="slice"&&(h=f=f2(this._element,s),r=o-e/h,t.alignX==="Mid"&&(v=r/2),t.alignX==="Max"&&(v=r),r=c-i/f,t.alignY==="Mid"&&(b=r/2),t.alignY==="Max"&&(b=r),o=e/h,c=i/f)),{width:o,height:c,scaleX:h,scaleY:f,offsetLeft:g,offsetTop:p,cropX:v,cropY:b}}static fromObject(t,e){let{filters:i,resizeFilter:s,src:r,crossOrigin:o,type:c}=t,h=he(t,rD);return Promise.all([jh(r,F(F({},e),{},{crossOrigin:o})),i&&vl(i,e),s&&vl([s],e),vu(h,e)]).then((f=>{let[g,p=[],[v]=[],b={}]=f;return new this(g,F(F({},h),{},{src:r,filters:p,resizeFilter:v},b))}))}static fromURL(t){let{crossOrigin:e=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jh(t,{crossOrigin:e,signal:i}).then((r=>new this(r,s)))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const s=fn(t,this.ATTRIBUTE_NAMES,i);return this.fromURL(s["xlink:href"]||s.href,e,s).catch((r=>(Yn("log","Unable to parse Image",r),null)))}}B($i,"type","Image"),B($i,"cacheProperties",[...dn,...hx]),B($i,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),B($i,"CSS_CANVAS","canvas-img"),B($i,"ATTRIBUTE_NAMES",[...Wn,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),ct.setClass($i),ct.setSVGClass($i);_u(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Cu=u=>u.webgl!==void 0,Mp="precision highp float",aD=`
    `.concat(Mp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),oD=["type"],lD=["type"],cD=new RegExp(Mp,"g");class Pe{get type(){return this.constructor.type}constructor(){let t=he(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oD);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return aD}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Rs();s!=="highp"&&(e=e.replace(cD,Mp.replace("highp",s)));const r=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),c=t.createProgram();if(!r||!o||!c)throw new Ms("Vertex, fragment shader or program creation error");if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Ms("Vertex shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(r)));if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Ms("Fragment shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(o)));if(t.attachShader(c,r),t.attachShader(c,o),t.linkProgram(c),!t.getProgramParameter(c,t.LINK_STATUS))throw new Ms('Shader link error for "'.concat(this.type,'" ').concat(t.getProgramInfoLog(c)));const h=this.getUniformLocations(t,c)||{};return h.uStepW=t.getUniformLocation(c,"uStepW"),h.uStepH=t.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(t,c),uniformLocations:h}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const i=this.constructor.uniformLocations,s={};for(let r=0;r<i.length;r++)s[i[r]]=t.getUniformLocation(e,i[r]);return s}sendAttributeData(t,e,i){const s=e.aPosition,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const i=t.destinationWidth,s=t.destinationHeight;t.sourceWidth===i&&t.sourceHeight===s||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,i,s)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){Cu(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,i=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:i}=t,s=Ji({width:e,height:i});t.helpLayer=s}}toObject(){const t=Object.keys(this.constructor.defaults||{});return F({type:this.type},t.reduce(((e,i)=>(e[i]=this[i],e)),{}))}toJSON(){return this.toObject()}static async fromObject(t,e){return new this(he(t,lD))}}B(Pe,"type","BaseFilter"),B(Pe,"uniformLocations",[]);const hD={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class vh extends Pe{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(hD[this.mode],`
        }
      }
      `)}applyTo2d(t){let{imageData:{data:e}}=t;const i=new $t(this.color).getSource(),s=this.alpha,r=i[0]*s,o=i[1]*s,c=i[2]*s,h=1-s;for(let f=0;f<e.length;f+=4){const g=e[f],p=e[f+1],v=e[f+2];let b,S,_;switch(this.mode){case"multiply":b=g*r/255,S=p*o/255,_=v*c/255;break;case"screen":b=255-(255-g)*(255-r)/255,S=255-(255-p)*(255-o)/255,_=255-(255-v)*(255-c)/255;break;case"add":b=g+r,S=p+o,_=v+c;break;case"difference":b=Math.abs(g-r),S=Math.abs(p-o),_=Math.abs(v-c);break;case"subtract":b=g-r,S=p-o,_=v-c;break;case"darken":b=Math.min(g,r),S=Math.min(p,o),_=Math.min(v,c);break;case"lighten":b=Math.max(g,r),S=Math.max(p,o),_=Math.max(v,c);break;case"overlay":b=r<128?2*g*r/255:255-2*(255-g)*(255-r)/255,S=o<128?2*p*o/255:255-2*(255-p)*(255-o)/255,_=c<128?2*v*c/255:255-2*(255-v)*(255-c)/255;break;case"exclusion":b=r+g-2*r*g/255,S=o+p-2*o*p/255,_=c+v-2*c*v/255;break;case"tint":b=r+g*h,S=o+p*h,_=c+v*h}e[f]=b,e[f+1]=S,e[f+2]=_}}sendUniformData(t,e){const i=new $t(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(e.uColor,i)}}B(vh,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),B(vh,"type","BlendColor"),B(vh,"uniformLocations",["uColor"]),ct.setClass(vh);const uD={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},dD=["type","image"];class bh extends Pe{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return uD[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:i}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]}applyTo2d(t){let{imageData:{data:e,width:i,height:s},filterBackend:{resources:r}}=t;const o=this.image;r.blendImage||(r.blendImage=hn());const c=r.blendImage,h=c.getContext("2d");c.width!==i||c.height!==s?(c.width=i,c.height=s):h.clearRect(0,0,i,s),h.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),h.drawImage(o.getElement(),0,0,i,s);const f=h.getImageData(0,0,i,s).data;for(let g=0;g<e.length;g+=4){const p=e[g],v=e[g+1],b=e[g+2],S=e[g+3],_=f[g],C=f[g+1],w=f[g+2],T=f[g+3];switch(this.mode){case"multiply":e[g]=p*_/255,e[g+1]=v*C/255,e[g+2]=b*w/255,e[g+3]=S*T/255;break;case"mask":e[g+3]=T}}}sendUniformData(t,e){const i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)}toObject(){return F(F({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(t,e){let{type:i,image:s}=t,r=he(t,dD);return $i.fromObject(s,e).then((o=>new this(F(F({},r),{},{image:o}))))}}B(bh,"type","BlendImage"),B(bh,"defaults",{mode:"multiply",alpha:1}),B(bh,"uniformLocations",["uTransformMatrix","uImage"]),ct.setClass(bh);class _h extends Pe{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){Cu(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:i,height:s}}=t;this.aspectRatio=i/s,this.horizontal=!0;let r=this.getBlurValue()*i;const o=new Uint8ClampedArray(e),c=15,h=4*i;for(let f=0;f<e.length;f+=4){let g=0,p=0,v=0,b=0,S=0;const _=f-f%h,C=_+h;for(let w=-14;w<c;w++){const T=w/c,E=4*Math.floor(r*T),D=1-Math.abs(T);let M=f+E;M<_?M=_:M>C&&(M=C);const O=e[M+3]*D;g+=e[M]*O,p+=e[M+1]*O,v+=e[M+2]*O,b+=O,S+=D}o[f]=g/b,o[f+1]=p/b,o[f+2]=v/b,o[f+3]=b/S}this.horizontal=!1,r=this.getBlurValue()*s;for(let f=0;f<o.length;f+=4){let g=0,p=0,v=0,b=0,S=0;const _=f%h,C=o.length-h+_;for(let w=-14;w<c;w++){const T=w/c,E=Math.floor(r*T)*h,D=1-Math.abs(T);let M=f+E;M<_?M=_:M>C&&(M=C);const O=o[M+3]*D;g+=o[M]*O,p+=o[M+1]*O,v+=o[M+2]*O,b+=O,S+=D}e[f]=g/b,e[f+1]=p/b,e[f+2]=v/b,e[f+3]=b/S}}sendUniformData(t,e){const i=this.chooseRightDelta();t.uniform2fv(e.uDelta,i)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:i}=this;return e?i>1&&(t=1/i):i<1&&(t=i),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}B(_h,"type","Blur"),B(_h,"defaults",{blur:0}),B(_h,"uniformLocations",["uDelta"]),ct.setClass(_h);class Sh extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.round(255*this.brightness);for(let s=0;s<e.length;s+=4)e[s]+=i,e[s+1]+=i,e[s+2]+=i}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}B(Sh,"type","Brightness"),B(Sh,"defaults",{brightness:0}),B(Sh,"uniformLocations",["uBrightness"]),ct.setClass(Sh);const ux={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Da extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,i=this.matrix,s=this.colorsOnly;for(let r=0;r<e.length;r+=4){const o=e[r],c=e[r+1],h=e[r+2];if(e[r]=o*i[0]+c*i[1]+h*i[2]+255*i[4],e[r+1]=o*i[5]+c*i[6]+h*i[7]+255*i[9],e[r+2]=o*i[10]+c*i[11]+h*i[12]+255*i[14],!s){const f=e[r+3];e[r]+=f*i[3],e[r+1]+=f*i[8],e[r+2]+=f*i[13],e[r+3]=o*i[15]+c*i[16]+h*i[17]+f*i[18]+255*i[19]}}}sendUniformData(t,e){const i=this.matrix,s=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],r=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,s),t.uniform4fv(e.uConstants,r)}toObject(){return F(F({},super.toObject()),{},{matrix:[...this.matrix]})}}function Rr(u,t){var e;const i=(B(e=class extends Da{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",u),B(e,"defaults",{colorsOnly:!1,matrix:t}),e);return ct.setClass(i,u),i}B(Da,"type","ColorMatrix"),B(Da,"defaults",ux),B(Da,"uniformLocations",["uColorMatrix","uConstants"]),ct.setClass(Da);Rr("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Rr("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Rr("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Rr("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Rr("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Rr("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Rr("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class o_ extends Pe{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){Cu(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach((e=>{e.applyTo(t)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((t=>t.toObject()))}}isNeutralState(){return!this.subFilters.some((t=>!t.isNeutralState()))}static fromObject(t,e){return Promise.all((t.subFilters||[]).map((i=>ct.getClass(i.type).fromObject(i,e)))).then((i=>new this({subFilters:i})))}}B(o_,"type","Composed"),ct.setClass(o_);class xh extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const i=Math.floor(255*this.contrast),s=259*(i+255)/(255*(259-i));for(let r=0;r<e.length;r+=4)e[r]=s*(e[r]-128)+128,e[r+1]=s*(e[r+1]-128)+128,e[r+2]=s*(e[r+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}B(xh,"type","Contrast"),B(xh,"defaults",{contrast:0}),B(xh,"uniformLocations",["uContrast"]),ct.setClass(xh);const fD={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class wh extends Pe{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return fD[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,i=e.data,s=this.matrix,r=Math.round(Math.sqrt(s.length)),o=Math.floor(r/2),c=e.width,h=e.height,f=t.ctx.createImageData(c,h),g=f.data,p=this.opaque?1:0;let v,b,S,_,C,w,T,E,D,M,O,R,j;for(O=0;O<h;O++)for(M=0;M<c;M++){for(C=4*(O*c+M),v=0,b=0,S=0,_=0,j=0;j<r;j++)for(R=0;R<r;R++)T=O+j-o,w=M+R-o,T<0||T>=h||w<0||w>=c||(E=4*(T*c+w),D=s[j*r+R],v+=i[E]*D,b+=i[E+1]*D,S+=i[E+2]*D,p||(_+=i[E+3]*D));g[C]=v,g[C+1]=b,g[C+2]=S,g[C+3]=p?i[C+3]:_}t.imageData=f}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return F(F({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}B(wh,"type","Convolute"),B(wh,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),B(wh,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ct.setClass(wh);const dx="Gamma";class Ch extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.gamma,s=1/i[0],r=1/i[1],o=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let h=0;h<256;h++)c.r[h]=255*Math.pow(h/255,s),c.g[h]=255*Math.pow(h/255,r),c.b[h]=255*Math.pow(h/255,o);for(let h=0;h<e.length;h+=4)e[h]=c.r[e[h]],e[h+1]=c.g[e[h+1]],e[h+2]=c.b[e[h+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:dx,gamma:this.gamma.concat()}}}B(Ch,"type",dx),B(Ch,"defaults",{gamma:[1,1,1]}),B(Ch,"uniformLocations",["uGamma"]),ct.setClass(Ch);const gD={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Ah extends Pe{applyTo2d(t){let{imageData:{data:e}}=t;for(let i,s=0;s<e.length;s+=4){const r=e[s],o=e[s+1],c=e[s+2];switch(this.mode){case"average":i=(r+o+c)/3;break;case"lightness":i=(Math.min(r,o,c)+Math.max(r,o,c))/2;break;case"luminosity":i=.21*r+.72*o+.07*c}e[s+2]=e[s+1]=e[s]=i}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return gD[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}B(Ah,"type","Grayscale"),B(Ah,"defaults",{mode:"average"}),B(Ah,"uniformLocations",["uMode"]),ct.setClass(Ah);const pD=F(F({},ux),{},{rotation:0});class mg extends Da{calculateMatrix(){const t=this.rotation*Math.PI,e=ln(t),i=cn(t),s=1/3,r=Math.sqrt(s)*i,o=1-e;this.matrix=[e+o/3,s*o-r,s*o+r,0,0,s*o+r,e+s*o,s*o-r,0,0,s*o-r,s*o+r,e+s*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}B(mg,"type","HueRotation"),B(mg,"defaults",pD),ct.setClass(mg);class Th extends Pe{applyTo2d(t){let{imageData:{data:e}}=t;for(let i=0;i<e.length;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2],this.alpha&&(e[i+3]=255-e[i+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}B(Th,"type","Invert"),B(Th,"defaults",{alpha:!1,invert:!0}),B(Th,"uniformLocations",["uInvert","uAlpha"]),ct.setClass(Th);class Eh extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=this.noise;for(let s=0;s<e.length;s+=4){const r=(.5-Math.random())*i;e[s]+=r,e[s+1]+=r,e[s+2]+=r}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}B(Eh,"type","Noise"),B(Eh,"defaults",{noise:0}),B(Eh,"uniformLocations",["uNoise","uSeed"]),ct.setClass(Eh);class Dh extends Pe{applyTo2d(t){let{imageData:{data:e,width:i,height:s}}=t;for(let r=0;r<s;r+=this.blocksize)for(let o=0;o<i;o+=this.blocksize){const c=4*r*i+4*o,h=e[c],f=e[c+1],g=e[c+2],p=e[c+3];for(let v=r;v<Math.min(r+this.blocksize,s);v++)for(let b=o;b<Math.min(o+this.blocksize,i);b++){const S=4*v*i+4*b;e[S]=h,e[S+1]=f,e[S+2]=g,e[S+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}B(Dh,"type","Pixelate"),B(Dh,"defaults",{blocksize:4}),B(Dh,"uniformLocations",["uBlocksize"]),ct.setClass(Dh);class Mh extends Pe{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=255*this.distance,s=new $t(this.color).getSource(),r=[s[0]-i,s[1]-i,s[2]-i],o=[s[0]+i,s[1]+i,s[2]+i];for(let c=0;c<e.length;c+=4){const h=e[c],f=e[c+1],g=e[c+2];h>r[0]&&f>r[1]&&g>r[2]&&h<o[0]&&f<o[1]&&g<o[2]&&(e[c+3]=0)}}sendUniformData(t,e){const i=new $t(this.color).getSource(),s=this.distance,r=[0+i[0]/255-s,0+i[1]/255-s,0+i[2]/255-s,1],o=[i[0]/255+s,i[1]/255+s,i[2]/255+s,1];t.uniform4fv(e.uLow,r),t.uniform4fv(e.uHigh,o)}}B(Mh,"type","RemoveColor"),B(Mh,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),B(Mh,"uniformLocations",["uLow","uHigh"]),ct.setClass(Mh);class Oh extends Pe{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return"".concat(this.type,"_").concat(t)}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),s=new Array(i);for(let r=1;r<=i;r++)s[r-1]=t(r*e);return s}generateShader(t){const e=new Array(t);for(let i=1;i<=t;i++)e[i-1]="".concat(i,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(t,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(e.map(((i,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(i,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(i,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){Cu(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const i=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(i)/i}}applyTo2d(t){const e=t.imageData,i=this.scaleX,s=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/s;const r=e.width,o=e.height,c=Math.round(r*i),h=Math.round(o*s);let f;f=this.resizeType==="sliceHack"?this.sliceByTwo(t,r,o,c,h):this.resizeType==="hermite"?this.hermiteFastResize(t,r,o,c,h):this.resizeType==="bilinear"?this.bilinearFiltering(t,r,o,c,h):this.resizeType==="lanczos"?this.lanczosResize(t,r,o,c,h):new ImageData(c,h),t.imageData=f}sliceByTwo(t,e,i,s,r){const o=t.imageData,c=.5;let h=!1,f=!1,g=e*c,p=i*c;const v=t.filterBackend.resources;let b=0,S=0;const _=e;let C=0;v.sliceByTwo||(v.sliceByTwo=hn());const w=v.sliceByTwo;(w.width<1.5*e||w.height<i)&&(w.width=1.5*e,w.height=i);const T=w.getContext("2d");for(T.clearRect(0,0,1.5*e,i),T.putImageData(o,0,0),s=Math.floor(s),r=Math.floor(r);!h||!f;)e=g,i=p,s<Math.floor(g*c)?g=Math.floor(g*c):(g=s,h=!0),r<Math.floor(p*c)?p=Math.floor(p*c):(p=r,f=!0),T.drawImage(w,b,S,e,i,_,C,g,p),b=_,S=C,C+=p;return T.getImageData(b,S,s,r)}lanczosResize(t,e,i,s,r){const o=t.imageData.data,c=t.ctx.createImageData(s,r),h=c.data,f=this.lanczosCreate(this.lanczosLobes),g=this.rcpScaleX,p=this.rcpScaleY,v=2/this.rcpScaleX,b=2/this.rcpScaleY,S=Math.ceil(g*this.lanczosLobes/2),_=Math.ceil(p*this.lanczosLobes/2),C={},w={x:0,y:0},T={x:0,y:0};return(function E(D){let M,O,R,j,G,Q,J,st,rt,it,lt;for(w.x=(D+.5)*g,T.x=Math.floor(w.x),M=0;M<r;M++){for(w.y=(M+.5)*p,T.y=Math.floor(w.y),G=0,Q=0,J=0,st=0,rt=0,O=T.x-S;O<=T.x+S;O++)if(!(O<0||O>=e)){it=Math.floor(1e3*Math.abs(O-w.x)),C[it]||(C[it]={});for(let L=T.y-_;L<=T.y+_;L++)L<0||L>=i||(lt=Math.floor(1e3*Math.abs(L-w.y)),C[it][lt]||(C[it][lt]=f(Math.sqrt(Math.pow(it*v,2)+Math.pow(lt*b,2))/1e3)),R=C[it][lt],R>0&&(j=4*(L*e+O),G+=R,Q+=R*o[j],J+=R*o[j+1],st+=R*o[j+2],rt+=R*o[j+3]))}j=4*(M*s+D),h[j]=Q/G,h[j+1]=J/G,h[j+2]=st/G,h[j+3]=rt/G}return++D<s?E(D):c})(0)}bilinearFiltering(t,e,i,s,r){let o,c,h,f,g,p,v,b,S,_,C,w,T,E=0;const D=this.rcpScaleX,M=this.rcpScaleY,O=4*(e-1),R=t.imageData.data,j=t.ctx.createImageData(s,r),G=j.data;for(v=0;v<r;v++)for(b=0;b<s;b++)for(g=Math.floor(D*b),p=Math.floor(M*v),S=D*b-g,_=M*v-p,T=4*(p*e+g),C=0;C<4;C++)o=R[T+C],c=R[T+4+C],h=R[T+O+C],f=R[T+O+4+C],w=o*(1-S)*(1-_)+c*S*(1-_)+h*_*(1-S)+f*S*_,G[E++]=w;return j}hermiteFastResize(t,e,i,s,r){const o=this.rcpScaleX,c=this.rcpScaleY,h=Math.ceil(o/2),f=Math.ceil(c/2),g=t.imageData.data,p=t.ctx.createImageData(s,r),v=p.data;for(let b=0;b<r;b++)for(let S=0;S<s;S++){const _=4*(S+b*s);let C=0,w=0,T=0,E=0,D=0,M=0,O=0;const R=(b+.5)*c;for(let j=Math.floor(b*c);j<(b+1)*c;j++){const G=Math.abs(R-(j+.5))/f,Q=(S+.5)*o,J=G*G;for(let st=Math.floor(S*o);st<(S+1)*o;st++){let rt=Math.abs(Q-(st+.5))/h;const it=Math.sqrt(J+rt*rt);it>1&&it<-1||(C=2*it*it*it-3*it*it+1,C>0&&(rt=4*(st+j*e),O+=C*g[rt+3],T+=C,g[rt+3]<255&&(C=C*g[rt+3]/250),E+=C*g[rt],D+=C*g[rt+1],M+=C*g[rt+2],w+=C))}}v[_]=E/w,v[_+1]=D/w,v[_+2]=M/w,v[_+3]=O/T}return p}}B(Oh,"type","Resize"),B(Oh,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),B(Oh,"uniformLocations",["uDelta","uTaps"]),ct.setClass(Oh);class kh extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.saturation;for(let s=0;s<e.length;s+=4){const r=e[s],o=e[s+1],c=e[s+2],h=Math.max(r,o,c);e[s]+=h!==r?(h-r)*i:0,e[s+1]+=h!==o?(h-o)*i:0,e[s+2]+=h!==c?(h-c)*i:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}B(kh,"type","Saturation"),B(kh,"defaults",{saturation:0}),B(kh,"uniformLocations",["uSaturation"]),ct.setClass(kh);class Rh extends Pe{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const i=-this.vibrance;for(let s=0;s<e.length;s+=4){const r=e[s],o=e[s+1],c=e[s+2],h=Math.max(r,o,c),f=(r+o+c)/3,g=2*Math.abs(h-f)/255*i;e[s]+=h!==r?(h-r)*g:0,e[s+1]+=h!==o?(h-o)*g:0,e[s+2]+=h!==c?(h-c)*g:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}B(Rh,"type","Vibrance"),B(Rh,"defaults",{vibrance:0}),B(Rh,"uniformLocations",["uVibrance"]),ct.setClass(Rh);const mD=u=>u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yD=u=>u.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),l_=u=>{const t=yD(u);return t.charAt(0).toUpperCase()+t.slice(1)},fx=(...u)=>u.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim(),vD=u=>{for(const t in u)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var bD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const _D=at.forwardRef(({color:u="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:o,...c},h)=>at.createElement("svg",{ref:h,...bD,width:t,height:t,stroke:u,strokeWidth:i?Number(e)*24/Number(t):e,className:fx("lucide",s),...!r&&!vD(c)&&{"aria-hidden":"true"},...c},[...o.map(([f,g])=>at.createElement(f,g)),...Array.isArray(r)?r:[r]]));const Qa=(u,t)=>{const e=at.forwardRef(({className:i,...s},r)=>at.createElement(_D,{ref:r,iconNode:t,className:fx(`lucide-${mD(l_(u))}`,`lucide-${u}`,i),...s}));return e.displayName=l_(u),e};const SD=[["circle",{cx:"9",cy:"9",r:"7",key:"p2h5vp"}],["circle",{cx:"15",cy:"15",r:"7",key:"19ennj"}]],xD=Qa("blend",SD);const wD=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],c_=Qa("highlighter",wD);const CD=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],h_=Qa("palette",CD);const AD=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],u_=Qa("ruler",AD);const TD=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],d_=Qa("type",TD);const ED=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],DD=Qa("upload",ED),MD=()=>{const[u,t]=at.useState(null),[e,i]=at.useState(null),s=at.useMemo(()=>Array.from({length:e},(yt,ot)=>ot+1),[e]),r=at.useRef([]),o=at.useRef(null),[c,h]=at.useState([]),[f,g]=at.useState(null),[p,v]=at.useState(new Set),[b,S]=at.useState({fileName:"edited-pdf"}),[_,C]=at.useState("#FFD600"),[w,T]=at.useState(.5),[E,D]=at.useState(15),[M,O]=at.useState(!1),[R,j]=at.useState("#000000"),[G,Q]=at.useState(16),[J,st]=at.useState(!1),[rt,it]=at.useState(null),[lt,L]=at.useState({}),I=at.useRef(R),K=at.useRef(G);at.useEffect(()=>{I.current=R},[R]),at.useEffect(()=>{K.current=G},[G]);const dt=yt=>{const ot=yt.target.files[0];if(ot&&ot.type==="application/pdf"){const Tt=new FileReader;Tt.onload=Et=>{const Dt=Et.target.result;t(Dt),S({fileName:ot.name.replace(".pdf","")||"edited-pdf"})},Tt.readAsDataURL(ot)}else alert("Please select a valid PDF file")},_t=async({numPages:yt})=>{i(yt)},P=(yt,ot,Tt,Et)=>{if(r.current[Et-1])return r.current[Et-1];const Dt=new Ig(yt,{width:ot,height:Tt,backgroundColor:"transparent"});return Dt.on("selection:created",wt=>{const bt=wt.selected[0];if(bt&&bt.typeName==="highlight"){it(bt),O(!0),st(!1);const Be=bt.stroke.substring(0,7);C(Be),T(bt.strokeOpacity||bt.highlightOpacity||.5),D(bt.strokeWidth||15)}else bt&&bt.typeName==="text"&&(it(bt),st(!0),O(!1),j(bt.fill||"#000000"),Q(bt.fontSize||16))}),Dt.on("selection:updated",wt=>{const bt=wt.selected[0];if(bt&&bt.typeName==="highlight"){it(bt),O(!0),st(!1);const Be=bt.stroke.substring(0,7);C(Be),T(bt.strokeOpacity||bt.highlightOpacity||.5),D(bt.strokeWidth||15)}else bt&&bt.typeName==="text"&&(it(bt),st(!0),O(!1),j(bt.fill||"#000000"),Q(bt.fontSize||16))}),Dt.on("selection:cleared",()=>{it(null),f!=="highlight"&&O(!1),f!=="text"&&st(!1)}),Dt.on("object:modified",()=>{const wt=Dt.getObjects().map(bt=>(bt.id||(bt.id=Zo()),bt));L(bt=>({...bt,[`page-${Et}`]:{objects:wt.map(Be=>Be.toObject(["id","typeName","highlightColor","highlightOpacity","textContent"]))}}))}),Dt.on("object:added",()=>{const wt=Dt.getObjects().map(bt=>(bt.id||(bt.id=Zo()),bt));L(bt=>({...bt,[`page-${Et}`]:{objects:wt.map(Be=>Be.toObject(["id","typeName","highlightColor","highlightOpacity","textContent"]))}}))}),Dt.on("object:removed",()=>{const wt=Dt.getObjects().map(bt=>(bt.id||(bt.id=Zo()),bt));L(bt=>({...bt,[`page-${Et}`]:{objects:wt.map(Be=>Be.toObject(["id"]))}}))}),Dt.on("mouse:down",wt=>{!wt.target&&f!=="text"&&(Dt.discardActiveObject(),Dt.renderAll())}),Dt},Y=(yt,ot)=>{if(yt){const Tt=yt.getViewport({scale:1}),{width:Et,height:Dt}=Tt;if(h(wt=>{const bt=[...wt];return bt[ot-1]={width:Et,height:Dt},bt}),!r.current[ot-1]){const wt=`pageCanvas-${ot}`,bt=P(wt,Et,Dt,ot);r.current[ot-1]=bt}v(wt=>new Set([...wt,ot])),f==="highlight"?nt(ot):f==="text"&&Wt(ot)}},et=()=>{g("highlight"),st(!1),p.forEach(yt=>{nt(yt)})},nt=yt=>{const ot=r.current[yt-1];if(!ot)return;ot.isDrawingMode=!0,ot.freeDrawingBrush||(ot.freeDrawingBrush=new iu(ot));const Tt=Math.round(w*255).toString(16).padStart(2,"0");ot.freeDrawingBrush.color=`${_}${Tt}`,ot.freeDrawingBrush.width=E,ot.selection=!1,ot.off("mouse:down"),ot.off("mouse:move"),ot.off("mouse:up"),ot.off("path:created");const Et=Dt=>{const wt=Dt.path;wt&&(wt.id=Zo(),wt.selectable=!0,wt.evented=!0,wt.highlightColor=_,wt.highlightOpacity=w,wt.typeName="highlight",ot.renderAll())};ot.on("path:created",Et)},ft=()=>{p.forEach(yt=>{const ot=r.current[yt-1];ot&&(ot.isDrawingMode=!1,ot.selection=!0,ot.getObjects().forEach(Tt=>{Tt.selectable=!0,Tt.evented=!0}),ot.renderAll())})},gt=()=>{if(rt){const yt=Math.round(w*255).toString(16).padStart(2,"0");rt.set({stroke:`${_}${yt}`,strokeWidth:E,strokeOpacity:w,highlightColor:_,highlightOpacity:w}),rt.canvas.renderAll()}else f==="highlight"&&p.forEach(yt=>{nt(yt)})},pt=()=>{g("text"),O(!1),st(!0),p.forEach(yt=>{const ot=r.current[yt-1];ot&&(ot.isDrawingMode=!1,ot.selection=!0)}),p.forEach(yt=>{Wt(yt)})},Wt=yt=>{const ot=r.current[yt-1];if(!ot)return;ot.isDrawingMode=!1,ot.selection=!0,ot.off("mouse:dblclick"),ot.off("mouse:down");const Tt=Et=>{if(!Et.target){const Dt=ot.getPointer(Et.e),wt=new Os("Write Here...",{left:Dt.x,top:Dt.y,fill:I.current,fontSize:K.current,fontFamily:"Arial",editable:!0,selectable:!0,id:Zo(),typeName:"text",textContent:"Write Here..."});ot.add(wt),ot.setActiveObject(wt),wt.enterEditing(),ot.renderAll()}};ot.on("mouse:dblclick",Tt)},Mt=()=>{p.forEach(yt=>{const ot=r.current[yt-1];ot&&ot.off("mouse:dblclick")})},Pt=()=>{rt&&rt.typeName==="text"&&(rt.set({fill:R,fontSize:G}),rt.isEditing&&(rt.exitEditing(),rt.enterEditing()),rt.canvas.renderAll())};return tt.jsxs(tt.Fragment,{children:[!u&&tt.jsx("div",{className:"uploader-page",children:tt.jsx("div",{className:"uploader",children:tt.jsxs("div",{className:"wrapper",children:[tt.jsx(DD,{className:"icon"}),tt.jsx("p",{className:"uploader-subtitle",children:"Upload a PDF file to start editing"}),tt.jsx("input",{ref:o,type:"file",accept:".pdf",onChange:dt,className:"uploader-file-input","aria-label":"Upload PDF"}),tt.jsx("button",{onClick:()=>o.current?.click(),className:"uploader-button",type:"button",children:"Choose PDF File"})]})})}),u&&tt.jsxs(tt.Fragment,{children:[tt.jsxs("div",{className:"tools-bar",children:[tt.jsx("div",{className:"file-info",children:tt.jsxs("div",{className:"wrapper",children:[tt.jsx("span",{className:"label",children:"File: "}),tt.jsx("span",{className:"file-name",children:b.fileName||"edited-pdf"})]})}),tt.jsxs("div",{className:"tools",children:[tt.jsx("button",{onClick:()=>{f==="highlight"?(g(null),O(!1),ft()):(g("highlight"),O(!0),st(!1),Mt(),et())},className:`${f==="highlight"&&"active"}`,title:"Highlight",children:tt.jsx(c_,{className:"icon"})}),tt.jsx("button",{onClick:()=>{f==="text"?(g(null),st(!1),Mt(),p.forEach(yt=>{const ot=r.current[yt-1];ot&&(ot.selection=!0)})):(g("text"),st(!0),O(!1),ft(),pt())},className:`${f==="text"&&"active"}`,title:"Add Text",children:tt.jsx(d_,{className:"icon"})})]})]}),f==="text"&&tt.jsx("div",{className:"txt-hint",children:"Double-click on the Page to add text"}),J&&tt.jsxs("div",{className:"highlight-settings",children:[tt.jsxs("div",{className:"settings-header",children:[tt.jsx("div",{className:"settings-icon",children:tt.jsx(d_,{size:16,color:"white"})}),tt.jsx("h2",{className:"settings-title",children:"Text Settings"})]}),tt.jsxs("div",{className:"control-group",children:[tt.jsxs("label",{className:"control-label",children:[tt.jsx(h_,{className:"label-icon"}),"Text Color"]}),tt.jsxs("div",{className:"color-picker-wrapper",children:[tt.jsx("input",{type:"color",value:R,onChange:yt=>{j(yt.target.value),Pt()}}),tt.jsx("span",{className:"color-value",children:R})]})]}),tt.jsxs("div",{class:"control-group",children:[tt.jsxs("label",{class:"control-label",children:[tt.jsx(u_,{className:"label-icon"}),tt.jsxs("span",{class:"value-display",id:"brushSizeValue",children:[G,"px"]})]}),tt.jsx("div",{class:"slider-container",children:tt.jsx("input",{type:"range",min:"8",max:"72",value:G,onChange:yt=>{Q(Number(yt.target.value)),Pt()}})})]}),tt.jsxs("div",{class:"preview-section",children:[tt.jsx("div",{class:"preview-label",children:"Live Preview"}),tt.jsx("div",{class:"preview-container stop-animate",children:tt.jsx("div",{style:{color:R,fontSize:`${G}px`,fontFamily:"Arial",textAlign:"center",padding:"1rem",width:"100%"},children:"iText"})})]})]}),M&&tt.jsxs("div",{className:"highlight-settings",children:[tt.jsxs("div",{className:"settings-header",children:[tt.jsx("div",{className:"settings-icon",children:tt.jsx(c_,{size:16,color:"white"})}),tt.jsx("h2",{className:"settings-title",children:"Highlight Settings"})]}),tt.jsxs("div",{className:"control-group",children:[tt.jsxs("label",{className:"control-label",children:[tt.jsx(h_,{className:"label-icon"}),"Color"]}),tt.jsxs("div",{className:"color-picker-wrapper",children:[tt.jsx("input",{type:"color",value:_,onChange:yt=>{C(yt.target.value),gt()}}),tt.jsx("span",{className:"color-value",children:_})]})]}),tt.jsxs("div",{class:"control-group",children:[tt.jsxs("label",{class:"control-label",children:[tt.jsx(u_,{className:"label-icon"}),"Brush Size",tt.jsxs("span",{class:"value-display",id:"brushSizeValue",children:[E,"px"]})]}),tt.jsx("div",{class:"slider-container",children:tt.jsx("input",{type:"range",id:"brushSize",min:"5",max:"50",value:E,onChange:yt=>{D(Number(yt.target.value)),gt()}})})]}),tt.jsxs("div",{class:"control-group",children:[tt.jsxs("label",{class:"control-label",children:[tt.jsx(xD,{className:"label-icon"}),"Opacity",tt.jsxs("span",{class:"value-display",id:"opacityValue",children:[Math.round(w*100),"%"]})]}),tt.jsx("div",{class:"slider-container",children:tt.jsx("input",{type:"range",id:"opacity",min:"0",max:"1",step:"0.1",value:w,onChange:yt=>{T(Number(yt.target.value)),gt()}})})]}),tt.jsxs("div",{class:"preview-section",children:[tt.jsx("div",{class:"preview-label",children:"Live Preview"}),tt.jsxs("div",{class:"preview-container",children:[tt.jsx("div",{class:"preview-circle",id:"previewCircle",style:{width:`${E}px`,height:`${E}px`,backgroundColor:`${_}`,opacity:w}}),tt.jsxs("div",{class:"preview-details",children:[tt.jsxs("div",{class:"detail-item",children:[tt.jsx("div",{class:"detail-label",children:"Size"}),tt.jsxs("div",{class:"detail-value",children:[E,"px"]})]}),tt.jsxs("div",{class:"detail-item",children:[tt.jsx("div",{class:"detail-label",children:"Opacity"}),tt.jsx("div",{class:"detail-value",children:w})]}),tt.jsxs("div",{class:"detail-item",children:[tt.jsx("div",{class:"detail-label",children:"Color"}),tt.jsx("div",{class:"detail-value",id:"detailColor",children:_})]})]})]})]})]}),tt.jsx("div",{className:"pdf-container",children:tt.jsx(uT,{file:u,onLoadSuccess:_t,children:s.map(yt=>tt.jsxs("div",{className:"pdf-page",children:[tt.jsx(ST,{pageNumber:yt,onLoadSuccess:ot=>Y(ot,yt),height:c[yt-1]?.height,width:c[yt-1]?.width},yt),tt.jsx("canvas",{style:{position:"absolute",top:0,left:0},id:`pageCanvas-${yt}`})]},yt))})})]})]})};function OD(){return Vn.workerSrc=`//unpkg.com/pdfjs-dist@${np}/build/pdf.worker.min.mjs`,tt.jsx(tt.Fragment,{children:tt.jsx(MD,{})})}U1.createRoot(document.getElementById("root")).render(tt.jsx(at.StrictMode,{children:tt.jsx(OD,{})}));
